<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 16.0.0"/>
    <title>pyswmp API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:27px;vertical-align:bottom;width:50px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="pyswmp/__version__.html">__version__</a></li>
            </ul>

            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#__version__">__version__</a>
            </li>
            <li>
                    <a class="class" href="#WaveFrontTracker">WaveFrontTracker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#WaveFrontTracker.__init__">WaveFrontTracker</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTracker.config_file">config_file</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTracker.options">options</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTracker.n_sources">n_sources</a>
                        </li>
                        <li>
                                <a class="function" href="#WaveFrontTracker.forward">forward</a>
                        </li>
                        <li>
                                <a class="function" href="#WaveFrontTracker.forward_single_source">forward_single_source</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#WaveFrontTrackerResult">WaveFrontTrackerResult</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#WaveFrontTrackerResult.__init__">WaveFrontTrackerResult</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTrackerResult.source_ids">source_ids</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTrackerResult.receiver_ids">receiver_ids</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTrackerResult.arrival_numbers">arrival_numbers</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTrackerResult.travel_times">travel_times</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTrackerResult.azimuths">azimuths</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTrackerResult.spreading_factors">spreading_factors</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTrackerResult.raypaths">raypaths</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaveFrontTrackerResult.wavefronts">wavefronts</a>
                        </li>
                        <li>
                                <a class="function" href="#WaveFrontTrackerResult.to_dataframe">to_dataframe</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#LibSWMP">LibSWMP</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#LibSWMP.__init__">LibSWMP</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.check_error">check_error</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.read_configuration">read_configuration</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.run_forward">run_forward</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.run_single_source">run_single_source</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.get_n_sources">get_n_sources</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_file_output">set_file_output</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.get_arrivals">get_arrivals</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.get_raypaths">get_raypaths</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.get_wavefronts">get_wavefronts</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_dt">set_dt</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_max_iterations">set_max_iterations</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_n_bichar_nodes">set_n_bichar_nodes</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_computation_mode">set_computation_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_ode_solver">set_ode_solver</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_interpolator">set_interpolator</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_max_arrivals">set_max_arrivals</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_coordinate_system">set_coordinate_system</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_earth_radius">set_earth_radius</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.apply_options">apply_options</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_velocity_model">set_velocity_model</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_sources">set_sources</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.set_receivers">set_receivers</a>
                        </li>
                        <li>
                                <a class="function" href="#LibSWMP.get_velocity_model">get_velocity_model</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SWMPError">SWMPError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#TrackerOptions">TrackerOptions</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TrackerOptions.__init__">TrackerOptions</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.earth_radius">earth_radius</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.coordinate_system">coordinate_system</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.dt">dt</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.max_iterations">max_iterations</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.n_bichar_nodes">n_bichar_nodes</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.ode_solver">ode_solver</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.interpolator">interpolator</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.computation_mode">computation_mode</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.max_arrivals">max_arrivals</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.source_specific_receivers">source_specific_receivers</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.extract_raypaths">extract_raypaths</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.extract_wavefronts">extract_wavefronts</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.extract_frechet">extract_frechet</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.raypath_storage">raypath_storage</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.wavefront_interval">wavefront_interval</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.velocity_file">velocity_file</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.sources_file">sources_file</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.receivers_file">receivers_file</a>
                        </li>
                        <li>
                                <a class="variable" href="#TrackerOptions.receiver_mode_file">receiver_mode_file</a>
                        </li>
                        <li>
                                <a class="function" href="#TrackerOptions.to_dict">to_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#TrackerOptions.from_config_file">from_config_file</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#VelocityModel2D">VelocityModel2D</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#VelocityModel2D.__init__">VelocityModel2D</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.velocities">velocities</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.x0">x0</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.y0">y0</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.dx">dx</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.dy">dy</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.cushion_nodes">cushion_nodes</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.nx">nx</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.ny">ny</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.x1">x1</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.y1">y1</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel2D.extent">extent</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Sources">Sources</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Sources.__init__">Sources</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sources.positions">positions</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sources.source_type">source_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sources.angles">angles</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sources.n_sources">n_sources</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Receivers">Receivers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Receivers.__init__">Receivers</a>
                        </li>
                        <li>
                                <a class="variable" href="#Receivers.positions">positions</a>
                        </li>
                        <li>
                                <a class="variable" href="#Receivers.n_receivers">n_receivers</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#create_constant_velocity_model">create_constant_velocity_model</a>
            </li>
            <li>
                    <a class="function" href="#create_gradient_velocity_model">create_gradient_velocity_model</a>
            </li>
            <li>
                    <a class="function" href="#write_velocity_model_file">write_velocity_model_file</a>
            </li>
            <li>
                    <a class="function" href="#write_sources_file">write_sources_file</a>
            </li>
            <li>
                    <a class="function" href="#write_receivers_file">write_receivers_file</a>
            </li>
            <li>
                    <a class="function" href="#write_config_file">write_config_file</a>
            </li>
            <li>
                    <a class="class" href="#VelocityModel">VelocityModel</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#VelocityModel.x0">x0</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel.y0">y0</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel.nx">nx</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel.ny">ny</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel.dx">dx</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel.dy">dy</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel.cn">cn</a>
                        </li>
                        <li>
                                <a class="variable" href="#VelocityModel.m">m</a>
                        </li>
                        <li>
                                <a class="function" href="#VelocityModel.read">read</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TravelTimeData">TravelTimeData</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#TravelTimeData.obs">obs</a>
                        </li>
                        <li>
                                <a class="variable" href="#TravelTimeData.pred">pred</a>
                        </li>
                        <li>
                                <a class="variable" href="#TravelTimeData.joined">joined</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#VelocityModelGenerator">VelocityModelGenerator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#VelocityModelGenerator.read_configuration">read_configuration</a>
                        </li>
                        <li>
                                <a class="function" href="#VelocityModelGenerator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ObservationGenerator">ObservationGenerator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ObservationGenerator.read_configuration">read_configuration</a>
                        </li>
                        <li>
                                <a class="function" href="#ObservationGenerator.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Visualisation">Visualisation</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Visualisation.rp">rp</a>
                        </li>
                        <li>
                                <a class="variable" href="#Visualisation.wf">wf</a>
                        </li>
                        <li>
                                <a class="function" href="#Visualisation.read_raypaths">read_raypaths</a>
                        </li>
                        <li>
                                <a class="function" href="#Visualisation.read_wavefronts">read_wavefronts</a>
                        </li>
                        <li>
                                <a class="function" href="#Visualisation.get_model_figure">get_model_figure</a>
                        </li>
                        <li>
                                <a class="function" href="#Visualisation.get_raypath_figure">get_raypath_figure</a>
                        </li>
                        <li>
                                <a class="function" href="#Visualisation.get_wavefront_figure">get_wavefront_figure</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22160%22%20viewBox%3D%220%200%20150%2080%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M132.316%2048.886c.276-4.679%202.342-6.698%204.409-7.982s4.27-1.165%206.751-1.055c1.586.07%203.044.156%204.222-.482%201.142-.619%202.026-1.932%202.162-3.739.268-3.576-1.929-5.368-5.006-5.551s-7.599.524-10.517%201.606c-4.455%201.652-8.588%206.606-9.552%208.992s-2.342%206.193-1.745%2010.873%202.664%209.221%205.878%2011.79%205.878%203.808%2010.103%204.312%203.444.229%206.062.229%205.006-2.202%204.914-4.909-2.296-5.001-4.501-4.863-3.077.505-5.281.229-7.715-2.064-7.899-9.451z%22%20fill%3D%22%23198754%22/%3E%3Ccircle%20cx%3D%22101.504%22%20cy%3D%2248.943%22%20r%3D%2214.208%22%20fill%3D%22none%22%20stroke%3D%22%23198754%22%20stroke-width%3D%229.354%22/%3E%3Cpath%20d%3D%22M87.81.002c-3.637.065-5.001.454-7.014%201.232s-3.443%201.363-6.3%204.282c-1.723%201.76-3.148%205.019-3.776%207.329-.413%201.521-.316%202.63-.316%202.63l-.195%2034.612c.065%205.774-6.755%208.305-9.612%208.37s-9.678-1.038-9.743-9.408%207.128-9.521%208.362-9.521c1.413-.13%202.526-.021%203.718-.016%202.071.009%204.157-.778%204.092-4.671s-4.157-4.736-4.157-4.736c-6.3-.843-11.43%202.206-11.43%202.206S40.917%2038.15%2041.372%2049.634%2051.568%2068.19%2061.311%2068.125s18.316-7.007%2018.445-17.193l.13-22.772c.046-2.291%202.683-3.644%204.476-4.203.745-.232%201.694-.274%201.694-.274l10.457-.13s4.871-.324%207.729-3.114%204.352-6.294%204.352-6.294.974-3.049.13-4.606-.195-1.233-2.792-3.309-8.573-4.477-8.573-4.477S91.447-.063%2087.81.002zM0%2047.169l.065%2028.417S0%2080.127%204.481%2079.997s5.072-3.866%205.049-4.152l-.113-28.482s1.624-7.656%209.937-7.721%2010.002%206.942%2010.002%208.499-.909%2010.51-9.093%2010.51c-.948%200-2.99-.567-4.145-.272-3.919%201-3.194%204.554-3.194%204.554s.065%205.061%207.404%204.996%2018.575-6.034%2018.575-19.074S26.953%2030.04%2019.549%2029.91%201.234%2035.296%200%2047.169z%22%20fill%3D%22%23198754%22/%3E%3Cg%20transform%3D%22matrix%28.325601%200%200%20.325256%20-10.32669%20-45.802786%29%22%3E%3Ccircle%20cx%3D%22297.554%22%20cy%3D%22172.286%22%20r%3D%2216.5%22%20fill%3D%22%23fff%22/%3E%3Cellipse%20cx%3D%22297.709%22%20cy%3D%22172.642%22%20rx%3D%2211.071%22%20ry%3D%2210.871%22%20fill%3D%22%23105a48%22/%3E%3Ccircle%20cx%3D%22304.104%22%20cy%3D%22167.667%22%20r%3D%224.5%22%20fill%3D%22%23fff%22/%3E%3C/g%3E%3Cpath%20d%3D%22M94.661%2017.032l.893-1.476s.99.714%201.916.925%201.575.114%202.955.114l14.565-.162c1.283-.032%203.085-.762%203.02-3.293s-.373-3.503-.373-3.503l1.283-.487s.52.503.877%201.573.309%201.995.292%202.66-.227%201.541-.227%201.541%201.564-.308%202.359-1.038.823-.779%201.489-1.508.812-.86.812-.86.552-.13.877.26.341.957.065%201.46-1.672%202.206-3.247%203.066-2.76%201.427-3.929%201.768-3.848.73-7.063.714l-10.944-.114s-2.143-.081-3.02-.373-2.241-.973-2.598-1.265z%22%20fill%3D%22%23d36d49%22/%3E%3Cg%20fill%3D%22%23105a48%22%3E%3Cellipse%20cx%3D%2293.052%22%20cy%3D%2243.567%22%20rx%3D%22.869%22%20ry%3D%221.014%22%20transform%3D%22rotate%28341.022%29%22/%3E%3Cellipse%20cx%3D%22104.3%22%20cy%3D%22-16.184%22%20rx%3D%22.865%22%20ry%3D%221.009%22%20transform%3D%22rotate%2814.786%29%22/%3E%3C/g%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
pyswmp    </h1>

                        <div class="docstring"><p>Python wrapper for SWMP: Surface Wave Multipathing ray tracing.</p>

<p>This package provides a modern Python interface to the SWMP Fortran library
with support for parallel execution and in-memory data handling.</p>

<p>Main classes:
    WaveFrontTracker: High-level solver with pool-based parallelism
    WaveFrontTrackerResult: Result data structure with aggregation support
    LibSWMP: Low-level ctypes wrapper (advanced users)</p>

<p>Legacy classes (from _pyswmp):
    VelocityModelGenerator: Generate synthetic velocity models
    ObservationGenerator: Generate synthetic observations
    Visualisation: Plotting utilities</p>
</div>

                        <input id="mod-pyswmp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-pyswmp-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;Python wrapper for SWMP: Surface Wave Multipathing ray tracing.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="sd">This package provides a modern Python interface to the SWMP Fortran library</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="sd">with support for parallel execution and in-memory data handling.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="sd">Main classes:</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="sd">    WaveFrontTracker: High-level solver with pool-based parallelism</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="sd">    WaveFrontTrackerResult: Result data structure with aggregation support</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">    LibSWMP: Low-level ctypes wrapper (advanced users)</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="sd">Legacy classes (from _pyswmp):</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="sd">    VelocityModelGenerator: Generate synthetic velocity models</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="sd">    ObservationGenerator: Generate synthetic observations</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="sd">    Visualisation: Plotting utilities</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.__version__</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="c1"># New parallel-capable implementation</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.solvers</span><span class="w"> </span><span class="kn">import</span> <span class="n">WaveFrontTracker</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">WaveFrontTrackerResult</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">._libswmp</span><span class="w"> </span><span class="kn">import</span> <span class="n">LibSWMP</span><span class="p">,</span> <span class="n">SWMPError</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrackerOptions</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>    <span class="n">VelocityModel2D</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>    <span class="n">Sources</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>    <span class="n">Receivers</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>    <span class="n">create_constant_velocity_model</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>    <span class="n">create_gradient_velocity_model</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>    <span class="n">write_velocity_model_file</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>    <span class="n">write_sources_file</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>    <span class="n">write_receivers_file</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="n">write_config_file</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="p">)</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a><span class="c1"># Legacy classes (for backward compatibility)</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">._pyswmp</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="n">VelocityModel</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="n">TravelTimeData</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>    <span class="n">VelocityModelGenerator</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="n">ObservationGenerator</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="n">Visualisation</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a><span class="p">)</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="c1"># Version</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>    <span class="s2">&quot;__version__&quot;</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="c1"># New implementation</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>    <span class="s2">&quot;WaveFrontTracker&quot;</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>    <span class="s2">&quot;WaveFrontTrackerResult&quot;</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a>    <span class="s2">&quot;LibSWMP&quot;</span><span class="p">,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>    <span class="s2">&quot;SWMPError&quot;</span><span class="p">,</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>    <span class="s2">&quot;TrackerOptions&quot;</span><span class="p">,</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>    <span class="c1"># Data structures</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a>    <span class="s2">&quot;VelocityModel2D&quot;</span><span class="p">,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>    <span class="s2">&quot;Sources&quot;</span><span class="p">,</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a>    <span class="s2">&quot;Receivers&quot;</span><span class="p">,</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a>    <span class="s2">&quot;create_constant_velocity_model&quot;</span><span class="p">,</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a>    <span class="s2">&quot;create_gradient_velocity_model&quot;</span><span class="p">,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">60</span></a>    <span class="s2">&quot;write_velocity_model_file&quot;</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">61</span></a>    <span class="s2">&quot;write_sources_file&quot;</span><span class="p">,</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">62</span></a>    <span class="s2">&quot;write_receivers_file&quot;</span><span class="p">,</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">63</span></a>    <span class="s2">&quot;write_config_file&quot;</span><span class="p">,</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">64</span></a>    <span class="c1"># Legacy classes</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">65</span></a>    <span class="s2">&quot;VelocityModel&quot;</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">66</span></a>    <span class="s2">&quot;TravelTimeData&quot;</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">67</span></a>    <span class="s2">&quot;VelocityModelGenerator&quot;</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">68</span></a>    <span class="s2">&quot;ObservationGenerator&quot;</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">69</span></a>    <span class="s2">&quot;Visualisation&quot;</span><span class="p">,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">70</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="__version__">
                    <div class="attr variable">
            <span class="name">__version__</span>        =
<span class="default_value">&#39;0.2.0&#39;</span>

        
    </div>
    <a class="headerlink" href="#__version__"></a>
    
    

                </section>
                <section id="WaveFrontTracker">
                            <input id="WaveFrontTracker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">WaveFrontTracker</span>:

                <label class="view-source-button" for="WaveFrontTracker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WaveFrontTracker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WaveFrontTracker-129"><a href="#WaveFrontTracker-129"><span class="linenos">129</span></a><span class="k">class</span><span class="w"> </span><span class="nc">WaveFrontTracker</span><span class="p">:</span>
</span><span id="WaveFrontTracker-130"><a href="#WaveFrontTracker-130"><span class="linenos">130</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Wavefront tracker for computing seismic ray paths and travel times.</span>
</span><span id="WaveFrontTracker-131"><a href="#WaveFrontTracker-131"><span class="linenos">131</span></a>
</span><span id="WaveFrontTracker-132"><a href="#WaveFrontTracker-132"><span class="linenos">132</span></a><span class="sd">    This class provides a high-level interface to the SWMP Fortran library,</span>
</span><span id="WaveFrontTracker-133"><a href="#WaveFrontTracker-133"><span class="linenos">133</span></a><span class="sd">    with support for parallel execution over sources using pool executors.</span>
</span><span id="WaveFrontTracker-134"><a href="#WaveFrontTracker-134"><span class="linenos">134</span></a>
</span><span id="WaveFrontTracker-135"><a href="#WaveFrontTracker-135"><span class="linenos">135</span></a><span class="sd">    Example (sequential):</span>
</span><span id="WaveFrontTracker-136"><a href="#WaveFrontTracker-136"><span class="linenos">136</span></a><span class="sd">        &gt;&gt;&gt; tracker = WaveFrontTracker(&#39;config.in&#39;)</span>
</span><span id="WaveFrontTracker-137"><a href="#WaveFrontTracker-137"><span class="linenos">137</span></a><span class="sd">        &gt;&gt;&gt; result = tracker.forward()</span>
</span><span id="WaveFrontTracker-138"><a href="#WaveFrontTracker-138"><span class="linenos">138</span></a><span class="sd">        &gt;&gt;&gt; df = result.to_dataframe()</span>
</span><span id="WaveFrontTracker-139"><a href="#WaveFrontTracker-139"><span class="linenos">139</span></a>
</span><span id="WaveFrontTracker-140"><a href="#WaveFrontTracker-140"><span class="linenos">140</span></a><span class="sd">    Example (parallel with ProcessPoolExecutor):</span>
</span><span id="WaveFrontTracker-141"><a href="#WaveFrontTracker-141"><span class="linenos">141</span></a><span class="sd">        &gt;&gt;&gt; from concurrent.futures import ProcessPoolExecutor</span>
</span><span id="WaveFrontTracker-142"><a href="#WaveFrontTracker-142"><span class="linenos">142</span></a><span class="sd">        &gt;&gt;&gt; tracker = WaveFrontTracker(&#39;config.in&#39;)</span>
</span><span id="WaveFrontTracker-143"><a href="#WaveFrontTracker-143"><span class="linenos">143</span></a><span class="sd">        &gt;&gt;&gt; with ProcessPoolExecutor(max_workers=4) as pool:</span>
</span><span id="WaveFrontTracker-144"><a href="#WaveFrontTracker-144"><span class="linenos">144</span></a><span class="sd">        ...     result = tracker.forward(pool=pool)</span>
</span><span id="WaveFrontTracker-145"><a href="#WaveFrontTracker-145"><span class="linenos">145</span></a>
</span><span id="WaveFrontTracker-146"><a href="#WaveFrontTracker-146"><span class="linenos">146</span></a><span class="sd">    Example (parallel with schwimmbad):</span>
</span><span id="WaveFrontTracker-147"><a href="#WaveFrontTracker-147"><span class="linenos">147</span></a><span class="sd">        &gt;&gt;&gt; from schwimmbad import MPIPool</span>
</span><span id="WaveFrontTracker-148"><a href="#WaveFrontTracker-148"><span class="linenos">148</span></a><span class="sd">        &gt;&gt;&gt; tracker = WaveFrontTracker(&#39;config.in&#39;)</span>
</span><span id="WaveFrontTracker-149"><a href="#WaveFrontTracker-149"><span class="linenos">149</span></a><span class="sd">        &gt;&gt;&gt; with MPIPool() as pool:</span>
</span><span id="WaveFrontTracker-150"><a href="#WaveFrontTracker-150"><span class="linenos">150</span></a><span class="sd">        ...     result = tracker.forward(pool=pool)</span>
</span><span id="WaveFrontTracker-151"><a href="#WaveFrontTracker-151"><span class="linenos">151</span></a>
</span><span id="WaveFrontTracker-152"><a href="#WaveFrontTracker-152"><span class="linenos">152</span></a><span class="sd">    Args:</span>
</span><span id="WaveFrontTracker-153"><a href="#WaveFrontTracker-153"><span class="linenos">153</span></a><span class="sd">        config_file: Path to RAT configuration file (specifies model, sources, receivers)</span>
</span><span id="WaveFrontTracker-154"><a href="#WaveFrontTracker-154"><span class="linenos">154</span></a><span class="sd">        options: Optional TrackerOptions to override config file settings</span>
</span><span id="WaveFrontTracker-155"><a href="#WaveFrontTracker-155"><span class="linenos">155</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker-156"><a href="#WaveFrontTracker-156"><span class="linenos">156</span></a>
</span><span id="WaveFrontTracker-157"><a href="#WaveFrontTracker-157"><span class="linenos">157</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="WaveFrontTracker-158"><a href="#WaveFrontTracker-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="WaveFrontTracker-159"><a href="#WaveFrontTracker-159"><span class="linenos">159</span></a>        <span class="n">config_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="WaveFrontTracker-160"><a href="#WaveFrontTracker-160"><span class="linenos">160</span></a>        <span class="n">model</span><span class="p">:</span> <span class="s1">&#39;VelocityModel2D&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="WaveFrontTracker-161"><a href="#WaveFrontTracker-161"><span class="linenos">161</span></a>        <span class="n">sources</span><span class="p">:</span> <span class="s1">&#39;Sources&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="WaveFrontTracker-162"><a href="#WaveFrontTracker-162"><span class="linenos">162</span></a>        <span class="n">receivers</span><span class="p">:</span> <span class="s1">&#39;Receivers&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="WaveFrontTracker-163"><a href="#WaveFrontTracker-163"><span class="linenos">163</span></a>        <span class="n">options</span><span class="p">:</span> <span class="s1">&#39;TrackerOptions&#39;</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="WaveFrontTracker-164"><a href="#WaveFrontTracker-164"><span class="linenos">164</span></a>    <span class="p">):</span>
</span><span id="WaveFrontTracker-165"><a href="#WaveFrontTracker-165"><span class="linenos">165</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize WaveFrontTracker.</span>
</span><span id="WaveFrontTracker-166"><a href="#WaveFrontTracker-166"><span class="linenos">166</span></a>
</span><span id="WaveFrontTracker-167"><a href="#WaveFrontTracker-167"><span class="linenos">167</span></a><span class="sd">        Two modes of initialization:</span>
</span><span id="WaveFrontTracker-168"><a href="#WaveFrontTracker-168"><span class="linenos">168</span></a>
</span><span id="WaveFrontTracker-169"><a href="#WaveFrontTracker-169"><span class="linenos">169</span></a><span class="sd">        1. File-based (traditional):</span>
</span><span id="WaveFrontTracker-170"><a href="#WaveFrontTracker-170"><span class="linenos">170</span></a><span class="sd">           - Provide config_file which specifies model, sources, receivers</span>
</span><span id="WaveFrontTracker-171"><a href="#WaveFrontTracker-171"><span class="linenos">171</span></a><span class="sd">           - Optionally override parameters with options</span>
</span><span id="WaveFrontTracker-172"><a href="#WaveFrontTracker-172"><span class="linenos">172</span></a>
</span><span id="WaveFrontTracker-173"><a href="#WaveFrontTracker-173"><span class="linenos">173</span></a><span class="sd">        2. File-free (new):</span>
</span><span id="WaveFrontTracker-174"><a href="#WaveFrontTracker-174"><span class="linenos">174</span></a><span class="sd">           - Provide model, sources, receivers as Python objects</span>
</span><span id="WaveFrontTracker-175"><a href="#WaveFrontTracker-175"><span class="linenos">175</span></a><span class="sd">           - Optionally provide options for configuration</span>
</span><span id="WaveFrontTracker-176"><a href="#WaveFrontTracker-176"><span class="linenos">176</span></a>
</span><span id="WaveFrontTracker-177"><a href="#WaveFrontTracker-177"><span class="linenos">177</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTracker-178"><a href="#WaveFrontTracker-178"><span class="linenos">178</span></a><span class="sd">            config_file: Path to RAT configuration file (traditional mode)</span>
</span><span id="WaveFrontTracker-179"><a href="#WaveFrontTracker-179"><span class="linenos">179</span></a><span class="sd">            model: VelocityModel2D instance (file-free mode)</span>
</span><span id="WaveFrontTracker-180"><a href="#WaveFrontTracker-180"><span class="linenos">180</span></a><span class="sd">            sources: Sources instance (file-free mode)</span>
</span><span id="WaveFrontTracker-181"><a href="#WaveFrontTracker-181"><span class="linenos">181</span></a><span class="sd">            receivers: Receivers instance (file-free mode)</span>
</span><span id="WaveFrontTracker-182"><a href="#WaveFrontTracker-182"><span class="linenos">182</span></a><span class="sd">            options: Optional TrackerOptions to set/override parameters</span>
</span><span id="WaveFrontTracker-183"><a href="#WaveFrontTracker-183"><span class="linenos">183</span></a>
</span><span id="WaveFrontTracker-184"><a href="#WaveFrontTracker-184"><span class="linenos">184</span></a><span class="sd">        Raises:</span>
</span><span id="WaveFrontTracker-185"><a href="#WaveFrontTracker-185"><span class="linenos">185</span></a><span class="sd">            ValueError: If neither mode has sufficient parameters</span>
</span><span id="WaveFrontTracker-186"><a href="#WaveFrontTracker-186"><span class="linenos">186</span></a>
</span><span id="WaveFrontTracker-187"><a href="#WaveFrontTracker-187"><span class="linenos">187</span></a><span class="sd">        Example (file-free):</span>
</span><span id="WaveFrontTracker-188"><a href="#WaveFrontTracker-188"><span class="linenos">188</span></a><span class="sd">            &gt;&gt;&gt; import pyswmp</span>
</span><span id="WaveFrontTracker-189"><a href="#WaveFrontTracker-189"><span class="linenos">189</span></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
</span><span id="WaveFrontTracker-190"><a href="#WaveFrontTracker-190"><span class="linenos">190</span></a><span class="sd">            &gt;&gt;&gt; model = pyswmp.create_constant_velocity_model(100, 80, 110, -45, 0.5, 0.5, 3.5)</span>
</span><span id="WaveFrontTracker-191"><a href="#WaveFrontTracker-191"><span class="linenos">191</span></a><span class="sd">            &gt;&gt;&gt; sources = pyswmp.Sources(np.array([[135.0, -25.0]]))</span>
</span><span id="WaveFrontTracker-192"><a href="#WaveFrontTracker-192"><span class="linenos">192</span></a><span class="sd">            &gt;&gt;&gt; receivers = pyswmp.Receivers(np.array([[120.0, -30.0]]))</span>
</span><span id="WaveFrontTracker-193"><a href="#WaveFrontTracker-193"><span class="linenos">193</span></a><span class="sd">            &gt;&gt;&gt; opts = pyswmp.TrackerOptions(coordinate_system=2)</span>
</span><span id="WaveFrontTracker-194"><a href="#WaveFrontTracker-194"><span class="linenos">194</span></a><span class="sd">            &gt;&gt;&gt; tracker = pyswmp.WaveFrontTracker(model=model, sources=sources, receivers=receivers, options=opts)</span>
</span><span id="WaveFrontTracker-195"><a href="#WaveFrontTracker-195"><span class="linenos">195</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker-196"><a href="#WaveFrontTracker-196"><span class="linenos">196</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrackerOptions</span>
</span><span id="WaveFrontTracker-197"><a href="#WaveFrontTracker-197"><span class="linenos">197</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">VelocityModel2D</span><span class="p">,</span> <span class="n">Sources</span><span class="p">,</span> <span class="n">Receivers</span>
</span><span id="WaveFrontTracker-198"><a href="#WaveFrontTracker-198"><span class="linenos">198</span></a>
</span><span id="WaveFrontTracker-199"><a href="#WaveFrontTracker-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span> <span class="k">if</span> <span class="n">config_file</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="WaveFrontTracker-200"><a href="#WaveFrontTracker-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>
</span><span id="WaveFrontTracker-201"><a href="#WaveFrontTracker-201"><span class="linenos">201</span></a>
</span><span id="WaveFrontTracker-202"><a href="#WaveFrontTracker-202"><span class="linenos">202</span></a>        <span class="c1"># Store options as dict for serialization to workers</span>
</span><span id="WaveFrontTracker-203"><a href="#WaveFrontTracker-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_options_dict</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">if</span> <span class="n">options</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="WaveFrontTracker-204"><a href="#WaveFrontTracker-204"><span class="linenos">204</span></a>
</span><span id="WaveFrontTracker-205"><a href="#WaveFrontTracker-205"><span class="linenos">205</span></a>        <span class="c1"># Create library instance for metadata queries</span>
</span><span id="WaveFrontTracker-206"><a href="#WaveFrontTracker-206"><span class="linenos">206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span> <span class="o">=</span> <span class="n">LibSWMP</span><span class="p">()</span>
</span><span id="WaveFrontTracker-207"><a href="#WaveFrontTracker-207"><span class="linenos">207</span></a>
</span><span id="WaveFrontTracker-208"><a href="#WaveFrontTracker-208"><span class="linenos">208</span></a>        <span class="c1"># Determine initialization mode</span>
</span><span id="WaveFrontTracker-209"><a href="#WaveFrontTracker-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="n">config_file</span><span class="p">:</span>
</span><span id="WaveFrontTracker-210"><a href="#WaveFrontTracker-210"><span class="linenos">210</span></a>            <span class="c1"># Traditional file-based initialization</span>
</span><span id="WaveFrontTracker-211"><a href="#WaveFrontTracker-211"><span class="linenos">211</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">read_configuration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">)</span>
</span><span id="WaveFrontTracker-212"><a href="#WaveFrontTracker-212"><span class="linenos">212</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_file_free</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="WaveFrontTracker-213"><a href="#WaveFrontTracker-213"><span class="linenos">213</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sources</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">receivers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WaveFrontTracker-214"><a href="#WaveFrontTracker-214"><span class="linenos">214</span></a>            <span class="c1"># File-free initialization</span>
</span><span id="WaveFrontTracker-215"><a href="#WaveFrontTracker-215"><span class="linenos">215</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_velocity_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="WaveFrontTracker-216"><a href="#WaveFrontTracker-216"><span class="linenos">216</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_sources</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
</span><span id="WaveFrontTracker-217"><a href="#WaveFrontTracker-217"><span class="linenos">217</span></a>
</span><span id="WaveFrontTracker-218"><a href="#WaveFrontTracker-218"><span class="linenos">218</span></a>            <span class="c1"># Determine max_arrivals from options or use default</span>
</span><span id="WaveFrontTracker-219"><a href="#WaveFrontTracker-219"><span class="linenos">219</span></a>            <span class="n">max_arrivals</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">max_arrivals</span> <span class="k">if</span> <span class="n">options</span> <span class="k">else</span> <span class="mi">10</span>
</span><span id="WaveFrontTracker-220"><a href="#WaveFrontTracker-220"><span class="linenos">220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_receivers</span><span class="p">(</span><span class="n">receivers</span><span class="p">,</span> <span class="n">max_arrivals</span><span class="o">=</span><span class="n">max_arrivals</span><span class="p">)</span>
</span><span id="WaveFrontTracker-221"><a href="#WaveFrontTracker-221"><span class="linenos">221</span></a>
</span><span id="WaveFrontTracker-222"><a href="#WaveFrontTracker-222"><span class="linenos">222</span></a>            <span class="c1"># Store objects for worker serialization</span>
</span><span id="WaveFrontTracker-223"><a href="#WaveFrontTracker-223"><span class="linenos">223</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">model</span>
</span><span id="WaveFrontTracker-224"><a href="#WaveFrontTracker-224"><span class="linenos">224</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">sources</span>
</span><span id="WaveFrontTracker-225"><a href="#WaveFrontTracker-225"><span class="linenos">225</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="n">receivers</span>
</span><span id="WaveFrontTracker-226"><a href="#WaveFrontTracker-226"><span class="linenos">226</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_file_free</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="WaveFrontTracker-227"><a href="#WaveFrontTracker-227"><span class="linenos">227</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="WaveFrontTracker-228"><a href="#WaveFrontTracker-228"><span class="linenos">228</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WaveFrontTracker-229"><a href="#WaveFrontTracker-229"><span class="linenos">229</span></a>                <span class="s2">&quot;Must provide either:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="WaveFrontTracker-230"><a href="#WaveFrontTracker-230"><span class="linenos">230</span></a>                <span class="s2">&quot;  1. config_file (traditional mode), or</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="WaveFrontTracker-231"><a href="#WaveFrontTracker-231"><span class="linenos">231</span></a>                <span class="s2">&quot;  2. model, sources, and receivers (file-free mode)&quot;</span>
</span><span id="WaveFrontTracker-232"><a href="#WaveFrontTracker-232"><span class="linenos">232</span></a>            <span class="p">)</span>
</span><span id="WaveFrontTracker-233"><a href="#WaveFrontTracker-233"><span class="linenos">233</span></a>
</span><span id="WaveFrontTracker-234"><a href="#WaveFrontTracker-234"><span class="linenos">234</span></a>        <span class="c1"># Apply options if provided</span>
</span><span id="WaveFrontTracker-235"><a href="#WaveFrontTracker-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
</span><span id="WaveFrontTracker-236"><a href="#WaveFrontTracker-236"><span class="linenos">236</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">apply_options</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
</span><span id="WaveFrontTracker-237"><a href="#WaveFrontTracker-237"><span class="linenos">237</span></a>
</span><span id="WaveFrontTracker-238"><a href="#WaveFrontTracker-238"><span class="linenos">238</span></a>        <span class="c1"># Cache number of sources</span>
</span><span id="WaveFrontTracker-239"><a href="#WaveFrontTracker-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_n_sources</span><span class="p">()</span>
</span><span id="WaveFrontTracker-240"><a href="#WaveFrontTracker-240"><span class="linenos">240</span></a>
</span><span id="WaveFrontTracker-241"><a href="#WaveFrontTracker-241"><span class="linenos">241</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_serialize_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WaveFrontTracker-242"><a href="#WaveFrontTracker-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialize model, sources, receivers for worker processes.</span>
</span><span id="WaveFrontTracker-243"><a href="#WaveFrontTracker-243"><span class="linenos">243</span></a>
</span><span id="WaveFrontTracker-244"><a href="#WaveFrontTracker-244"><span class="linenos">244</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTracker-245"><a href="#WaveFrontTracker-245"><span class="linenos">245</span></a><span class="sd">            Tuple of (model_dict, sources_dict, receivers_dict) or (None, None, None)</span>
</span><span id="WaveFrontTracker-246"><a href="#WaveFrontTracker-246"><span class="linenos">246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker-247"><a href="#WaveFrontTracker-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_free</span><span class="p">:</span>
</span><span id="WaveFrontTracker-248"><a href="#WaveFrontTracker-248"><span class="linenos">248</span></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="WaveFrontTracker-249"><a href="#WaveFrontTracker-249"><span class="linenos">249</span></a>
</span><span id="WaveFrontTracker-250"><a href="#WaveFrontTracker-250"><span class="linenos">250</span></a>        <span class="c1"># Serialize model</span>
</span><span id="WaveFrontTracker-251"><a href="#WaveFrontTracker-251"><span class="linenos">251</span></a>        <span class="n">model_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="WaveFrontTracker-252"><a href="#WaveFrontTracker-252"><span class="linenos">252</span></a>            <span class="s1">&#39;velocities&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
</span><span id="WaveFrontTracker-253"><a href="#WaveFrontTracker-253"><span class="linenos">253</span></a>            <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span>
</span><span id="WaveFrontTracker-254"><a href="#WaveFrontTracker-254"><span class="linenos">254</span></a>            <span class="s1">&#39;y0&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span>
</span><span id="WaveFrontTracker-255"><a href="#WaveFrontTracker-255"><span class="linenos">255</span></a>            <span class="s1">&#39;dx&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span>
</span><span id="WaveFrontTracker-256"><a href="#WaveFrontTracker-256"><span class="linenos">256</span></a>            <span class="s1">&#39;dy&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span>
</span><span id="WaveFrontTracker-257"><a href="#WaveFrontTracker-257"><span class="linenos">257</span></a>            <span class="s1">&#39;cushion_nodes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">cushion_nodes</span>
</span><span id="WaveFrontTracker-258"><a href="#WaveFrontTracker-258"><span class="linenos">258</span></a>        <span class="p">}</span>
</span><span id="WaveFrontTracker-259"><a href="#WaveFrontTracker-259"><span class="linenos">259</span></a>
</span><span id="WaveFrontTracker-260"><a href="#WaveFrontTracker-260"><span class="linenos">260</span></a>        <span class="c1"># Serialize sources</span>
</span><span id="WaveFrontTracker-261"><a href="#WaveFrontTracker-261"><span class="linenos">261</span></a>        <span class="n">sources_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="WaveFrontTracker-262"><a href="#WaveFrontTracker-262"><span class="linenos">262</span></a>            <span class="s1">&#39;positions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
</span><span id="WaveFrontTracker-263"><a href="#WaveFrontTracker-263"><span class="linenos">263</span></a>            <span class="s1">&#39;source_type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">source_type</span>
</span><span id="WaveFrontTracker-264"><a href="#WaveFrontTracker-264"><span class="linenos">264</span></a>        <span class="p">}</span>
</span><span id="WaveFrontTracker-265"><a href="#WaveFrontTracker-265"><span class="linenos">265</span></a>
</span><span id="WaveFrontTracker-266"><a href="#WaveFrontTracker-266"><span class="linenos">266</span></a>        <span class="c1"># Serialize receivers</span>
</span><span id="WaveFrontTracker-267"><a href="#WaveFrontTracker-267"><span class="linenos">267</span></a>        <span class="n">receivers_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="WaveFrontTracker-268"><a href="#WaveFrontTracker-268"><span class="linenos">268</span></a>            <span class="s1">&#39;positions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="WaveFrontTracker-269"><a href="#WaveFrontTracker-269"><span class="linenos">269</span></a>        <span class="p">}</span>
</span><span id="WaveFrontTracker-270"><a href="#WaveFrontTracker-270"><span class="linenos">270</span></a>
</span><span id="WaveFrontTracker-271"><a href="#WaveFrontTracker-271"><span class="linenos">271</span></a>        <span class="k">return</span> <span class="n">model_dict</span><span class="p">,</span> <span class="n">sources_dict</span><span class="p">,</span> <span class="n">receivers_dict</span>
</span><span id="WaveFrontTracker-272"><a href="#WaveFrontTracker-272"><span class="linenos">272</span></a>
</span><span id="WaveFrontTracker-273"><a href="#WaveFrontTracker-273"><span class="linenos">273</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_pool_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pool</span><span class="p">):</span>
</span><span id="WaveFrontTracker-274"><a href="#WaveFrontTracker-274"><span class="linenos">274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect pool executor type and validate compatibility.</span>
</span><span id="WaveFrontTracker-275"><a href="#WaveFrontTracker-275"><span class="linenos">275</span></a>
</span><span id="WaveFrontTracker-276"><a href="#WaveFrontTracker-276"><span class="linenos">276</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTracker-277"><a href="#WaveFrontTracker-277"><span class="linenos">277</span></a><span class="sd">            pool: Pool executor instance</span>
</span><span id="WaveFrontTracker-278"><a href="#WaveFrontTracker-278"><span class="linenos">278</span></a>
</span><span id="WaveFrontTracker-279"><a href="#WaveFrontTracker-279"><span class="linenos">279</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTracker-280"><a href="#WaveFrontTracker-280"><span class="linenos">280</span></a><span class="sd">            Pool type string (&#39;process&#39;, &#39;schwimmbad&#39;, &#39;thread&#39;, or None)</span>
</span><span id="WaveFrontTracker-281"><a href="#WaveFrontTracker-281"><span class="linenos">281</span></a>
</span><span id="WaveFrontTracker-282"><a href="#WaveFrontTracker-282"><span class="linenos">282</span></a><span class="sd">        Raises:</span>
</span><span id="WaveFrontTracker-283"><a href="#WaveFrontTracker-283"><span class="linenos">283</span></a><span class="sd">            ValueError: If pool type is incompatible (e.g., ThreadPoolExecutor)</span>
</span><span id="WaveFrontTracker-284"><a href="#WaveFrontTracker-284"><span class="linenos">284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker-285"><a href="#WaveFrontTracker-285"><span class="linenos">285</span></a>        <span class="k">if</span> <span class="n">pool</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WaveFrontTracker-286"><a href="#WaveFrontTracker-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="WaveFrontTracker-287"><a href="#WaveFrontTracker-287"><span class="linenos">287</span></a>
</span><span id="WaveFrontTracker-288"><a href="#WaveFrontTracker-288"><span class="linenos">288</span></a>        <span class="n">pool_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="WaveFrontTracker-289"><a href="#WaveFrontTracker-289"><span class="linenos">289</span></a>        <span class="n">module</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span><span class="o">.</span><span class="vm">__module__</span>
</span><span id="WaveFrontTracker-290"><a href="#WaveFrontTracker-290"><span class="linenos">290</span></a>
</span><span id="WaveFrontTracker-291"><a href="#WaveFrontTracker-291"><span class="linenos">291</span></a>        <span class="c1"># Check for ThreadPoolExecutor (incompatible)</span>
</span><span id="WaveFrontTracker-292"><a href="#WaveFrontTracker-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="s1">&#39;ThreadPool&#39;</span> <span class="ow">in</span> <span class="n">pool_type</span><span class="p">:</span>
</span><span id="WaveFrontTracker-293"><a href="#WaveFrontTracker-293"><span class="linenos">293</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WaveFrontTracker-294"><a href="#WaveFrontTracker-294"><span class="linenos">294</span></a>                <span class="s2">&quot;ThreadPoolExecutor is not supported. Each worker needs an &quot;</span>
</span><span id="WaveFrontTracker-295"><a href="#WaveFrontTracker-295"><span class="linenos">295</span></a>                <span class="s2">&quot;independent Fortran library instance, which requires separate &quot;</span>
</span><span id="WaveFrontTracker-296"><a href="#WaveFrontTracker-296"><span class="linenos">296</span></a>                <span class="s2">&quot;processes. Use ProcessPoolExecutor or schwimmbad pools instead.&quot;</span>
</span><span id="WaveFrontTracker-297"><a href="#WaveFrontTracker-297"><span class="linenos">297</span></a>            <span class="p">)</span>
</span><span id="WaveFrontTracker-298"><a href="#WaveFrontTracker-298"><span class="linenos">298</span></a>
</span><span id="WaveFrontTracker-299"><a href="#WaveFrontTracker-299"><span class="linenos">299</span></a>        <span class="c1"># Detect schwimmbad pools</span>
</span><span id="WaveFrontTracker-300"><a href="#WaveFrontTracker-300"><span class="linenos">300</span></a>        <span class="k">if</span> <span class="s1">&#39;schwimmbad&#39;</span> <span class="ow">in</span> <span class="n">module</span><span class="p">:</span>
</span><span id="WaveFrontTracker-301"><a href="#WaveFrontTracker-301"><span class="linenos">301</span></a>            <span class="k">return</span> <span class="s1">&#39;schwimmbad&#39;</span>
</span><span id="WaveFrontTracker-302"><a href="#WaveFrontTracker-302"><span class="linenos">302</span></a>
</span><span id="WaveFrontTracker-303"><a href="#WaveFrontTracker-303"><span class="linenos">303</span></a>        <span class="c1"># Detect concurrent.futures ProcessPoolExecutor</span>
</span><span id="WaveFrontTracker-304"><a href="#WaveFrontTracker-304"><span class="linenos">304</span></a>        <span class="k">if</span> <span class="s1">&#39;concurrent.futures&#39;</span> <span class="ow">in</span> <span class="n">module</span> <span class="ow">and</span> <span class="s1">&#39;Process&#39;</span> <span class="ow">in</span> <span class="n">pool_type</span><span class="p">:</span>
</span><span id="WaveFrontTracker-305"><a href="#WaveFrontTracker-305"><span class="linenos">305</span></a>            <span class="k">return</span> <span class="s1">&#39;process&#39;</span>
</span><span id="WaveFrontTracker-306"><a href="#WaveFrontTracker-306"><span class="linenos">306</span></a>
</span><span id="WaveFrontTracker-307"><a href="#WaveFrontTracker-307"><span class="linenos">307</span></a>        <span class="c1"># Unknown pool type - warn but try to proceed</span>
</span><span id="WaveFrontTracker-308"><a href="#WaveFrontTracker-308"><span class="linenos">308</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="WaveFrontTracker-309"><a href="#WaveFrontTracker-309"><span class="linenos">309</span></a>            <span class="sa">f</span><span class="s2">&quot;Unknown pool type: </span><span class="si">{</span><span class="n">pool_type</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span id="WaveFrontTracker-310"><a href="#WaveFrontTracker-310"><span class="linenos">310</span></a>            <span class="s2">&quot;Attempting to use schwimmbad-style map() interface. &quot;</span>
</span><span id="WaveFrontTracker-311"><a href="#WaveFrontTracker-311"><span class="linenos">311</span></a>            <span class="s2">&quot;If this fails, use ProcessPoolExecutor or schwimmbad pools.&quot;</span>
</span><span id="WaveFrontTracker-312"><a href="#WaveFrontTracker-312"><span class="linenos">312</span></a>        <span class="p">)</span>
</span><span id="WaveFrontTracker-313"><a href="#WaveFrontTracker-313"><span class="linenos">313</span></a>        <span class="k">return</span> <span class="s1">&#39;schwimmbad&#39;</span>
</span><span id="WaveFrontTracker-314"><a href="#WaveFrontTracker-314"><span class="linenos">314</span></a>
</span><span id="WaveFrontTracker-315"><a href="#WaveFrontTracker-315"><span class="linenos">315</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span>
</span><span id="WaveFrontTracker-316"><a href="#WaveFrontTracker-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="WaveFrontTracker-317"><a href="#WaveFrontTracker-317"><span class="linenos">317</span></a>        <span class="n">pool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="WaveFrontTracker-318"><a href="#WaveFrontTracker-318"><span class="linenos">318</span></a>        <span class="n">extract_raypaths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="WaveFrontTracker-319"><a href="#WaveFrontTracker-319"><span class="linenos">319</span></a>        <span class="n">extract_wavefronts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="WaveFrontTracker-320"><a href="#WaveFrontTracker-320"><span class="linenos">320</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WaveFrontTrackerResult</span><span class="p">:</span>
</span><span id="WaveFrontTracker-321"><a href="#WaveFrontTracker-321"><span class="linenos">321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute wavefront tracking for all sources.</span>
</span><span id="WaveFrontTracker-322"><a href="#WaveFrontTracker-322"><span class="linenos">322</span></a>
</span><span id="WaveFrontTracker-323"><a href="#WaveFrontTracker-323"><span class="linenos">323</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTracker-324"><a href="#WaveFrontTracker-324"><span class="linenos">324</span></a><span class="sd">            pool: Optional pool executor for parallel execution.</span>
</span><span id="WaveFrontTracker-325"><a href="#WaveFrontTracker-325"><span class="linenos">325</span></a><span class="sd">                  Supports concurrent.futures.ProcessPoolExecutor</span>
</span><span id="WaveFrontTracker-326"><a href="#WaveFrontTracker-326"><span class="linenos">326</span></a><span class="sd">                  and schwimmbad pools (MPIPool, MultiPool, SerialPool).</span>
</span><span id="WaveFrontTracker-327"><a href="#WaveFrontTracker-327"><span class="linenos">327</span></a><span class="sd">            extract_raypaths: Whether to extract raypath data (default: False)</span>
</span><span id="WaveFrontTracker-328"><a href="#WaveFrontTracker-328"><span class="linenos">328</span></a><span class="sd">            extract_wavefronts: Whether to extract wavefront data (default: False)</span>
</span><span id="WaveFrontTracker-329"><a href="#WaveFrontTracker-329"><span class="linenos">329</span></a>
</span><span id="WaveFrontTracker-330"><a href="#WaveFrontTracker-330"><span class="linenos">330</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTracker-331"><a href="#WaveFrontTracker-331"><span class="linenos">331</span></a><span class="sd">            WaveFrontTrackerResult with arrivals, raypaths, and wavefronts</span>
</span><span id="WaveFrontTracker-332"><a href="#WaveFrontTracker-332"><span class="linenos">332</span></a>
</span><span id="WaveFrontTracker-333"><a href="#WaveFrontTracker-333"><span class="linenos">333</span></a><span class="sd">        Raises:</span>
</span><span id="WaveFrontTracker-334"><a href="#WaveFrontTracker-334"><span class="linenos">334</span></a><span class="sd">            ValueError: If pool type is incompatible</span>
</span><span id="WaveFrontTracker-335"><a href="#WaveFrontTracker-335"><span class="linenos">335</span></a><span class="sd">            SWMPError: If Fortran library encounters an error</span>
</span><span id="WaveFrontTracker-336"><a href="#WaveFrontTracker-336"><span class="linenos">336</span></a>
</span><span id="WaveFrontTracker-337"><a href="#WaveFrontTracker-337"><span class="linenos">337</span></a><span class="sd">        Example:</span>
</span><span id="WaveFrontTracker-338"><a href="#WaveFrontTracker-338"><span class="linenos">338</span></a><span class="sd">            &gt;&gt;&gt; tracker = WaveFrontTracker(&#39;config.in&#39;)</span>
</span><span id="WaveFrontTracker-339"><a href="#WaveFrontTracker-339"><span class="linenos">339</span></a><span class="sd">            &gt;&gt;&gt; result = tracker.forward(extract_raypaths=True)</span>
</span><span id="WaveFrontTracker-340"><a href="#WaveFrontTracker-340"><span class="linenos">340</span></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Computed {len(result.travel_times)} arrivals&quot;)</span>
</span><span id="WaveFrontTracker-341"><a href="#WaveFrontTracker-341"><span class="linenos">341</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker-342"><a href="#WaveFrontTracker-342"><span class="linenos">342</span></a>        <span class="k">if</span> <span class="n">pool</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WaveFrontTracker-343"><a href="#WaveFrontTracker-343"><span class="linenos">343</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_sequential</span><span class="p">(</span><span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">)</span>
</span><span id="WaveFrontTracker-344"><a href="#WaveFrontTracker-344"><span class="linenos">344</span></a>
</span><span id="WaveFrontTracker-345"><a href="#WaveFrontTracker-345"><span class="linenos">345</span></a>        <span class="n">pool_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detect_pool_type</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span>
</span><span id="WaveFrontTracker-346"><a href="#WaveFrontTracker-346"><span class="linenos">346</span></a>
</span><span id="WaveFrontTracker-347"><a href="#WaveFrontTracker-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="n">pool_type</span> <span class="o">==</span> <span class="s1">&#39;process&#39;</span><span class="p">:</span>
</span><span id="WaveFrontTracker-348"><a href="#WaveFrontTracker-348"><span class="linenos">348</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_concurrent_futures</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">)</span>
</span><span id="WaveFrontTracker-349"><a href="#WaveFrontTracker-349"><span class="linenos">349</span></a>        <span class="k">elif</span> <span class="n">pool_type</span> <span class="o">==</span> <span class="s1">&#39;schwimmbad&#39;</span><span class="p">:</span>
</span><span id="WaveFrontTracker-350"><a href="#WaveFrontTracker-350"><span class="linenos">350</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_schwimmbad</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">)</span>
</span><span id="WaveFrontTracker-351"><a href="#WaveFrontTracker-351"><span class="linenos">351</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="WaveFrontTracker-352"><a href="#WaveFrontTracker-352"><span class="linenos">352</span></a>            <span class="c1"># Fallback to sequential</span>
</span><span id="WaveFrontTracker-353"><a href="#WaveFrontTracker-353"><span class="linenos">353</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Could not detect pool type, falling back to sequential execution&quot;</span><span class="p">)</span>
</span><span id="WaveFrontTracker-354"><a href="#WaveFrontTracker-354"><span class="linenos">354</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_sequential</span><span class="p">(</span><span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">)</span>
</span><span id="WaveFrontTracker-355"><a href="#WaveFrontTracker-355"><span class="linenos">355</span></a>
</span><span id="WaveFrontTracker-356"><a href="#WaveFrontTracker-356"><span class="linenos">356</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_forward_sequential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">):</span>
</span><span id="WaveFrontTracker-357"><a href="#WaveFrontTracker-357"><span class="linenos">357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sequential execution (no parallelism).</span>
</span><span id="WaveFrontTracker-358"><a href="#WaveFrontTracker-358"><span class="linenos">358</span></a>
</span><span id="WaveFrontTracker-359"><a href="#WaveFrontTracker-359"><span class="linenos">359</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTracker-360"><a href="#WaveFrontTracker-360"><span class="linenos">360</span></a><span class="sd">            extract_raypaths: Whether to extract raypath data</span>
</span><span id="WaveFrontTracker-361"><a href="#WaveFrontTracker-361"><span class="linenos">361</span></a><span class="sd">            extract_wavefronts: Whether to extract wavefront data</span>
</span><span id="WaveFrontTracker-362"><a href="#WaveFrontTracker-362"><span class="linenos">362</span></a>
</span><span id="WaveFrontTracker-363"><a href="#WaveFrontTracker-363"><span class="linenos">363</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTracker-364"><a href="#WaveFrontTracker-364"><span class="linenos">364</span></a><span class="sd">            WaveFrontTrackerResult</span>
</span><span id="WaveFrontTracker-365"><a href="#WaveFrontTracker-365"><span class="linenos">365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker-366"><a href="#WaveFrontTracker-366"><span class="linenos">366</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WaveFrontTracker-367"><a href="#WaveFrontTracker-367"><span class="linenos">367</span></a>
</span><span id="WaveFrontTracker-368"><a href="#WaveFrontTracker-368"><span class="linenos">368</span></a>        <span class="c1"># Get serialized data for file-free mode</span>
</span><span id="WaveFrontTracker-369"><a href="#WaveFrontTracker-369"><span class="linenos">369</span></a>        <span class="n">model_dict</span><span class="p">,</span> <span class="n">sources_dict</span><span class="p">,</span> <span class="n">receivers_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serialize_data</span><span class="p">()</span>
</span><span id="WaveFrontTracker-370"><a href="#WaveFrontTracker-370"><span class="linenos">370</span></a>
</span><span id="WaveFrontTracker-371"><a href="#WaveFrontTracker-371"><span class="linenos">371</span></a>        <span class="k">for</span> <span class="n">source_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="WaveFrontTracker-372"><a href="#WaveFrontTracker-372"><span class="linenos">372</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">_calc_single_source_worker</span><span class="p">(</span>
</span><span id="WaveFrontTracker-373"><a href="#WaveFrontTracker-373"><span class="linenos">373</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span>
</span><span id="WaveFrontTracker-374"><a href="#WaveFrontTracker-374"><span class="linenos">374</span></a>                <span class="n">source_id</span><span class="p">,</span>
</span><span id="WaveFrontTracker-375"><a href="#WaveFrontTracker-375"><span class="linenos">375</span></a>                <span class="n">extract_raypaths</span><span class="p">,</span>
</span><span id="WaveFrontTracker-376"><a href="#WaveFrontTracker-376"><span class="linenos">376</span></a>                <span class="n">extract_wavefronts</span><span class="p">,</span>
</span><span id="WaveFrontTracker-377"><a href="#WaveFrontTracker-377"><span class="linenos">377</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_options_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-378"><a href="#WaveFrontTracker-378"><span class="linenos">378</span></a>                <span class="n">model_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-379"><a href="#WaveFrontTracker-379"><span class="linenos">379</span></a>                <span class="n">sources_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-380"><a href="#WaveFrontTracker-380"><span class="linenos">380</span></a>                <span class="n">receivers_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-381"><a href="#WaveFrontTracker-381"><span class="linenos">381</span></a>            <span class="p">)</span>
</span><span id="WaveFrontTracker-382"><a href="#WaveFrontTracker-382"><span class="linenos">382</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="WaveFrontTracker-383"><a href="#WaveFrontTracker-383"><span class="linenos">383</span></a>
</span><span id="WaveFrontTracker-384"><a href="#WaveFrontTracker-384"><span class="linenos">384</span></a>        <span class="c1"># Merge results using __add__</span>
</span><span id="WaveFrontTracker-385"><a href="#WaveFrontTracker-385"><span class="linenos">385</span></a>        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</span><span id="WaveFrontTracker-386"><a href="#WaveFrontTracker-386"><span class="linenos">386</span></a>
</span><span id="WaveFrontTracker-387"><a href="#WaveFrontTracker-387"><span class="linenos">387</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_forward_concurrent_futures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pool</span><span class="p">,</span> <span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">):</span>
</span><span id="WaveFrontTracker-388"><a href="#WaveFrontTracker-388"><span class="linenos">388</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parallel execution using concurrent.futures.ProcessPoolExecutor.</span>
</span><span id="WaveFrontTracker-389"><a href="#WaveFrontTracker-389"><span class="linenos">389</span></a>
</span><span id="WaveFrontTracker-390"><a href="#WaveFrontTracker-390"><span class="linenos">390</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTracker-391"><a href="#WaveFrontTracker-391"><span class="linenos">391</span></a><span class="sd">            pool: ProcessPoolExecutor instance</span>
</span><span id="WaveFrontTracker-392"><a href="#WaveFrontTracker-392"><span class="linenos">392</span></a><span class="sd">            extract_raypaths: Whether to extract raypath data</span>
</span><span id="WaveFrontTracker-393"><a href="#WaveFrontTracker-393"><span class="linenos">393</span></a><span class="sd">            extract_wavefronts: Whether to extract wavefront data</span>
</span><span id="WaveFrontTracker-394"><a href="#WaveFrontTracker-394"><span class="linenos">394</span></a>
</span><span id="WaveFrontTracker-395"><a href="#WaveFrontTracker-395"><span class="linenos">395</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTracker-396"><a href="#WaveFrontTracker-396"><span class="linenos">396</span></a><span class="sd">            WaveFrontTrackerResult</span>
</span><span id="WaveFrontTracker-397"><a href="#WaveFrontTracker-397"><span class="linenos">397</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker-398"><a href="#WaveFrontTracker-398"><span class="linenos">398</span></a>        <span class="c1"># Get serialized data for file-free mode</span>
</span><span id="WaveFrontTracker-399"><a href="#WaveFrontTracker-399"><span class="linenos">399</span></a>        <span class="n">model_dict</span><span class="p">,</span> <span class="n">sources_dict</span><span class="p">,</span> <span class="n">receivers_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serialize_data</span><span class="p">()</span>
</span><span id="WaveFrontTracker-400"><a href="#WaveFrontTracker-400"><span class="linenos">400</span></a>
</span><span id="WaveFrontTracker-401"><a href="#WaveFrontTracker-401"><span class="linenos">401</span></a>        <span class="c1"># Submit tasks for all sources</span>
</span><span id="WaveFrontTracker-402"><a href="#WaveFrontTracker-402"><span class="linenos">402</span></a>        <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WaveFrontTracker-403"><a href="#WaveFrontTracker-403"><span class="linenos">403</span></a>        <span class="k">for</span> <span class="n">source_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="WaveFrontTracker-404"><a href="#WaveFrontTracker-404"><span class="linenos">404</span></a>            <span class="n">future</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span>
</span><span id="WaveFrontTracker-405"><a href="#WaveFrontTracker-405"><span class="linenos">405</span></a>                <span class="n">_calc_single_source_worker</span><span class="p">,</span>
</span><span id="WaveFrontTracker-406"><a href="#WaveFrontTracker-406"><span class="linenos">406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span>
</span><span id="WaveFrontTracker-407"><a href="#WaveFrontTracker-407"><span class="linenos">407</span></a>                <span class="n">source_id</span><span class="p">,</span>
</span><span id="WaveFrontTracker-408"><a href="#WaveFrontTracker-408"><span class="linenos">408</span></a>                <span class="n">extract_raypaths</span><span class="p">,</span>
</span><span id="WaveFrontTracker-409"><a href="#WaveFrontTracker-409"><span class="linenos">409</span></a>                <span class="n">extract_wavefronts</span><span class="p">,</span>
</span><span id="WaveFrontTracker-410"><a href="#WaveFrontTracker-410"><span class="linenos">410</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_options_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-411"><a href="#WaveFrontTracker-411"><span class="linenos">411</span></a>                <span class="n">model_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-412"><a href="#WaveFrontTracker-412"><span class="linenos">412</span></a>                <span class="n">sources_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-413"><a href="#WaveFrontTracker-413"><span class="linenos">413</span></a>                <span class="n">receivers_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-414"><a href="#WaveFrontTracker-414"><span class="linenos">414</span></a>            <span class="p">)</span>
</span><span id="WaveFrontTracker-415"><a href="#WaveFrontTracker-415"><span class="linenos">415</span></a>            <span class="n">futures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
</span><span id="WaveFrontTracker-416"><a href="#WaveFrontTracker-416"><span class="linenos">416</span></a>
</span><span id="WaveFrontTracker-417"><a href="#WaveFrontTracker-417"><span class="linenos">417</span></a>        <span class="c1"># Collect results as they complete</span>
</span><span id="WaveFrontTracker-418"><a href="#WaveFrontTracker-418"><span class="linenos">418</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span> <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">futures</span><span class="p">]</span>
</span><span id="WaveFrontTracker-419"><a href="#WaveFrontTracker-419"><span class="linenos">419</span></a>
</span><span id="WaveFrontTracker-420"><a href="#WaveFrontTracker-420"><span class="linenos">420</span></a>        <span class="c1"># Merge using __add__</span>
</span><span id="WaveFrontTracker-421"><a href="#WaveFrontTracker-421"><span class="linenos">421</span></a>        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</span><span id="WaveFrontTracker-422"><a href="#WaveFrontTracker-422"><span class="linenos">422</span></a>
</span><span id="WaveFrontTracker-423"><a href="#WaveFrontTracker-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_forward_schwimmbad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pool</span><span class="p">,</span> <span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">):</span>
</span><span id="WaveFrontTracker-424"><a href="#WaveFrontTracker-424"><span class="linenos">424</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parallel execution using schwimmbad pools.</span>
</span><span id="WaveFrontTracker-425"><a href="#WaveFrontTracker-425"><span class="linenos">425</span></a>
</span><span id="WaveFrontTracker-426"><a href="#WaveFrontTracker-426"><span class="linenos">426</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTracker-427"><a href="#WaveFrontTracker-427"><span class="linenos">427</span></a><span class="sd">            pool: schwimmbad pool instance (MPIPool, MultiPool, SerialPool)</span>
</span><span id="WaveFrontTracker-428"><a href="#WaveFrontTracker-428"><span class="linenos">428</span></a><span class="sd">            extract_raypaths: Whether to extract raypath data</span>
</span><span id="WaveFrontTracker-429"><a href="#WaveFrontTracker-429"><span class="linenos">429</span></a><span class="sd">            extract_wavefronts: Whether to extract wavefront data</span>
</span><span id="WaveFrontTracker-430"><a href="#WaveFrontTracker-430"><span class="linenos">430</span></a>
</span><span id="WaveFrontTracker-431"><a href="#WaveFrontTracker-431"><span class="linenos">431</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTracker-432"><a href="#WaveFrontTracker-432"><span class="linenos">432</span></a><span class="sd">            WaveFrontTrackerResult</span>
</span><span id="WaveFrontTracker-433"><a href="#WaveFrontTracker-433"><span class="linenos">433</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker-434"><a href="#WaveFrontTracker-434"><span class="linenos">434</span></a>        <span class="c1"># Get serialized data for file-free mode</span>
</span><span id="WaveFrontTracker-435"><a href="#WaveFrontTracker-435"><span class="linenos">435</span></a>        <span class="n">model_dict</span><span class="p">,</span> <span class="n">sources_dict</span><span class="p">,</span> <span class="n">receivers_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serialize_data</span><span class="p">()</span>
</span><span id="WaveFrontTracker-436"><a href="#WaveFrontTracker-436"><span class="linenos">436</span></a>
</span><span id="WaveFrontTracker-437"><a href="#WaveFrontTracker-437"><span class="linenos">437</span></a>        <span class="c1"># Prepare arguments for all sources</span>
</span><span id="WaveFrontTracker-438"><a href="#WaveFrontTracker-438"><span class="linenos">438</span></a>        <span class="n">source_ids</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="WaveFrontTracker-439"><a href="#WaveFrontTracker-439"><span class="linenos">439</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="WaveFrontTracker-440"><a href="#WaveFrontTracker-440"><span class="linenos">440</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span> <span class="n">sid</span><span class="p">,</span> <span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">,</span>
</span><span id="WaveFrontTracker-441"><a href="#WaveFrontTracker-441"><span class="linenos">441</span></a>             <span class="bp">self</span><span class="o">.</span><span class="n">_options_dict</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">,</span> <span class="n">sources_dict</span><span class="p">,</span> <span class="n">receivers_dict</span><span class="p">)</span>
</span><span id="WaveFrontTracker-442"><a href="#WaveFrontTracker-442"><span class="linenos">442</span></a>            <span class="k">for</span> <span class="n">sid</span> <span class="ow">in</span> <span class="n">source_ids</span>
</span><span id="WaveFrontTracker-443"><a href="#WaveFrontTracker-443"><span class="linenos">443</span></a>        <span class="p">]</span>
</span><span id="WaveFrontTracker-444"><a href="#WaveFrontTracker-444"><span class="linenos">444</span></a>
</span><span id="WaveFrontTracker-445"><a href="#WaveFrontTracker-445"><span class="linenos">445</span></a>        <span class="c1"># Map worker function over sources</span>
</span><span id="WaveFrontTracker-446"><a href="#WaveFrontTracker-446"><span class="linenos">446</span></a>        <span class="c1"># schwimmbad pools use starmap-style interface</span>
</span><span id="WaveFrontTracker-447"><a href="#WaveFrontTracker-447"><span class="linenos">447</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">worker_wrapper</span><span class="p">(</span><span class="n">args_tuple</span><span class="p">):</span>
</span><span id="WaveFrontTracker-448"><a href="#WaveFrontTracker-448"><span class="linenos">448</span></a>            <span class="k">return</span> <span class="n">_calc_single_source_worker</span><span class="p">(</span><span class="o">*</span><span class="n">args_tuple</span><span class="p">)</span>
</span><span id="WaveFrontTracker-449"><a href="#WaveFrontTracker-449"><span class="linenos">449</span></a>
</span><span id="WaveFrontTracker-450"><a href="#WaveFrontTracker-450"><span class="linenos">450</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">worker_wrapper</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
</span><span id="WaveFrontTracker-451"><a href="#WaveFrontTracker-451"><span class="linenos">451</span></a>
</span><span id="WaveFrontTracker-452"><a href="#WaveFrontTracker-452"><span class="linenos">452</span></a>        <span class="c1"># Merge using __add__</span>
</span><span id="WaveFrontTracker-453"><a href="#WaveFrontTracker-453"><span class="linenos">453</span></a>        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</span><span id="WaveFrontTracker-454"><a href="#WaveFrontTracker-454"><span class="linenos">454</span></a>
</span><span id="WaveFrontTracker-455"><a href="#WaveFrontTracker-455"><span class="linenos">455</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward_single_source</span><span class="p">(</span>
</span><span id="WaveFrontTracker-456"><a href="#WaveFrontTracker-456"><span class="linenos">456</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="WaveFrontTracker-457"><a href="#WaveFrontTracker-457"><span class="linenos">457</span></a>        <span class="n">source_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="WaveFrontTracker-458"><a href="#WaveFrontTracker-458"><span class="linenos">458</span></a>        <span class="n">extract_raypaths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="WaveFrontTracker-459"><a href="#WaveFrontTracker-459"><span class="linenos">459</span></a>        <span class="n">extract_wavefronts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="WaveFrontTracker-460"><a href="#WaveFrontTracker-460"><span class="linenos">460</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WaveFrontTrackerResult</span><span class="p">:</span>
</span><span id="WaveFrontTracker-461"><a href="#WaveFrontTracker-461"><span class="linenos">461</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute wavefront tracking for a single source.</span>
</span><span id="WaveFrontTracker-462"><a href="#WaveFrontTracker-462"><span class="linenos">462</span></a>
</span><span id="WaveFrontTracker-463"><a href="#WaveFrontTracker-463"><span class="linenos">463</span></a><span class="sd">        This is useful for testing or when you need results for specific sources.</span>
</span><span id="WaveFrontTracker-464"><a href="#WaveFrontTracker-464"><span class="linenos">464</span></a>
</span><span id="WaveFrontTracker-465"><a href="#WaveFrontTracker-465"><span class="linenos">465</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTracker-466"><a href="#WaveFrontTracker-466"><span class="linenos">466</span></a><span class="sd">            source_id: Source ID to process (1-based indexing)</span>
</span><span id="WaveFrontTracker-467"><a href="#WaveFrontTracker-467"><span class="linenos">467</span></a><span class="sd">            extract_raypaths: Whether to extract raypath data</span>
</span><span id="WaveFrontTracker-468"><a href="#WaveFrontTracker-468"><span class="linenos">468</span></a><span class="sd">            extract_wavefronts: Whether to extract wavefront data</span>
</span><span id="WaveFrontTracker-469"><a href="#WaveFrontTracker-469"><span class="linenos">469</span></a>
</span><span id="WaveFrontTracker-470"><a href="#WaveFrontTracker-470"><span class="linenos">470</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTracker-471"><a href="#WaveFrontTracker-471"><span class="linenos">471</span></a><span class="sd">            WaveFrontTrackerResult for this source</span>
</span><span id="WaveFrontTracker-472"><a href="#WaveFrontTracker-472"><span class="linenos">472</span></a>
</span><span id="WaveFrontTracker-473"><a href="#WaveFrontTracker-473"><span class="linenos">473</span></a><span class="sd">        Example:</span>
</span><span id="WaveFrontTracker-474"><a href="#WaveFrontTracker-474"><span class="linenos">474</span></a><span class="sd">            &gt;&gt;&gt; tracker = WaveFrontTracker(&#39;config.in&#39;)</span>
</span><span id="WaveFrontTracker-475"><a href="#WaveFrontTracker-475"><span class="linenos">475</span></a><span class="sd">            &gt;&gt;&gt; result = tracker.forward_single_source(1, extract_raypaths=True)</span>
</span><span id="WaveFrontTracker-476"><a href="#WaveFrontTracker-476"><span class="linenos">476</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker-477"><a href="#WaveFrontTracker-477"><span class="linenos">477</span></a>        <span class="k">if</span> <span class="n">source_id</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">source_id</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span><span class="p">:</span>
</span><span id="WaveFrontTracker-478"><a href="#WaveFrontTracker-478"><span class="linenos">478</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WaveFrontTracker-479"><a href="#WaveFrontTracker-479"><span class="linenos">479</span></a>                <span class="sa">f</span><span class="s2">&quot;Source ID </span><span class="si">{</span><span class="n">source_id</span><span class="si">}</span><span class="s2"> out of range [1, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span><span class="si">}</span><span class="s2">]&quot;</span>
</span><span id="WaveFrontTracker-480"><a href="#WaveFrontTracker-480"><span class="linenos">480</span></a>            <span class="p">)</span>
</span><span id="WaveFrontTracker-481"><a href="#WaveFrontTracker-481"><span class="linenos">481</span></a>
</span><span id="WaveFrontTracker-482"><a href="#WaveFrontTracker-482"><span class="linenos">482</span></a>        <span class="c1"># Get serialized data for file-free mode</span>
</span><span id="WaveFrontTracker-483"><a href="#WaveFrontTracker-483"><span class="linenos">483</span></a>        <span class="n">model_dict</span><span class="p">,</span> <span class="n">sources_dict</span><span class="p">,</span> <span class="n">receivers_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serialize_data</span><span class="p">()</span>
</span><span id="WaveFrontTracker-484"><a href="#WaveFrontTracker-484"><span class="linenos">484</span></a>
</span><span id="WaveFrontTracker-485"><a href="#WaveFrontTracker-485"><span class="linenos">485</span></a>        <span class="k">return</span> <span class="n">_calc_single_source_worker</span><span class="p">(</span>
</span><span id="WaveFrontTracker-486"><a href="#WaveFrontTracker-486"><span class="linenos">486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span>
</span><span id="WaveFrontTracker-487"><a href="#WaveFrontTracker-487"><span class="linenos">487</span></a>            <span class="n">source_id</span><span class="p">,</span>
</span><span id="WaveFrontTracker-488"><a href="#WaveFrontTracker-488"><span class="linenos">488</span></a>            <span class="n">extract_raypaths</span><span class="p">,</span>
</span><span id="WaveFrontTracker-489"><a href="#WaveFrontTracker-489"><span class="linenos">489</span></a>            <span class="n">extract_wavefronts</span><span class="p">,</span>
</span><span id="WaveFrontTracker-490"><a href="#WaveFrontTracker-490"><span class="linenos">490</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_options_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-491"><a href="#WaveFrontTracker-491"><span class="linenos">491</span></a>            <span class="n">model_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-492"><a href="#WaveFrontTracker-492"><span class="linenos">492</span></a>            <span class="n">sources_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-493"><a href="#WaveFrontTracker-493"><span class="linenos">493</span></a>            <span class="n">receivers_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker-494"><a href="#WaveFrontTracker-494"><span class="linenos">494</span></a>        <span class="p">)</span>
</span><span id="WaveFrontTracker-495"><a href="#WaveFrontTracker-495"><span class="linenos">495</span></a>
</span><span id="WaveFrontTracker-496"><a href="#WaveFrontTracker-496"><span class="linenos">496</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="WaveFrontTracker-497"><a href="#WaveFrontTracker-497"><span class="linenos">497</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation.&quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker-498"><a href="#WaveFrontTracker-498"><span class="linenos">498</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;WaveFrontTracker(config=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="si">}</span><span class="s2">&#39;, n_sources=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span><span class="si">}</span><span class="s2">)&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Wavefront tracker for computing seismic ray paths and travel times.</p>

<p>This class provides a high-level interface to the SWMP Fortran library,
with support for parallel execution over sources using pool executors.</p>

<p>Example (sequential):</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>tracker = WaveFrontTracker('config.in')
      result = tracker.forward()
      df = result.to_dataframe()</p>
    </blockquote>
  </blockquote>
</blockquote>

<p>Example (parallel with ProcessPoolExecutor):</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>from concurrent.futures import ProcessPoolExecutor
      tracker = WaveFrontTracker('config.in')
      with ProcessPoolExecutor(max_workers=4) as pool:
          ...     result = tracker.forward(pool=pool)</p>
    </blockquote>
  </blockquote>
</blockquote>

<p>Example (parallel with schwimmbad):</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>from schwimmbad import MPIPool
      tracker = WaveFrontTracker('config.in')
      with MPIPool() as pool:
          ...     result = tracker.forward(pool=pool)</p>
    </blockquote>
  </blockquote>
</blockquote>

<p>Args:
    config_file: Path to RAT configuration file (specifies model, sources, receivers)
    options: Optional TrackerOptions to override config file settings</p>
</div>


                            <div id="WaveFrontTracker.__init__" class="classattr">
                                        <input id="WaveFrontTracker.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">WaveFrontTracker</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">config_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">model</span><span class="p">:</span> <span class="s1">&#39;VelocityModel2D&#39;</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sources</span><span class="p">:</span> <span class="s1">&#39;Sources&#39;</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">receivers</span><span class="p">:</span> <span class="s1">&#39;Receivers&#39;</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">options</span><span class="p">:</span> <span class="s1">&#39;TrackerOptions&#39;</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="WaveFrontTracker.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WaveFrontTracker.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WaveFrontTracker.__init__-157"><a href="#WaveFrontTracker.__init__-157"><span class="linenos">157</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="WaveFrontTracker.__init__-158"><a href="#WaveFrontTracker.__init__-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="WaveFrontTracker.__init__-159"><a href="#WaveFrontTracker.__init__-159"><span class="linenos">159</span></a>        <span class="n">config_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="WaveFrontTracker.__init__-160"><a href="#WaveFrontTracker.__init__-160"><span class="linenos">160</span></a>        <span class="n">model</span><span class="p">:</span> <span class="s1">&#39;VelocityModel2D&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="WaveFrontTracker.__init__-161"><a href="#WaveFrontTracker.__init__-161"><span class="linenos">161</span></a>        <span class="n">sources</span><span class="p">:</span> <span class="s1">&#39;Sources&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="WaveFrontTracker.__init__-162"><a href="#WaveFrontTracker.__init__-162"><span class="linenos">162</span></a>        <span class="n">receivers</span><span class="p">:</span> <span class="s1">&#39;Receivers&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="WaveFrontTracker.__init__-163"><a href="#WaveFrontTracker.__init__-163"><span class="linenos">163</span></a>        <span class="n">options</span><span class="p">:</span> <span class="s1">&#39;TrackerOptions&#39;</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="WaveFrontTracker.__init__-164"><a href="#WaveFrontTracker.__init__-164"><span class="linenos">164</span></a>    <span class="p">):</span>
</span><span id="WaveFrontTracker.__init__-165"><a href="#WaveFrontTracker.__init__-165"><span class="linenos">165</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize WaveFrontTracker.</span>
</span><span id="WaveFrontTracker.__init__-166"><a href="#WaveFrontTracker.__init__-166"><span class="linenos">166</span></a>
</span><span id="WaveFrontTracker.__init__-167"><a href="#WaveFrontTracker.__init__-167"><span class="linenos">167</span></a><span class="sd">        Two modes of initialization:</span>
</span><span id="WaveFrontTracker.__init__-168"><a href="#WaveFrontTracker.__init__-168"><span class="linenos">168</span></a>
</span><span id="WaveFrontTracker.__init__-169"><a href="#WaveFrontTracker.__init__-169"><span class="linenos">169</span></a><span class="sd">        1. File-based (traditional):</span>
</span><span id="WaveFrontTracker.__init__-170"><a href="#WaveFrontTracker.__init__-170"><span class="linenos">170</span></a><span class="sd">           - Provide config_file which specifies model, sources, receivers</span>
</span><span id="WaveFrontTracker.__init__-171"><a href="#WaveFrontTracker.__init__-171"><span class="linenos">171</span></a><span class="sd">           - Optionally override parameters with options</span>
</span><span id="WaveFrontTracker.__init__-172"><a href="#WaveFrontTracker.__init__-172"><span class="linenos">172</span></a>
</span><span id="WaveFrontTracker.__init__-173"><a href="#WaveFrontTracker.__init__-173"><span class="linenos">173</span></a><span class="sd">        2. File-free (new):</span>
</span><span id="WaveFrontTracker.__init__-174"><a href="#WaveFrontTracker.__init__-174"><span class="linenos">174</span></a><span class="sd">           - Provide model, sources, receivers as Python objects</span>
</span><span id="WaveFrontTracker.__init__-175"><a href="#WaveFrontTracker.__init__-175"><span class="linenos">175</span></a><span class="sd">           - Optionally provide options for configuration</span>
</span><span id="WaveFrontTracker.__init__-176"><a href="#WaveFrontTracker.__init__-176"><span class="linenos">176</span></a>
</span><span id="WaveFrontTracker.__init__-177"><a href="#WaveFrontTracker.__init__-177"><span class="linenos">177</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTracker.__init__-178"><a href="#WaveFrontTracker.__init__-178"><span class="linenos">178</span></a><span class="sd">            config_file: Path to RAT configuration file (traditional mode)</span>
</span><span id="WaveFrontTracker.__init__-179"><a href="#WaveFrontTracker.__init__-179"><span class="linenos">179</span></a><span class="sd">            model: VelocityModel2D instance (file-free mode)</span>
</span><span id="WaveFrontTracker.__init__-180"><a href="#WaveFrontTracker.__init__-180"><span class="linenos">180</span></a><span class="sd">            sources: Sources instance (file-free mode)</span>
</span><span id="WaveFrontTracker.__init__-181"><a href="#WaveFrontTracker.__init__-181"><span class="linenos">181</span></a><span class="sd">            receivers: Receivers instance (file-free mode)</span>
</span><span id="WaveFrontTracker.__init__-182"><a href="#WaveFrontTracker.__init__-182"><span class="linenos">182</span></a><span class="sd">            options: Optional TrackerOptions to set/override parameters</span>
</span><span id="WaveFrontTracker.__init__-183"><a href="#WaveFrontTracker.__init__-183"><span class="linenos">183</span></a>
</span><span id="WaveFrontTracker.__init__-184"><a href="#WaveFrontTracker.__init__-184"><span class="linenos">184</span></a><span class="sd">        Raises:</span>
</span><span id="WaveFrontTracker.__init__-185"><a href="#WaveFrontTracker.__init__-185"><span class="linenos">185</span></a><span class="sd">            ValueError: If neither mode has sufficient parameters</span>
</span><span id="WaveFrontTracker.__init__-186"><a href="#WaveFrontTracker.__init__-186"><span class="linenos">186</span></a>
</span><span id="WaveFrontTracker.__init__-187"><a href="#WaveFrontTracker.__init__-187"><span class="linenos">187</span></a><span class="sd">        Example (file-free):</span>
</span><span id="WaveFrontTracker.__init__-188"><a href="#WaveFrontTracker.__init__-188"><span class="linenos">188</span></a><span class="sd">            &gt;&gt;&gt; import pyswmp</span>
</span><span id="WaveFrontTracker.__init__-189"><a href="#WaveFrontTracker.__init__-189"><span class="linenos">189</span></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
</span><span id="WaveFrontTracker.__init__-190"><a href="#WaveFrontTracker.__init__-190"><span class="linenos">190</span></a><span class="sd">            &gt;&gt;&gt; model = pyswmp.create_constant_velocity_model(100, 80, 110, -45, 0.5, 0.5, 3.5)</span>
</span><span id="WaveFrontTracker.__init__-191"><a href="#WaveFrontTracker.__init__-191"><span class="linenos">191</span></a><span class="sd">            &gt;&gt;&gt; sources = pyswmp.Sources(np.array([[135.0, -25.0]]))</span>
</span><span id="WaveFrontTracker.__init__-192"><a href="#WaveFrontTracker.__init__-192"><span class="linenos">192</span></a><span class="sd">            &gt;&gt;&gt; receivers = pyswmp.Receivers(np.array([[120.0, -30.0]]))</span>
</span><span id="WaveFrontTracker.__init__-193"><a href="#WaveFrontTracker.__init__-193"><span class="linenos">193</span></a><span class="sd">            &gt;&gt;&gt; opts = pyswmp.TrackerOptions(coordinate_system=2)</span>
</span><span id="WaveFrontTracker.__init__-194"><a href="#WaveFrontTracker.__init__-194"><span class="linenos">194</span></a><span class="sd">            &gt;&gt;&gt; tracker = pyswmp.WaveFrontTracker(model=model, sources=sources, receivers=receivers, options=opts)</span>
</span><span id="WaveFrontTracker.__init__-195"><a href="#WaveFrontTracker.__init__-195"><span class="linenos">195</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker.__init__-196"><a href="#WaveFrontTracker.__init__-196"><span class="linenos">196</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrackerOptions</span>
</span><span id="WaveFrontTracker.__init__-197"><a href="#WaveFrontTracker.__init__-197"><span class="linenos">197</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">VelocityModel2D</span><span class="p">,</span> <span class="n">Sources</span><span class="p">,</span> <span class="n">Receivers</span>
</span><span id="WaveFrontTracker.__init__-198"><a href="#WaveFrontTracker.__init__-198"><span class="linenos">198</span></a>
</span><span id="WaveFrontTracker.__init__-199"><a href="#WaveFrontTracker.__init__-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span> <span class="k">if</span> <span class="n">config_file</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="WaveFrontTracker.__init__-200"><a href="#WaveFrontTracker.__init__-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>
</span><span id="WaveFrontTracker.__init__-201"><a href="#WaveFrontTracker.__init__-201"><span class="linenos">201</span></a>
</span><span id="WaveFrontTracker.__init__-202"><a href="#WaveFrontTracker.__init__-202"><span class="linenos">202</span></a>        <span class="c1"># Store options as dict for serialization to workers</span>
</span><span id="WaveFrontTracker.__init__-203"><a href="#WaveFrontTracker.__init__-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_options_dict</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">if</span> <span class="n">options</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="WaveFrontTracker.__init__-204"><a href="#WaveFrontTracker.__init__-204"><span class="linenos">204</span></a>
</span><span id="WaveFrontTracker.__init__-205"><a href="#WaveFrontTracker.__init__-205"><span class="linenos">205</span></a>        <span class="c1"># Create library instance for metadata queries</span>
</span><span id="WaveFrontTracker.__init__-206"><a href="#WaveFrontTracker.__init__-206"><span class="linenos">206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span> <span class="o">=</span> <span class="n">LibSWMP</span><span class="p">()</span>
</span><span id="WaveFrontTracker.__init__-207"><a href="#WaveFrontTracker.__init__-207"><span class="linenos">207</span></a>
</span><span id="WaveFrontTracker.__init__-208"><a href="#WaveFrontTracker.__init__-208"><span class="linenos">208</span></a>        <span class="c1"># Determine initialization mode</span>
</span><span id="WaveFrontTracker.__init__-209"><a href="#WaveFrontTracker.__init__-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="n">config_file</span><span class="p">:</span>
</span><span id="WaveFrontTracker.__init__-210"><a href="#WaveFrontTracker.__init__-210"><span class="linenos">210</span></a>            <span class="c1"># Traditional file-based initialization</span>
</span><span id="WaveFrontTracker.__init__-211"><a href="#WaveFrontTracker.__init__-211"><span class="linenos">211</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">read_configuration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">)</span>
</span><span id="WaveFrontTracker.__init__-212"><a href="#WaveFrontTracker.__init__-212"><span class="linenos">212</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_file_free</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="WaveFrontTracker.__init__-213"><a href="#WaveFrontTracker.__init__-213"><span class="linenos">213</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sources</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">receivers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WaveFrontTracker.__init__-214"><a href="#WaveFrontTracker.__init__-214"><span class="linenos">214</span></a>            <span class="c1"># File-free initialization</span>
</span><span id="WaveFrontTracker.__init__-215"><a href="#WaveFrontTracker.__init__-215"><span class="linenos">215</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_velocity_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="WaveFrontTracker.__init__-216"><a href="#WaveFrontTracker.__init__-216"><span class="linenos">216</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_sources</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
</span><span id="WaveFrontTracker.__init__-217"><a href="#WaveFrontTracker.__init__-217"><span class="linenos">217</span></a>
</span><span id="WaveFrontTracker.__init__-218"><a href="#WaveFrontTracker.__init__-218"><span class="linenos">218</span></a>            <span class="c1"># Determine max_arrivals from options or use default</span>
</span><span id="WaveFrontTracker.__init__-219"><a href="#WaveFrontTracker.__init__-219"><span class="linenos">219</span></a>            <span class="n">max_arrivals</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">max_arrivals</span> <span class="k">if</span> <span class="n">options</span> <span class="k">else</span> <span class="mi">10</span>
</span><span id="WaveFrontTracker.__init__-220"><a href="#WaveFrontTracker.__init__-220"><span class="linenos">220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_receivers</span><span class="p">(</span><span class="n">receivers</span><span class="p">,</span> <span class="n">max_arrivals</span><span class="o">=</span><span class="n">max_arrivals</span><span class="p">)</span>
</span><span id="WaveFrontTracker.__init__-221"><a href="#WaveFrontTracker.__init__-221"><span class="linenos">221</span></a>
</span><span id="WaveFrontTracker.__init__-222"><a href="#WaveFrontTracker.__init__-222"><span class="linenos">222</span></a>            <span class="c1"># Store objects for worker serialization</span>
</span><span id="WaveFrontTracker.__init__-223"><a href="#WaveFrontTracker.__init__-223"><span class="linenos">223</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">model</span>
</span><span id="WaveFrontTracker.__init__-224"><a href="#WaveFrontTracker.__init__-224"><span class="linenos">224</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="n">sources</span>
</span><span id="WaveFrontTracker.__init__-225"><a href="#WaveFrontTracker.__init__-225"><span class="linenos">225</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="n">receivers</span>
</span><span id="WaveFrontTracker.__init__-226"><a href="#WaveFrontTracker.__init__-226"><span class="linenos">226</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_file_free</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="WaveFrontTracker.__init__-227"><a href="#WaveFrontTracker.__init__-227"><span class="linenos">227</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="WaveFrontTracker.__init__-228"><a href="#WaveFrontTracker.__init__-228"><span class="linenos">228</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WaveFrontTracker.__init__-229"><a href="#WaveFrontTracker.__init__-229"><span class="linenos">229</span></a>                <span class="s2">&quot;Must provide either:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="WaveFrontTracker.__init__-230"><a href="#WaveFrontTracker.__init__-230"><span class="linenos">230</span></a>                <span class="s2">&quot;  1. config_file (traditional mode), or</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="WaveFrontTracker.__init__-231"><a href="#WaveFrontTracker.__init__-231"><span class="linenos">231</span></a>                <span class="s2">&quot;  2. model, sources, and receivers (file-free mode)&quot;</span>
</span><span id="WaveFrontTracker.__init__-232"><a href="#WaveFrontTracker.__init__-232"><span class="linenos">232</span></a>            <span class="p">)</span>
</span><span id="WaveFrontTracker.__init__-233"><a href="#WaveFrontTracker.__init__-233"><span class="linenos">233</span></a>
</span><span id="WaveFrontTracker.__init__-234"><a href="#WaveFrontTracker.__init__-234"><span class="linenos">234</span></a>        <span class="c1"># Apply options if provided</span>
</span><span id="WaveFrontTracker.__init__-235"><a href="#WaveFrontTracker.__init__-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
</span><span id="WaveFrontTracker.__init__-236"><a href="#WaveFrontTracker.__init__-236"><span class="linenos">236</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">apply_options</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
</span><span id="WaveFrontTracker.__init__-237"><a href="#WaveFrontTracker.__init__-237"><span class="linenos">237</span></a>
</span><span id="WaveFrontTracker.__init__-238"><a href="#WaveFrontTracker.__init__-238"><span class="linenos">238</span></a>        <span class="c1"># Cache number of sources</span>
</span><span id="WaveFrontTracker.__init__-239"><a href="#WaveFrontTracker.__init__-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_n_sources</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize WaveFrontTracker.</p>

<p>Two modes of initialization:</p>

<ol>
<li><p>File-based (traditional):</p>

<ul>
<li>Provide config_file which specifies model, sources, receivers</li>
<li>Optionally override parameters with options</li>
</ul></li>
<li><p>File-free (new):</p>

<ul>
<li>Provide model, sources, receivers as Python objects</li>
<li>Optionally provide options for configuration</li>
</ul></li>
</ol>

<p>Args:
    config_file: Path to RAT configuration file (traditional mode)
    model: VelocityModel2D instance (file-free mode)
    sources: Sources instance (file-free mode)
    receivers: Receivers instance (file-free mode)
    options: Optional TrackerOptions to set/override parameters</p>

<p>Raises:
    ValueError: If neither mode has sufficient parameters</p>

<p>Example (file-free):</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>import pyswmp
      import numpy as np
      model = <a href="#create_constant_velocity_model">pyswmp.create_constant_velocity_model</a>(100, 80, 110, -45, 0.5, 0.5, 3.5)
      sources = <a href="#Sources">pyswmp.Sources</a>(np.array([[135.0, -25.0]]))
      receivers = <a href="#Receivers">pyswmp.Receivers</a>(np.array([[120.0, -30.0]]))
      opts = <a href="#TrackerOptions">pyswmp.TrackerOptions</a>(coordinate_system=2)
      tracker = <a href="#WaveFrontTracker">pyswmp.WaveFrontTracker</a>(model=model, sources=sources, receivers=receivers, options=opts)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="WaveFrontTracker.config_file" class="classattr">
                                <div class="attr variable">
            <span class="name">config_file</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTracker.config_file"></a>
    
    

                            </div>
                            <div id="WaveFrontTracker.options" class="classattr">
                                <div class="attr variable">
            <span class="name">options</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTracker.options"></a>
    
    

                            </div>
                            <div id="WaveFrontTracker.n_sources" class="classattr">
                                <div class="attr variable">
            <span class="name">n_sources</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTracker.n_sources"></a>
    
    

                            </div>
                            <div id="WaveFrontTracker.forward" class="classattr">
                                        <input id="WaveFrontTracker.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">pool</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">extract_raypaths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">extract_wavefronts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#WaveFrontTrackerResult">WaveFrontTrackerResult</a></span>:</span></span>

                <label class="view-source-button" for="WaveFrontTracker.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WaveFrontTracker.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WaveFrontTracker.forward-315"><a href="#WaveFrontTracker.forward-315"><span class="linenos">315</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span>
</span><span id="WaveFrontTracker.forward-316"><a href="#WaveFrontTracker.forward-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward-317"><a href="#WaveFrontTracker.forward-317"><span class="linenos">317</span></a>        <span class="n">pool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward-318"><a href="#WaveFrontTracker.forward-318"><span class="linenos">318</span></a>        <span class="n">extract_raypaths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward-319"><a href="#WaveFrontTracker.forward-319"><span class="linenos">319</span></a>        <span class="n">extract_wavefronts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward-320"><a href="#WaveFrontTracker.forward-320"><span class="linenos">320</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WaveFrontTrackerResult</span><span class="p">:</span>
</span><span id="WaveFrontTracker.forward-321"><a href="#WaveFrontTracker.forward-321"><span class="linenos">321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute wavefront tracking for all sources.</span>
</span><span id="WaveFrontTracker.forward-322"><a href="#WaveFrontTracker.forward-322"><span class="linenos">322</span></a>
</span><span id="WaveFrontTracker.forward-323"><a href="#WaveFrontTracker.forward-323"><span class="linenos">323</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTracker.forward-324"><a href="#WaveFrontTracker.forward-324"><span class="linenos">324</span></a><span class="sd">            pool: Optional pool executor for parallel execution.</span>
</span><span id="WaveFrontTracker.forward-325"><a href="#WaveFrontTracker.forward-325"><span class="linenos">325</span></a><span class="sd">                  Supports concurrent.futures.ProcessPoolExecutor</span>
</span><span id="WaveFrontTracker.forward-326"><a href="#WaveFrontTracker.forward-326"><span class="linenos">326</span></a><span class="sd">                  and schwimmbad pools (MPIPool, MultiPool, SerialPool).</span>
</span><span id="WaveFrontTracker.forward-327"><a href="#WaveFrontTracker.forward-327"><span class="linenos">327</span></a><span class="sd">            extract_raypaths: Whether to extract raypath data (default: False)</span>
</span><span id="WaveFrontTracker.forward-328"><a href="#WaveFrontTracker.forward-328"><span class="linenos">328</span></a><span class="sd">            extract_wavefronts: Whether to extract wavefront data (default: False)</span>
</span><span id="WaveFrontTracker.forward-329"><a href="#WaveFrontTracker.forward-329"><span class="linenos">329</span></a>
</span><span id="WaveFrontTracker.forward-330"><a href="#WaveFrontTracker.forward-330"><span class="linenos">330</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTracker.forward-331"><a href="#WaveFrontTracker.forward-331"><span class="linenos">331</span></a><span class="sd">            WaveFrontTrackerResult with arrivals, raypaths, and wavefronts</span>
</span><span id="WaveFrontTracker.forward-332"><a href="#WaveFrontTracker.forward-332"><span class="linenos">332</span></a>
</span><span id="WaveFrontTracker.forward-333"><a href="#WaveFrontTracker.forward-333"><span class="linenos">333</span></a><span class="sd">        Raises:</span>
</span><span id="WaveFrontTracker.forward-334"><a href="#WaveFrontTracker.forward-334"><span class="linenos">334</span></a><span class="sd">            ValueError: If pool type is incompatible</span>
</span><span id="WaveFrontTracker.forward-335"><a href="#WaveFrontTracker.forward-335"><span class="linenos">335</span></a><span class="sd">            SWMPError: If Fortran library encounters an error</span>
</span><span id="WaveFrontTracker.forward-336"><a href="#WaveFrontTracker.forward-336"><span class="linenos">336</span></a>
</span><span id="WaveFrontTracker.forward-337"><a href="#WaveFrontTracker.forward-337"><span class="linenos">337</span></a><span class="sd">        Example:</span>
</span><span id="WaveFrontTracker.forward-338"><a href="#WaveFrontTracker.forward-338"><span class="linenos">338</span></a><span class="sd">            &gt;&gt;&gt; tracker = WaveFrontTracker(&#39;config.in&#39;)</span>
</span><span id="WaveFrontTracker.forward-339"><a href="#WaveFrontTracker.forward-339"><span class="linenos">339</span></a><span class="sd">            &gt;&gt;&gt; result = tracker.forward(extract_raypaths=True)</span>
</span><span id="WaveFrontTracker.forward-340"><a href="#WaveFrontTracker.forward-340"><span class="linenos">340</span></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Computed {len(result.travel_times)} arrivals&quot;)</span>
</span><span id="WaveFrontTracker.forward-341"><a href="#WaveFrontTracker.forward-341"><span class="linenos">341</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker.forward-342"><a href="#WaveFrontTracker.forward-342"><span class="linenos">342</span></a>        <span class="k">if</span> <span class="n">pool</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WaveFrontTracker.forward-343"><a href="#WaveFrontTracker.forward-343"><span class="linenos">343</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_sequential</span><span class="p">(</span><span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">)</span>
</span><span id="WaveFrontTracker.forward-344"><a href="#WaveFrontTracker.forward-344"><span class="linenos">344</span></a>
</span><span id="WaveFrontTracker.forward-345"><a href="#WaveFrontTracker.forward-345"><span class="linenos">345</span></a>        <span class="n">pool_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detect_pool_type</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span>
</span><span id="WaveFrontTracker.forward-346"><a href="#WaveFrontTracker.forward-346"><span class="linenos">346</span></a>
</span><span id="WaveFrontTracker.forward-347"><a href="#WaveFrontTracker.forward-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="n">pool_type</span> <span class="o">==</span> <span class="s1">&#39;process&#39;</span><span class="p">:</span>
</span><span id="WaveFrontTracker.forward-348"><a href="#WaveFrontTracker.forward-348"><span class="linenos">348</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_concurrent_futures</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">)</span>
</span><span id="WaveFrontTracker.forward-349"><a href="#WaveFrontTracker.forward-349"><span class="linenos">349</span></a>        <span class="k">elif</span> <span class="n">pool_type</span> <span class="o">==</span> <span class="s1">&#39;schwimmbad&#39;</span><span class="p">:</span>
</span><span id="WaveFrontTracker.forward-350"><a href="#WaveFrontTracker.forward-350"><span class="linenos">350</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_schwimmbad</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">)</span>
</span><span id="WaveFrontTracker.forward-351"><a href="#WaveFrontTracker.forward-351"><span class="linenos">351</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="WaveFrontTracker.forward-352"><a href="#WaveFrontTracker.forward-352"><span class="linenos">352</span></a>            <span class="c1"># Fallback to sequential</span>
</span><span id="WaveFrontTracker.forward-353"><a href="#WaveFrontTracker.forward-353"><span class="linenos">353</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Could not detect pool type, falling back to sequential execution&quot;</span><span class="p">)</span>
</span><span id="WaveFrontTracker.forward-354"><a href="#WaveFrontTracker.forward-354"><span class="linenos">354</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_sequential</span><span class="p">(</span><span class="n">extract_raypaths</span><span class="p">,</span> <span class="n">extract_wavefronts</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute wavefront tracking for all sources.</p>

<p>Args:
    pool: Optional pool executor for parallel execution.
          Supports concurrent.futures.ProcessPoolExecutor
          and schwimmbad pools (MPIPool, MultiPool, SerialPool).
    extract_raypaths: Whether to extract raypath data (default: False)
    extract_wavefronts: Whether to extract wavefront data (default: False)</p>

<p>Returns:
    WaveFrontTrackerResult with arrivals, raypaths, and wavefronts</p>

<p>Raises:
    ValueError: If pool type is incompatible
    SWMPError: If Fortran library encounters an error</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>tracker = WaveFrontTracker('config.in')
      result = tracker.forward(extract_raypaths=True)
      print(f"Computed {len(result.travel_times)} arrivals")</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="WaveFrontTracker.forward_single_source" class="classattr">
                                        <input id="WaveFrontTracker.forward_single_source-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward_single_source</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">source_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">extract_raypaths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">extract_wavefronts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#WaveFrontTrackerResult">WaveFrontTrackerResult</a></span>:</span></span>

                <label class="view-source-button" for="WaveFrontTracker.forward_single_source-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WaveFrontTracker.forward_single_source"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WaveFrontTracker.forward_single_source-455"><a href="#WaveFrontTracker.forward_single_source-455"><span class="linenos">455</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward_single_source</span><span class="p">(</span>
</span><span id="WaveFrontTracker.forward_single_source-456"><a href="#WaveFrontTracker.forward_single_source-456"><span class="linenos">456</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-457"><a href="#WaveFrontTracker.forward_single_source-457"><span class="linenos">457</span></a>        <span class="n">source_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-458"><a href="#WaveFrontTracker.forward_single_source-458"><span class="linenos">458</span></a>        <span class="n">extract_raypaths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-459"><a href="#WaveFrontTracker.forward_single_source-459"><span class="linenos">459</span></a>        <span class="n">extract_wavefronts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-460"><a href="#WaveFrontTracker.forward_single_source-460"><span class="linenos">460</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WaveFrontTrackerResult</span><span class="p">:</span>
</span><span id="WaveFrontTracker.forward_single_source-461"><a href="#WaveFrontTracker.forward_single_source-461"><span class="linenos">461</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute wavefront tracking for a single source.</span>
</span><span id="WaveFrontTracker.forward_single_source-462"><a href="#WaveFrontTracker.forward_single_source-462"><span class="linenos">462</span></a>
</span><span id="WaveFrontTracker.forward_single_source-463"><a href="#WaveFrontTracker.forward_single_source-463"><span class="linenos">463</span></a><span class="sd">        This is useful for testing or when you need results for specific sources.</span>
</span><span id="WaveFrontTracker.forward_single_source-464"><a href="#WaveFrontTracker.forward_single_source-464"><span class="linenos">464</span></a>
</span><span id="WaveFrontTracker.forward_single_source-465"><a href="#WaveFrontTracker.forward_single_source-465"><span class="linenos">465</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTracker.forward_single_source-466"><a href="#WaveFrontTracker.forward_single_source-466"><span class="linenos">466</span></a><span class="sd">            source_id: Source ID to process (1-based indexing)</span>
</span><span id="WaveFrontTracker.forward_single_source-467"><a href="#WaveFrontTracker.forward_single_source-467"><span class="linenos">467</span></a><span class="sd">            extract_raypaths: Whether to extract raypath data</span>
</span><span id="WaveFrontTracker.forward_single_source-468"><a href="#WaveFrontTracker.forward_single_source-468"><span class="linenos">468</span></a><span class="sd">            extract_wavefronts: Whether to extract wavefront data</span>
</span><span id="WaveFrontTracker.forward_single_source-469"><a href="#WaveFrontTracker.forward_single_source-469"><span class="linenos">469</span></a>
</span><span id="WaveFrontTracker.forward_single_source-470"><a href="#WaveFrontTracker.forward_single_source-470"><span class="linenos">470</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTracker.forward_single_source-471"><a href="#WaveFrontTracker.forward_single_source-471"><span class="linenos">471</span></a><span class="sd">            WaveFrontTrackerResult for this source</span>
</span><span id="WaveFrontTracker.forward_single_source-472"><a href="#WaveFrontTracker.forward_single_source-472"><span class="linenos">472</span></a>
</span><span id="WaveFrontTracker.forward_single_source-473"><a href="#WaveFrontTracker.forward_single_source-473"><span class="linenos">473</span></a><span class="sd">        Example:</span>
</span><span id="WaveFrontTracker.forward_single_source-474"><a href="#WaveFrontTracker.forward_single_source-474"><span class="linenos">474</span></a><span class="sd">            &gt;&gt;&gt; tracker = WaveFrontTracker(&#39;config.in&#39;)</span>
</span><span id="WaveFrontTracker.forward_single_source-475"><a href="#WaveFrontTracker.forward_single_source-475"><span class="linenos">475</span></a><span class="sd">            &gt;&gt;&gt; result = tracker.forward_single_source(1, extract_raypaths=True)</span>
</span><span id="WaveFrontTracker.forward_single_source-476"><a href="#WaveFrontTracker.forward_single_source-476"><span class="linenos">476</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTracker.forward_single_source-477"><a href="#WaveFrontTracker.forward_single_source-477"><span class="linenos">477</span></a>        <span class="k">if</span> <span class="n">source_id</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">source_id</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span><span class="p">:</span>
</span><span id="WaveFrontTracker.forward_single_source-478"><a href="#WaveFrontTracker.forward_single_source-478"><span class="linenos">478</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WaveFrontTracker.forward_single_source-479"><a href="#WaveFrontTracker.forward_single_source-479"><span class="linenos">479</span></a>                <span class="sa">f</span><span class="s2">&quot;Source ID </span><span class="si">{</span><span class="n">source_id</span><span class="si">}</span><span class="s2"> out of range [1, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span><span class="si">}</span><span class="s2">]&quot;</span>
</span><span id="WaveFrontTracker.forward_single_source-480"><a href="#WaveFrontTracker.forward_single_source-480"><span class="linenos">480</span></a>            <span class="p">)</span>
</span><span id="WaveFrontTracker.forward_single_source-481"><a href="#WaveFrontTracker.forward_single_source-481"><span class="linenos">481</span></a>
</span><span id="WaveFrontTracker.forward_single_source-482"><a href="#WaveFrontTracker.forward_single_source-482"><span class="linenos">482</span></a>        <span class="c1"># Get serialized data for file-free mode</span>
</span><span id="WaveFrontTracker.forward_single_source-483"><a href="#WaveFrontTracker.forward_single_source-483"><span class="linenos">483</span></a>        <span class="n">model_dict</span><span class="p">,</span> <span class="n">sources_dict</span><span class="p">,</span> <span class="n">receivers_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serialize_data</span><span class="p">()</span>
</span><span id="WaveFrontTracker.forward_single_source-484"><a href="#WaveFrontTracker.forward_single_source-484"><span class="linenos">484</span></a>
</span><span id="WaveFrontTracker.forward_single_source-485"><a href="#WaveFrontTracker.forward_single_source-485"><span class="linenos">485</span></a>        <span class="k">return</span> <span class="n">_calc_single_source_worker</span><span class="p">(</span>
</span><span id="WaveFrontTracker.forward_single_source-486"><a href="#WaveFrontTracker.forward_single_source-486"><span class="linenos">486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-487"><a href="#WaveFrontTracker.forward_single_source-487"><span class="linenos">487</span></a>            <span class="n">source_id</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-488"><a href="#WaveFrontTracker.forward_single_source-488"><span class="linenos">488</span></a>            <span class="n">extract_raypaths</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-489"><a href="#WaveFrontTracker.forward_single_source-489"><span class="linenos">489</span></a>            <span class="n">extract_wavefronts</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-490"><a href="#WaveFrontTracker.forward_single_source-490"><span class="linenos">490</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_options_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-491"><a href="#WaveFrontTracker.forward_single_source-491"><span class="linenos">491</span></a>            <span class="n">model_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-492"><a href="#WaveFrontTracker.forward_single_source-492"><span class="linenos">492</span></a>            <span class="n">sources_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-493"><a href="#WaveFrontTracker.forward_single_source-493"><span class="linenos">493</span></a>            <span class="n">receivers_dict</span><span class="p">,</span>
</span><span id="WaveFrontTracker.forward_single_source-494"><a href="#WaveFrontTracker.forward_single_source-494"><span class="linenos">494</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute wavefront tracking for a single source.</p>

<p>This is useful for testing or when you need results for specific sources.</p>

<p>Args:
    source_id: Source ID to process (1-based indexing)
    extract_raypaths: Whether to extract raypath data
    extract_wavefronts: Whether to extract wavefront data</p>

<p>Returns:
    WaveFrontTrackerResult for this source</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>tracker = WaveFrontTracker('config.in')
      result = tracker.forward_single_source(1, extract_raypaths=True)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                </section>
                <section id="WaveFrontTrackerResult">
                            <input id="WaveFrontTrackerResult-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">WaveFrontTrackerResult</span>:

                <label class="view-source-button" for="WaveFrontTrackerResult-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WaveFrontTrackerResult-14"><a href="#WaveFrontTrackerResult-14"><span class="linenos"> 14</span></a><span class="nd">@dataclass</span>
</span><span id="WaveFrontTrackerResult-15"><a href="#WaveFrontTrackerResult-15"><span class="linenos"> 15</span></a><span class="k">class</span><span class="w"> </span><span class="nc">WaveFrontTrackerResult</span><span class="p">:</span>
</span><span id="WaveFrontTrackerResult-16"><a href="#WaveFrontTrackerResult-16"><span class="linenos"> 16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Results from wavefront tracking (single or multiple sources).</span>
</span><span id="WaveFrontTrackerResult-17"><a href="#WaveFrontTrackerResult-17"><span class="linenos"> 17</span></a>
</span><span id="WaveFrontTrackerResult-18"><a href="#WaveFrontTrackerResult-18"><span class="linenos"> 18</span></a><span class="sd">    This class stores arrival times, raypaths, and wavefronts from</span>
</span><span id="WaveFrontTrackerResult-19"><a href="#WaveFrontTrackerResult-19"><span class="linenos"> 19</span></a><span class="sd">    wavefront tracking computations. Data is stored in flattened arrays</span>
</span><span id="WaveFrontTrackerResult-20"><a href="#WaveFrontTrackerResult-20"><span class="linenos"> 20</span></a><span class="sd">    to naturally handle variable arrival counts per receiver.</span>
</span><span id="WaveFrontTrackerResult-21"><a href="#WaveFrontTrackerResult-21"><span class="linenos"> 21</span></a>
</span><span id="WaveFrontTrackerResult-22"><a href="#WaveFrontTrackerResult-22"><span class="linenos"> 22</span></a><span class="sd">    Attributes:</span>
</span><span id="WaveFrontTrackerResult-23"><a href="#WaveFrontTrackerResult-23"><span class="linenos"> 23</span></a><span class="sd">        source_ids: Source IDs for each arrival (1-based)</span>
</span><span id="WaveFrontTrackerResult-24"><a href="#WaveFrontTrackerResult-24"><span class="linenos"> 24</span></a><span class="sd">        receiver_ids: Receiver IDs for each arrival (1-based)</span>
</span><span id="WaveFrontTrackerResult-25"><a href="#WaveFrontTrackerResult-25"><span class="linenos"> 25</span></a><span class="sd">        arrival_numbers: Arrival numbers (1=first, 2=second, etc.)</span>
</span><span id="WaveFrontTrackerResult-26"><a href="#WaveFrontTrackerResult-26"><span class="linenos"> 26</span></a><span class="sd">        travel_times: Arrival times</span>
</span><span id="WaveFrontTrackerResult-27"><a href="#WaveFrontTrackerResult-27"><span class="linenos"> 27</span></a><span class="sd">        azimuths: Azimuths at receivers</span>
</span><span id="WaveFrontTrackerResult-28"><a href="#WaveFrontTrackerResult-28"><span class="linenos"> 28</span></a><span class="sd">        spreading_factors: Spreading factors (if mode=2)</span>
</span><span id="WaveFrontTrackerResult-29"><a href="#WaveFrontTrackerResult-29"><span class="linenos"> 29</span></a><span class="sd">        raypaths: List of raypath dicts with keys: source, receiver, arrival, path</span>
</span><span id="WaveFrontTrackerResult-30"><a href="#WaveFrontTrackerResult-30"><span class="linenos"> 30</span></a><span class="sd">        wavefronts: Dict mapping source_id to list of wavefront arrays</span>
</span><span id="WaveFrontTrackerResult-31"><a href="#WaveFrontTrackerResult-31"><span class="linenos"> 31</span></a>
</span><span id="WaveFrontTrackerResult-32"><a href="#WaveFrontTrackerResult-32"><span class="linenos"> 32</span></a><span class="sd">    Example:</span>
</span><span id="WaveFrontTrackerResult-33"><a href="#WaveFrontTrackerResult-33"><span class="linenos"> 33</span></a><span class="sd">        &gt;&gt;&gt; result = WaveFrontTrackerResult(</span>
</span><span id="WaveFrontTrackerResult-34"><a href="#WaveFrontTrackerResult-34"><span class="linenos"> 34</span></a><span class="sd">        ...     source_ids=np.array([1, 1, 2]),</span>
</span><span id="WaveFrontTrackerResult-35"><a href="#WaveFrontTrackerResult-35"><span class="linenos"> 35</span></a><span class="sd">        ...     receiver_ids=np.array([1, 2, 1]),</span>
</span><span id="WaveFrontTrackerResult-36"><a href="#WaveFrontTrackerResult-36"><span class="linenos"> 36</span></a><span class="sd">        ...     arrival_numbers=np.array([1, 1, 1]),</span>
</span><span id="WaveFrontTrackerResult-37"><a href="#WaveFrontTrackerResult-37"><span class="linenos"> 37</span></a><span class="sd">        ...     travel_times=np.array([10.5, 12.3, 11.1]),</span>
</span><span id="WaveFrontTrackerResult-38"><a href="#WaveFrontTrackerResult-38"><span class="linenos"> 38</span></a><span class="sd">        ...     azimuths=np.array([45.0, 30.0, 50.0]),</span>
</span><span id="WaveFrontTrackerResult-39"><a href="#WaveFrontTrackerResult-39"><span class="linenos"> 39</span></a><span class="sd">        ...     spreading_factors=np.array([1.0, 0.9, 1.1])</span>
</span><span id="WaveFrontTrackerResult-40"><a href="#WaveFrontTrackerResult-40"><span class="linenos"> 40</span></a><span class="sd">        ... )</span>
</span><span id="WaveFrontTrackerResult-41"><a href="#WaveFrontTrackerResult-41"><span class="linenos"> 41</span></a><span class="sd">        &gt;&gt;&gt; df = result.to_dataframe()</span>
</span><span id="WaveFrontTrackerResult-42"><a href="#WaveFrontTrackerResult-42"><span class="linenos"> 42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="WaveFrontTrackerResult-43"><a href="#WaveFrontTrackerResult-43"><span class="linenos"> 43</span></a>
</span><span id="WaveFrontTrackerResult-44"><a href="#WaveFrontTrackerResult-44"><span class="linenos"> 44</span></a>    <span class="c1"># Arrival data (flattened arrays)</span>
</span><span id="WaveFrontTrackerResult-45"><a href="#WaveFrontTrackerResult-45"><span class="linenos"> 45</span></a>    <span class="n">source_ids</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
</span><span id="WaveFrontTrackerResult-46"><a href="#WaveFrontTrackerResult-46"><span class="linenos"> 46</span></a>        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="WaveFrontTrackerResult-47"><a href="#WaveFrontTrackerResult-47"><span class="linenos"> 47</span></a>    <span class="p">)</span>
</span><span id="WaveFrontTrackerResult-48"><a href="#WaveFrontTrackerResult-48"><span class="linenos"> 48</span></a>    <span class="n">receiver_ids</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
</span><span id="WaveFrontTrackerResult-49"><a href="#WaveFrontTrackerResult-49"><span class="linenos"> 49</span></a>        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="WaveFrontTrackerResult-50"><a href="#WaveFrontTrackerResult-50"><span class="linenos"> 50</span></a>    <span class="p">)</span>
</span><span id="WaveFrontTrackerResult-51"><a href="#WaveFrontTrackerResult-51"><span class="linenos"> 51</span></a>    <span class="n">arrival_numbers</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
</span><span id="WaveFrontTrackerResult-52"><a href="#WaveFrontTrackerResult-52"><span class="linenos"> 52</span></a>        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="WaveFrontTrackerResult-53"><a href="#WaveFrontTrackerResult-53"><span class="linenos"> 53</span></a>    <span class="p">)</span>
</span><span id="WaveFrontTrackerResult-54"><a href="#WaveFrontTrackerResult-54"><span class="linenos"> 54</span></a>    <span class="n">travel_times</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
</span><span id="WaveFrontTrackerResult-55"><a href="#WaveFrontTrackerResult-55"><span class="linenos"> 55</span></a>        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="WaveFrontTrackerResult-56"><a href="#WaveFrontTrackerResult-56"><span class="linenos"> 56</span></a>    <span class="p">)</span>
</span><span id="WaveFrontTrackerResult-57"><a href="#WaveFrontTrackerResult-57"><span class="linenos"> 57</span></a>    <span class="n">azimuths</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
</span><span id="WaveFrontTrackerResult-58"><a href="#WaveFrontTrackerResult-58"><span class="linenos"> 58</span></a>        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="WaveFrontTrackerResult-59"><a href="#WaveFrontTrackerResult-59"><span class="linenos"> 59</span></a>    <span class="p">)</span>
</span><span id="WaveFrontTrackerResult-60"><a href="#WaveFrontTrackerResult-60"><span class="linenos"> 60</span></a>    <span class="n">spreading_factors</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
</span><span id="WaveFrontTrackerResult-61"><a href="#WaveFrontTrackerResult-61"><span class="linenos"> 61</span></a>        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="WaveFrontTrackerResult-62"><a href="#WaveFrontTrackerResult-62"><span class="linenos"> 62</span></a>    <span class="p">)</span>
</span><span id="WaveFrontTrackerResult-63"><a href="#WaveFrontTrackerResult-63"><span class="linenos"> 63</span></a>
</span><span id="WaveFrontTrackerResult-64"><a href="#WaveFrontTrackerResult-64"><span class="linenos"> 64</span></a>    <span class="c1"># Raypaths (list of dicts)</span>
</span><span id="WaveFrontTrackerResult-65"><a href="#WaveFrontTrackerResult-65"><span class="linenos"> 65</span></a>    <span class="n">raypaths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</span><span id="WaveFrontTrackerResult-66"><a href="#WaveFrontTrackerResult-66"><span class="linenos"> 66</span></a>    <span class="c1"># Each dict has keys: source, receiver, arrival, path (ndarray of shape (n, 2))</span>
</span><span id="WaveFrontTrackerResult-67"><a href="#WaveFrontTrackerResult-67"><span class="linenos"> 67</span></a>
</span><span id="WaveFrontTrackerResult-68"><a href="#WaveFrontTrackerResult-68"><span class="linenos"> 68</span></a>    <span class="c1"># Wavefronts (dict by source)</span>
</span><span id="WaveFrontTrackerResult-69"><a href="#WaveFrontTrackerResult-69"><span class="linenos"> 69</span></a>    <span class="n">wavefronts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</span><span id="WaveFrontTrackerResult-70"><a href="#WaveFrontTrackerResult-70"><span class="linenos"> 70</span></a>
</span><span id="WaveFrontTrackerResult-71"><a href="#WaveFrontTrackerResult-71"><span class="linenos"> 71</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;WaveFrontTrackerResult&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;WaveFrontTrackerResult&#39;</span><span class="p">:</span>
</span><span id="WaveFrontTrackerResult-72"><a href="#WaveFrontTrackerResult-72"><span class="linenos"> 72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge two result objects (pyfm2d pattern).</span>
</span><span id="WaveFrontTrackerResult-73"><a href="#WaveFrontTrackerResult-73"><span class="linenos"> 73</span></a>
</span><span id="WaveFrontTrackerResult-74"><a href="#WaveFrontTrackerResult-74"><span class="linenos"> 74</span></a><span class="sd">        This enables reduction aggregation:</span>
</span><span id="WaveFrontTrackerResult-75"><a href="#WaveFrontTrackerResult-75"><span class="linenos"> 75</span></a><span class="sd">            combined = reduce(operator.add, results)</span>
</span><span id="WaveFrontTrackerResult-76"><a href="#WaveFrontTrackerResult-76"><span class="linenos"> 76</span></a>
</span><span id="WaveFrontTrackerResult-77"><a href="#WaveFrontTrackerResult-77"><span class="linenos"> 77</span></a><span class="sd">        Args:</span>
</span><span id="WaveFrontTrackerResult-78"><a href="#WaveFrontTrackerResult-78"><span class="linenos"> 78</span></a><span class="sd">            other: Another WaveFrontTrackerResult to merge</span>
</span><span id="WaveFrontTrackerResult-79"><a href="#WaveFrontTrackerResult-79"><span class="linenos"> 79</span></a>
</span><span id="WaveFrontTrackerResult-80"><a href="#WaveFrontTrackerResult-80"><span class="linenos"> 80</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTrackerResult-81"><a href="#WaveFrontTrackerResult-81"><span class="linenos"> 81</span></a><span class="sd">            New WaveFrontTrackerResult with concatenated data</span>
</span><span id="WaveFrontTrackerResult-82"><a href="#WaveFrontTrackerResult-82"><span class="linenos"> 82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTrackerResult-83"><a href="#WaveFrontTrackerResult-83"><span class="linenos"> 83</span></a>        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WaveFrontTrackerResult-84"><a href="#WaveFrontTrackerResult-84"><span class="linenos"> 84</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="WaveFrontTrackerResult-85"><a href="#WaveFrontTrackerResult-85"><span class="linenos"> 85</span></a>
</span><span id="WaveFrontTrackerResult-86"><a href="#WaveFrontTrackerResult-86"><span class="linenos"> 86</span></a>        <span class="c1"># Concatenate arrival arrays</span>
</span><span id="WaveFrontTrackerResult-87"><a href="#WaveFrontTrackerResult-87"><span class="linenos"> 87</span></a>        <span class="n">merged</span> <span class="o">=</span> <span class="n">WaveFrontTrackerResult</span><span class="p">(</span>
</span><span id="WaveFrontTrackerResult-88"><a href="#WaveFrontTrackerResult-88"><span class="linenos"> 88</span></a>            <span class="n">source_ids</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">source_ids</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">source_ids</span><span class="p">]),</span>
</span><span id="WaveFrontTrackerResult-89"><a href="#WaveFrontTrackerResult-89"><span class="linenos"> 89</span></a>            <span class="n">receiver_ids</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">receiver_ids</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">receiver_ids</span><span class="p">]),</span>
</span><span id="WaveFrontTrackerResult-90"><a href="#WaveFrontTrackerResult-90"><span class="linenos"> 90</span></a>            <span class="n">arrival_numbers</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">arrival_numbers</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">arrival_numbers</span><span class="p">]),</span>
</span><span id="WaveFrontTrackerResult-91"><a href="#WaveFrontTrackerResult-91"><span class="linenos"> 91</span></a>            <span class="n">travel_times</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">travel_times</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">travel_times</span><span class="p">]),</span>
</span><span id="WaveFrontTrackerResult-92"><a href="#WaveFrontTrackerResult-92"><span class="linenos"> 92</span></a>            <span class="n">azimuths</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">azimuths</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">azimuths</span><span class="p">]),</span>
</span><span id="WaveFrontTrackerResult-93"><a href="#WaveFrontTrackerResult-93"><span class="linenos"> 93</span></a>            <span class="n">spreading_factors</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">spreading_factors</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">spreading_factors</span><span class="p">]),</span>
</span><span id="WaveFrontTrackerResult-94"><a href="#WaveFrontTrackerResult-94"><span class="linenos"> 94</span></a>        <span class="p">)</span>
</span><span id="WaveFrontTrackerResult-95"><a href="#WaveFrontTrackerResult-95"><span class="linenos"> 95</span></a>
</span><span id="WaveFrontTrackerResult-96"><a href="#WaveFrontTrackerResult-96"><span class="linenos"> 96</span></a>        <span class="c1"># Merge raypaths</span>
</span><span id="WaveFrontTrackerResult-97"><a href="#WaveFrontTrackerResult-97"><span class="linenos"> 97</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">raypaths</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raypaths</span> <span class="ow">or</span> <span class="p">[])</span> <span class="o">+</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">raypaths</span> <span class="ow">or</span> <span class="p">[])</span>
</span><span id="WaveFrontTrackerResult-98"><a href="#WaveFrontTrackerResult-98"><span class="linenos"> 98</span></a>
</span><span id="WaveFrontTrackerResult-99"><a href="#WaveFrontTrackerResult-99"><span class="linenos"> 99</span></a>        <span class="c1"># Merge wavefronts</span>
</span><span id="WaveFrontTrackerResult-100"><a href="#WaveFrontTrackerResult-100"><span class="linenos">100</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">wavefronts</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavefronts</span> <span class="ow">or</span> <span class="p">{}),</span> <span class="o">**</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">wavefronts</span> <span class="ow">or</span> <span class="p">{})}</span>
</span><span id="WaveFrontTrackerResult-101"><a href="#WaveFrontTrackerResult-101"><span class="linenos">101</span></a>
</span><span id="WaveFrontTrackerResult-102"><a href="#WaveFrontTrackerResult-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="n">merged</span>
</span><span id="WaveFrontTrackerResult-103"><a href="#WaveFrontTrackerResult-103"><span class="linenos">103</span></a>
</span><span id="WaveFrontTrackerResult-104"><a href="#WaveFrontTrackerResult-104"><span class="linenos">104</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WaveFrontTrackerResult-105"><a href="#WaveFrontTrackerResult-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert arrival data to pandas DataFrame.</span>
</span><span id="WaveFrontTrackerResult-106"><a href="#WaveFrontTrackerResult-106"><span class="linenos">106</span></a>
</span><span id="WaveFrontTrackerResult-107"><a href="#WaveFrontTrackerResult-107"><span class="linenos">107</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTrackerResult-108"><a href="#WaveFrontTrackerResult-108"><span class="linenos">108</span></a><span class="sd">            DataFrame with columns: source, receiver, arrival, time, azimuth, spreading</span>
</span><span id="WaveFrontTrackerResult-109"><a href="#WaveFrontTrackerResult-109"><span class="linenos">109</span></a>
</span><span id="WaveFrontTrackerResult-110"><a href="#WaveFrontTrackerResult-110"><span class="linenos">110</span></a><span class="sd">        Raises:</span>
</span><span id="WaveFrontTrackerResult-111"><a href="#WaveFrontTrackerResult-111"><span class="linenos">111</span></a><span class="sd">            ImportError: If pandas is not installed</span>
</span><span id="WaveFrontTrackerResult-112"><a href="#WaveFrontTrackerResult-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTrackerResult-113"><a href="#WaveFrontTrackerResult-113"><span class="linenos">113</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="WaveFrontTrackerResult-114"><a href="#WaveFrontTrackerResult-114"><span class="linenos">114</span></a>            <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="WaveFrontTrackerResult-115"><a href="#WaveFrontTrackerResult-115"><span class="linenos">115</span></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="WaveFrontTrackerResult-116"><a href="#WaveFrontTrackerResult-116"><span class="linenos">116</span></a>            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;pandas is required for to_dataframe(). Install with: pip install pandas&quot;</span><span class="p">)</span>
</span><span id="WaveFrontTrackerResult-117"><a href="#WaveFrontTrackerResult-117"><span class="linenos">117</span></a>
</span><span id="WaveFrontTrackerResult-118"><a href="#WaveFrontTrackerResult-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="WaveFrontTrackerResult-119"><a href="#WaveFrontTrackerResult-119"><span class="linenos">119</span></a>            <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_ids</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult-120"><a href="#WaveFrontTrackerResult-120"><span class="linenos">120</span></a>            <span class="s1">&#39;receiver&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">receiver_ids</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult-121"><a href="#WaveFrontTrackerResult-121"><span class="linenos">121</span></a>            <span class="s1">&#39;arrival&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrival_numbers</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult-122"><a href="#WaveFrontTrackerResult-122"><span class="linenos">122</span></a>            <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">travel_times</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult-123"><a href="#WaveFrontTrackerResult-123"><span class="linenos">123</span></a>            <span class="s1">&#39;azimuth&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">azimuths</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult-124"><a href="#WaveFrontTrackerResult-124"><span class="linenos">124</span></a>            <span class="s1">&#39;spreading&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">spreading_factors</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult-125"><a href="#WaveFrontTrackerResult-125"><span class="linenos">125</span></a>        <span class="p">})</span>
</span><span id="WaveFrontTrackerResult-126"><a href="#WaveFrontTrackerResult-126"><span class="linenos">126</span></a>
</span><span id="WaveFrontTrackerResult-127"><a href="#WaveFrontTrackerResult-127"><span class="linenos">127</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="WaveFrontTrackerResult-128"><a href="#WaveFrontTrackerResult-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation.&quot;&quot;&quot;</span>
</span><span id="WaveFrontTrackerResult-129"><a href="#WaveFrontTrackerResult-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="WaveFrontTrackerResult-130"><a href="#WaveFrontTrackerResult-130"><span class="linenos">130</span></a>            <span class="sa">f</span><span class="s2">&quot;WaveFrontTrackerResult(&quot;</span>
</span><span id="WaveFrontTrackerResult-131"><a href="#WaveFrontTrackerResult-131"><span class="linenos">131</span></a>            <span class="sa">f</span><span class="s2">&quot;arrivals=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">travel_times</span><span class="p">)</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="WaveFrontTrackerResult-132"><a href="#WaveFrontTrackerResult-132"><span class="linenos">132</span></a>            <span class="sa">f</span><span class="s2">&quot;raypaths=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raypaths</span><span class="p">)</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="WaveFrontTrackerResult-133"><a href="#WaveFrontTrackerResult-133"><span class="linenos">133</span></a>            <span class="sa">f</span><span class="s2">&quot;sources=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavefronts</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="WaveFrontTrackerResult-134"><a href="#WaveFrontTrackerResult-134"><span class="linenos">134</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Results from wavefront tracking (single or multiple sources).</p>

<p>This class stores arrival times, raypaths, and wavefronts from
wavefront tracking computations. Data is stored in flattened arrays
to naturally handle variable arrival counts per receiver.</p>

<p>Attributes:
    source_ids: Source IDs for each arrival (1-based)
    receiver_ids: Receiver IDs for each arrival (1-based)
    arrival_numbers: Arrival numbers (1=first, 2=second, etc.)
    travel_times: Arrival times
    azimuths: Azimuths at receivers
    spreading_factors: Spreading factors (if mode=2)
    raypaths: List of raypath dicts with keys: source, receiver, arrival, path
    wavefronts: Dict mapping source_id to list of wavefront arrays</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>result = WaveFrontTrackerResult(
          ...     source_ids=np.array([1, 1, 2]),
          ...     receiver_ids=np.array([1, 2, 1]),
          ...     arrival_numbers=np.array([1, 1, 1]),
          ...     travel_times=np.array([10.5, 12.3, 11.1]),
          ...     azimuths=np.array([45.0, 30.0, 50.0]),
          ...     spreading_factors=np.array([1.0, 0.9, 1.1])
          ... )
      df = result.to_dataframe()</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            <div id="WaveFrontTrackerResult.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">WaveFrontTrackerResult</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source_ids</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">receiver_ids</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">arrival_numbers</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">travel_times</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">azimuths</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">spreading_factors</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">raypaths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">wavefronts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">~</span><span class="n">_ScalarT</span><span class="p">]]]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult.__init__"></a>
    
    

                            </div>
                            <div id="WaveFrontTrackerResult.source_ids" class="classattr">
                                <div class="attr variable">
            <span class="name">source_ids</span><span class="annotation">: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[numpy.int32]]</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult.source_ids"></a>
    
    

                            </div>
                            <div id="WaveFrontTrackerResult.receiver_ids" class="classattr">
                                <div class="attr variable">
            <span class="name">receiver_ids</span><span class="annotation">: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[numpy.int32]]</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult.receiver_ids"></a>
    
    

                            </div>
                            <div id="WaveFrontTrackerResult.arrival_numbers" class="classattr">
                                <div class="attr variable">
            <span class="name">arrival_numbers</span><span class="annotation">: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[numpy.int32]]</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult.arrival_numbers"></a>
    
    

                            </div>
                            <div id="WaveFrontTrackerResult.travel_times" class="classattr">
                                <div class="attr variable">
            <span class="name">travel_times</span><span class="annotation">: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[numpy.float32]]</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult.travel_times"></a>
    
    

                            </div>
                            <div id="WaveFrontTrackerResult.azimuths" class="classattr">
                                <div class="attr variable">
            <span class="name">azimuths</span><span class="annotation">: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[numpy.float32]]</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult.azimuths"></a>
    
    

                            </div>
                            <div id="WaveFrontTrackerResult.spreading_factors" class="classattr">
                                <div class="attr variable">
            <span class="name">spreading_factors</span><span class="annotation">: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[numpy.float32]]</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult.spreading_factors"></a>
    
    

                            </div>
                            <div id="WaveFrontTrackerResult.raypaths" class="classattr">
                                <div class="attr variable">
            <span class="name">raypaths</span><span class="annotation">: List[Dict]</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult.raypaths"></a>
    
    

                            </div>
                            <div id="WaveFrontTrackerResult.wavefronts" class="classattr">
                                <div class="attr variable">
            <span class="name">wavefronts</span><span class="annotation">: Dict[int, List[numpy.ndarray[tuple[Any, ...], numpy.dtype[~_ScalarT]]]]</span>

        
    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult.wavefronts"></a>
    
    

                            </div>
                            <div id="WaveFrontTrackerResult.to_dataframe" class="classattr">
                                        <input id="WaveFrontTrackerResult.to_dataframe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_dataframe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WaveFrontTrackerResult.to_dataframe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WaveFrontTrackerResult.to_dataframe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WaveFrontTrackerResult.to_dataframe-104"><a href="#WaveFrontTrackerResult.to_dataframe-104"><span class="linenos">104</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-105"><a href="#WaveFrontTrackerResult.to_dataframe-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert arrival data to pandas DataFrame.</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-106"><a href="#WaveFrontTrackerResult.to_dataframe-106"><span class="linenos">106</span></a>
</span><span id="WaveFrontTrackerResult.to_dataframe-107"><a href="#WaveFrontTrackerResult.to_dataframe-107"><span class="linenos">107</span></a><span class="sd">        Returns:</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-108"><a href="#WaveFrontTrackerResult.to_dataframe-108"><span class="linenos">108</span></a><span class="sd">            DataFrame with columns: source, receiver, arrival, time, azimuth, spreading</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-109"><a href="#WaveFrontTrackerResult.to_dataframe-109"><span class="linenos">109</span></a>
</span><span id="WaveFrontTrackerResult.to_dataframe-110"><a href="#WaveFrontTrackerResult.to_dataframe-110"><span class="linenos">110</span></a><span class="sd">        Raises:</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-111"><a href="#WaveFrontTrackerResult.to_dataframe-111"><span class="linenos">111</span></a><span class="sd">            ImportError: If pandas is not installed</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-112"><a href="#WaveFrontTrackerResult.to_dataframe-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-113"><a href="#WaveFrontTrackerResult.to_dataframe-113"><span class="linenos">113</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-114"><a href="#WaveFrontTrackerResult.to_dataframe-114"><span class="linenos">114</span></a>            <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-115"><a href="#WaveFrontTrackerResult.to_dataframe-115"><span class="linenos">115</span></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-116"><a href="#WaveFrontTrackerResult.to_dataframe-116"><span class="linenos">116</span></a>            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;pandas is required for to_dataframe(). Install with: pip install pandas&quot;</span><span class="p">)</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-117"><a href="#WaveFrontTrackerResult.to_dataframe-117"><span class="linenos">117</span></a>
</span><span id="WaveFrontTrackerResult.to_dataframe-118"><a href="#WaveFrontTrackerResult.to_dataframe-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-119"><a href="#WaveFrontTrackerResult.to_dataframe-119"><span class="linenos">119</span></a>            <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_ids</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-120"><a href="#WaveFrontTrackerResult.to_dataframe-120"><span class="linenos">120</span></a>            <span class="s1">&#39;receiver&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">receiver_ids</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-121"><a href="#WaveFrontTrackerResult.to_dataframe-121"><span class="linenos">121</span></a>            <span class="s1">&#39;arrival&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrival_numbers</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-122"><a href="#WaveFrontTrackerResult.to_dataframe-122"><span class="linenos">122</span></a>            <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">travel_times</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-123"><a href="#WaveFrontTrackerResult.to_dataframe-123"><span class="linenos">123</span></a>            <span class="s1">&#39;azimuth&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">azimuths</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-124"><a href="#WaveFrontTrackerResult.to_dataframe-124"><span class="linenos">124</span></a>            <span class="s1">&#39;spreading&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">spreading_factors</span><span class="p">,</span>
</span><span id="WaveFrontTrackerResult.to_dataframe-125"><a href="#WaveFrontTrackerResult.to_dataframe-125"><span class="linenos">125</span></a>        <span class="p">})</span>
</span></pre></div>


            <div class="docstring"><p>Convert arrival data to pandas DataFrame.</p>

<p>Returns:
    DataFrame with columns: source, receiver, arrival, time, azimuth, spreading</p>

<p>Raises:
    ImportError: If pandas is not installed</p>
</div>


                            </div>
                </section>
                <section id="LibSWMP">
                            <input id="LibSWMP-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LibSWMP</span>:

                <label class="view-source-button" for="LibSWMP-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP-77"><a href="#LibSWMP-77"><span class="linenos"> 77</span></a><span class="k">class</span><span class="w"> </span><span class="nc">LibSWMP</span><span class="p">:</span>
</span><span id="LibSWMP-78"><a href="#LibSWMP-78"><span class="linenos"> 78</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper for the SWMP Fortran library.</span>
</span><span id="LibSWMP-79"><a href="#LibSWMP-79"><span class="linenos"> 79</span></a>
</span><span id="LibSWMP-80"><a href="#LibSWMP-80"><span class="linenos"> 80</span></a><span class="sd">    This class loads the compiled library and defines ctypes signatures</span>
</span><span id="LibSWMP-81"><a href="#LibSWMP-81"><span class="linenos"> 81</span></a><span class="sd">    for all C-callable functions. Each instance maintains independent state.</span>
</span><span id="LibSWMP-82"><a href="#LibSWMP-82"><span class="linenos"> 82</span></a>
</span><span id="LibSWMP-83"><a href="#LibSWMP-83"><span class="linenos"> 83</span></a><span class="sd">    Example:</span>
</span><span id="LibSWMP-84"><a href="#LibSWMP-84"><span class="linenos"> 84</span></a><span class="sd">        &gt;&gt;&gt; lib = LibSWMP()</span>
</span><span id="LibSWMP-85"><a href="#LibSWMP-85"><span class="linenos"> 85</span></a><span class="sd">        &gt;&gt;&gt; lib.read_rat_conf(b&quot;config.in&quot;)</span>
</span><span id="LibSWMP-86"><a href="#LibSWMP-86"><span class="linenos"> 86</span></a><span class="sd">        &gt;&gt;&gt; lib.read_model(b&quot;model.vel&quot;)</span>
</span><span id="LibSWMP-87"><a href="#LibSWMP-87"><span class="linenos"> 87</span></a><span class="sd">        &gt;&gt;&gt; lib.forward()</span>
</span><span id="LibSWMP-88"><a href="#LibSWMP-88"><span class="linenos"> 88</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LibSWMP-89"><a href="#LibSWMP-89"><span class="linenos"> 89</span></a>
</span><span id="LibSWMP-90"><a href="#LibSWMP-90"><span class="linenos"> 90</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="LibSWMP-91"><a href="#LibSWMP-91"><span class="linenos"> 91</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize library wrapper.</span>
</span><span id="LibSWMP-92"><a href="#LibSWMP-92"><span class="linenos"> 92</span></a>
</span><span id="LibSWMP-93"><a href="#LibSWMP-93"><span class="linenos"> 93</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-94"><a href="#LibSWMP-94"><span class="linenos"> 94</span></a><span class="sd">            lib_path: Optional explicit path to library file</span>
</span><span id="LibSWMP-95"><a href="#LibSWMP-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-96"><a href="#LibSWMP-96"><span class="linenos"> 96</span></a>        <span class="k">if</span> <span class="n">lib_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LibSWMP-97"><a href="#LibSWMP-97"><span class="linenos"> 97</span></a>            <span class="n">lib_path</span> <span class="o">=</span> <span class="n">_find_library</span><span class="p">()</span>
</span><span id="LibSWMP-98"><a href="#LibSWMP-98"><span class="linenos"> 98</span></a>
</span><span id="LibSWMP-99"><a href="#LibSWMP-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">CDLL</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lib_path</span><span class="p">))</span>
</span><span id="LibSWMP-100"><a href="#LibSWMP-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_functions</span><span class="p">()</span>
</span><span id="LibSWMP-101"><a href="#LibSWMP-101"><span class="linenos">101</span></a>
</span><span id="LibSWMP-102"><a href="#LibSWMP-102"><span class="linenos">102</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_setup_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LibSWMP-103"><a href="#LibSWMP-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Define ctypes signatures for all library functions.&quot;&quot;&quot;</span>
</span><span id="LibSWMP-104"><a href="#LibSWMP-104"><span class="linenos">104</span></a>        <span class="n">lib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span>
</span><span id="LibSWMP-105"><a href="#LibSWMP-105"><span class="linenos">105</span></a>
</span><span id="LibSWMP-106"><a href="#LibSWMP-106"><span class="linenos">106</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-107"><a href="#LibSWMP-107"><span class="linenos">107</span></a>        <span class="c1"># Error Handling</span>
</span><span id="LibSWMP-108"><a href="#LibSWMP-108"><span class="linenos">108</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-109"><a href="#LibSWMP-109"><span class="linenos">109</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_last_error</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LibSWMP-110"><a href="#LibSWMP-110"><span class="linenos">110</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">),</span>  <span class="c1"># error code</span>
</span><span id="LibSWMP-111"><a href="#LibSWMP-111"><span class="linenos">111</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">,</span>                  <span class="c1"># message buffer</span>
</span><span id="LibSWMP-112"><a href="#LibSWMP-112"><span class="linenos">112</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>                   <span class="c1"># buffer length</span>
</span><span id="LibSWMP-113"><a href="#LibSWMP-113"><span class="linenos">113</span></a>        <span class="p">]</span>
</span><span id="LibSWMP-114"><a href="#LibSWMP-114"><span class="linenos">114</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_last_error</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-115"><a href="#LibSWMP-115"><span class="linenos">115</span></a>
</span><span id="LibSWMP-116"><a href="#LibSWMP-116"><span class="linenos">116</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">clear_error</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LibSWMP-117"><a href="#LibSWMP-117"><span class="linenos">117</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">clear_error</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-118"><a href="#LibSWMP-118"><span class="linenos">118</span></a>
</span><span id="LibSWMP-119"><a href="#LibSWMP-119"><span class="linenos">119</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-120"><a href="#LibSWMP-120"><span class="linenos">120</span></a>        <span class="c1"># Configuration and I/O</span>
</span><span id="LibSWMP-121"><a href="#LibSWMP-121"><span class="linenos">121</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-122"><a href="#LibSWMP-122"><span class="linenos">122</span></a>        <span class="c1"># Note: rat_read_conf loads everything from config file</span>
</span><span id="LibSWMP-123"><a href="#LibSWMP-123"><span class="linenos">123</span></a>        <span class="c1"># (model, sources, receivers, etc.)</span>
</span><span id="LibSWMP-124"><a href="#LibSWMP-124"><span class="linenos">124</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">rat_read_conf</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span>
</span><span id="LibSWMP-125"><a href="#LibSWMP-125"><span class="linenos">125</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">rat_read_conf</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-126"><a href="#LibSWMP-126"><span class="linenos">126</span></a>
</span><span id="LibSWMP-127"><a href="#LibSWMP-127"><span class="linenos">127</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-128"><a href="#LibSWMP-128"><span class="linenos">128</span></a>        <span class="c1"># Forward Modeling</span>
</span><span id="LibSWMP-129"><a href="#LibSWMP-129"><span class="linenos">129</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-130"><a href="#LibSWMP-130"><span class="linenos">130</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LibSWMP-131"><a href="#LibSWMP-131"><span class="linenos">131</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-132"><a href="#LibSWMP-132"><span class="linenos">132</span></a>
</span><span id="LibSWMP-133"><a href="#LibSWMP-133"><span class="linenos">133</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">forward_single_source</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span>
</span><span id="LibSWMP-134"><a href="#LibSWMP-134"><span class="linenos">134</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">forward_single_source</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-135"><a href="#LibSWMP-135"><span class="linenos">135</span></a>
</span><span id="LibSWMP-136"><a href="#LibSWMP-136"><span class="linenos">136</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-137"><a href="#LibSWMP-137"><span class="linenos">137</span></a>        <span class="c1"># Control Functions</span>
</span><span id="LibSWMP-138"><a href="#LibSWMP-138"><span class="linenos">138</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-139"><a href="#LibSWMP-139"><span class="linenos">139</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_number_of_sources</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">)]</span>
</span><span id="LibSWMP-140"><a href="#LibSWMP-140"><span class="linenos">140</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_number_of_sources</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-141"><a href="#LibSWMP-141"><span class="linenos">141</span></a>
</span><span id="LibSWMP-142"><a href="#LibSWMP-142"><span class="linenos">142</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_enable_file_output</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span>
</span><span id="LibSWMP-143"><a href="#LibSWMP-143"><span class="linenos">143</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_enable_file_output</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-144"><a href="#LibSWMP-144"><span class="linenos">144</span></a>
</span><span id="LibSWMP-145"><a href="#LibSWMP-145"><span class="linenos">145</span></a>        <span class="c1"># Parameter setters</span>
</span><span id="LibSWMP-146"><a href="#LibSWMP-146"><span class="linenos">146</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_dt</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">]</span>
</span><span id="LibSWMP-147"><a href="#LibSWMP-147"><span class="linenos">147</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_dt</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-148"><a href="#LibSWMP-148"><span class="linenos">148</span></a>
</span><span id="LibSWMP-149"><a href="#LibSWMP-149"><span class="linenos">149</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_maxit</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span>
</span><span id="LibSWMP-150"><a href="#LibSWMP-150"><span class="linenos">150</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_maxit</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-151"><a href="#LibSWMP-151"><span class="linenos">151</span></a>
</span><span id="LibSWMP-152"><a href="#LibSWMP-152"><span class="linenos">152</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_nsenod</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span>
</span><span id="LibSWMP-153"><a href="#LibSWMP-153"><span class="linenos">153</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_nsenod</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-154"><a href="#LibSWMP-154"><span class="linenos">154</span></a>
</span><span id="LibSWMP-155"><a href="#LibSWMP-155"><span class="linenos">155</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_mode</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span>
</span><span id="LibSWMP-156"><a href="#LibSWMP-156"><span class="linenos">156</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_mode</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-157"><a href="#LibSWMP-157"><span class="linenos">157</span></a>
</span><span id="LibSWMP-158"><a href="#LibSWMP-158"><span class="linenos">158</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_solver</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span>
</span><span id="LibSWMP-159"><a href="#LibSWMP-159"><span class="linenos">159</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_solver</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-160"><a href="#LibSWMP-160"><span class="linenos">160</span></a>
</span><span id="LibSWMP-161"><a href="#LibSWMP-161"><span class="linenos">161</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_interp</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span>
</span><span id="LibSWMP-162"><a href="#LibSWMP-162"><span class="linenos">162</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_interp</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-163"><a href="#LibSWMP-163"><span class="linenos">163</span></a>
</span><span id="LibSWMP-164"><a href="#LibSWMP-164"><span class="linenos">164</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_mar</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span>
</span><span id="LibSWMP-165"><a href="#LibSWMP-165"><span class="linenos">165</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_mar</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-166"><a href="#LibSWMP-166"><span class="linenos">166</span></a>
</span><span id="LibSWMP-167"><a href="#LibSWMP-167"><span class="linenos">167</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_velint</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span>
</span><span id="LibSWMP-168"><a href="#LibSWMP-168"><span class="linenos">168</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_velint</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-169"><a href="#LibSWMP-169"><span class="linenos">169</span></a>
</span><span id="LibSWMP-170"><a href="#LibSWMP-170"><span class="linenos">170</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_rearth</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">]</span>
</span><span id="LibSWMP-171"><a href="#LibSWMP-171"><span class="linenos">171</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_rearth</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-172"><a href="#LibSWMP-172"><span class="linenos">172</span></a>
</span><span id="LibSWMP-173"><a href="#LibSWMP-173"><span class="linenos">173</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-174"><a href="#LibSWMP-174"><span class="linenos">174</span></a>        <span class="c1"># In-Memory Data Extraction - Arrivals</span>
</span><span id="LibSWMP-175"><a href="#LibSWMP-175"><span class="linenos">175</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-176"><a href="#LibSWMP-176"><span class="linenos">176</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_number_of_arrivals_in_memory</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LibSWMP-177"><a href="#LibSWMP-177"><span class="linenos">177</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">)</span>
</span><span id="LibSWMP-178"><a href="#LibSWMP-178"><span class="linenos">178</span></a>        <span class="p">]</span>
</span><span id="LibSWMP-179"><a href="#LibSWMP-179"><span class="linenos">179</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_number_of_arrivals_in_memory</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-180"><a href="#LibSWMP-180"><span class="linenos">180</span></a>
</span><span id="LibSWMP-181"><a href="#LibSWMP-181"><span class="linenos">181</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_arrivals_from_memory</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LibSWMP-182"><a href="#LibSWMP-182"><span class="linenos">182</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># receivers</span>
</span><span id="LibSWMP-183"><a href="#LibSWMP-183"><span class="linenos">183</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># arrival_nums</span>
</span><span id="LibSWMP-184"><a href="#LibSWMP-184"><span class="linenos">184</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># times</span>
</span><span id="LibSWMP-185"><a href="#LibSWMP-185"><span class="linenos">185</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># azimuths</span>
</span><span id="LibSWMP-186"><a href="#LibSWMP-186"><span class="linenos">186</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># spreading</span>
</span><span id="LibSWMP-187"><a href="#LibSWMP-187"><span class="linenos">187</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>  <span class="c1"># array size</span>
</span><span id="LibSWMP-188"><a href="#LibSWMP-188"><span class="linenos">188</span></a>        <span class="p">]</span>
</span><span id="LibSWMP-189"><a href="#LibSWMP-189"><span class="linenos">189</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_arrivals_from_memory</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-190"><a href="#LibSWMP-190"><span class="linenos">190</span></a>
</span><span id="LibSWMP-191"><a href="#LibSWMP-191"><span class="linenos">191</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-192"><a href="#LibSWMP-192"><span class="linenos">192</span></a>        <span class="c1"># In-Memory Data Extraction - Raypaths</span>
</span><span id="LibSWMP-193"><a href="#LibSWMP-193"><span class="linenos">193</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-194"><a href="#LibSWMP-194"><span class="linenos">194</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_raypath_count_in_memory</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LibSWMP-195"><a href="#LibSWMP-195"><span class="linenos">195</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">),</span>  <span class="c1"># n_paths</span>
</span><span id="LibSWMP-196"><a href="#LibSWMP-196"><span class="linenos">196</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">),</span>  <span class="c1"># total_points</span>
</span><span id="LibSWMP-197"><a href="#LibSWMP-197"><span class="linenos">197</span></a>        <span class="p">]</span>
</span><span id="LibSWMP-198"><a href="#LibSWMP-198"><span class="linenos">198</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_raypath_count_in_memory</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-199"><a href="#LibSWMP-199"><span class="linenos">199</span></a>
</span><span id="LibSWMP-200"><a href="#LibSWMP-200"><span class="linenos">200</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_raypath_metadata_from_memory</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LibSWMP-201"><a href="#LibSWMP-201"><span class="linenos">201</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># receivers</span>
</span><span id="LibSWMP-202"><a href="#LibSWMP-202"><span class="linenos">202</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># arrival_nums</span>
</span><span id="LibSWMP-203"><a href="#LibSWMP-203"><span class="linenos">203</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># npts</span>
</span><span id="LibSWMP-204"><a href="#LibSWMP-204"><span class="linenos">204</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>  <span class="c1"># n_paths</span>
</span><span id="LibSWMP-205"><a href="#LibSWMP-205"><span class="linenos">205</span></a>        <span class="p">]</span>
</span><span id="LibSWMP-206"><a href="#LibSWMP-206"><span class="linenos">206</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_raypath_metadata_from_memory</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-207"><a href="#LibSWMP-207"><span class="linenos">207</span></a>
</span><span id="LibSWMP-208"><a href="#LibSWMP-208"><span class="linenos">208</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_raypath_positions_from_memory</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LibSWMP-209"><a href="#LibSWMP-209"><span class="linenos">209</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># positions</span>
</span><span id="LibSWMP-210"><a href="#LibSWMP-210"><span class="linenos">210</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>  <span class="c1"># total_points</span>
</span><span id="LibSWMP-211"><a href="#LibSWMP-211"><span class="linenos">211</span></a>        <span class="p">]</span>
</span><span id="LibSWMP-212"><a href="#LibSWMP-212"><span class="linenos">212</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">get_raypath_positions_from_memory</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span>
</span><span id="LibSWMP-213"><a href="#LibSWMP-213"><span class="linenos">213</span></a>
</span><span id="LibSWMP-214"><a href="#LibSWMP-214"><span class="linenos">214</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-215"><a href="#LibSWMP-215"><span class="linenos">215</span></a>        <span class="c1"># In-Memory Data Extraction - Wavefronts</span>
</span><span id="LibSWMP-216"><a href="#LibSWMP-216"><span class="linenos">216</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-217"><a href="#LibSWMP-217"><span class="linenos">217</span></a>        <span class="c1"># Note: Wavefront extraction functions not yet implemented in Fortran</span>
</span><span id="LibSWMP-218"><a href="#LibSWMP-218"><span class="linenos">218</span></a>        <span class="c1"># Skip for now to allow basic functionality to work</span>
</span><span id="LibSWMP-219"><a href="#LibSWMP-219"><span class="linenos">219</span></a>        <span class="c1"># TODO: Implement get_wavefront_count_in_memory, etc. in m_swmp.f90</span>
</span><span id="LibSWMP-220"><a href="#LibSWMP-220"><span class="linenos">220</span></a>
</span><span id="LibSWMP-221"><a href="#LibSWMP-221"><span class="linenos">221</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-222"><a href="#LibSWMP-222"><span class="linenos">222</span></a>        <span class="c1"># In-Memory Data Setting - Model, Sources, Receivers (File-Free API)</span>
</span><span id="LibSWMP-223"><a href="#LibSWMP-223"><span class="linenos">223</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-224"><a href="#LibSWMP-224"><span class="linenos">224</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_velocity_model_from_memory</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LibSWMP-225"><a href="#LibSWMP-225"><span class="linenos">225</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">,</span>  <span class="c1"># x0</span>
</span><span id="LibSWMP-226"><a href="#LibSWMP-226"><span class="linenos">226</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">,</span>  <span class="c1"># y0</span>
</span><span id="LibSWMP-227"><a href="#LibSWMP-227"><span class="linenos">227</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>  <span class="c1"># nx</span>
</span><span id="LibSWMP-228"><a href="#LibSWMP-228"><span class="linenos">228</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>  <span class="c1"># ny</span>
</span><span id="LibSWMP-229"><a href="#LibSWMP-229"><span class="linenos">229</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">,</span>  <span class="c1"># dx</span>
</span><span id="LibSWMP-230"><a href="#LibSWMP-230"><span class="linenos">230</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">,</span>  <span class="c1"># dy</span>
</span><span id="LibSWMP-231"><a href="#LibSWMP-231"><span class="linenos">231</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>  <span class="c1"># cn</span>
</span><span id="LibSWMP-232"><a href="#LibSWMP-232"><span class="linenos">232</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;C_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># values</span>
</span><span id="LibSWMP-233"><a href="#LibSWMP-233"><span class="linenos">233</span></a>        <span class="p">]</span>
</span><span id="LibSWMP-234"><a href="#LibSWMP-234"><span class="linenos">234</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_velocity_model_from_memory</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-235"><a href="#LibSWMP-235"><span class="linenos">235</span></a>
</span><span id="LibSWMP-236"><a href="#LibSWMP-236"><span class="linenos">236</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_sources_from_memory</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LibSWMP-237"><a href="#LibSWMP-237"><span class="linenos">237</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>  <span class="c1"># n_sources</span>
</span><span id="LibSWMP-238"><a href="#LibSWMP-238"><span class="linenos">238</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>  <span class="c1"># source_type</span>
</span><span id="LibSWMP-239"><a href="#LibSWMP-239"><span class="linenos">239</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;F_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># positions (Fortran order)</span>
</span><span id="LibSWMP-240"><a href="#LibSWMP-240"><span class="linenos">240</span></a>        <span class="p">]</span>
</span><span id="LibSWMP-241"><a href="#LibSWMP-241"><span class="linenos">241</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_sources_from_memory</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-242"><a href="#LibSWMP-242"><span class="linenos">242</span></a>
</span><span id="LibSWMP-243"><a href="#LibSWMP-243"><span class="linenos">243</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_receivers_from_memory</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LibSWMP-244"><a href="#LibSWMP-244"><span class="linenos">244</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>  <span class="c1"># n_receivers</span>
</span><span id="LibSWMP-245"><a href="#LibSWMP-245"><span class="linenos">245</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">,</span>  <span class="c1"># max_arrivals</span>
</span><span id="LibSWMP-246"><a href="#LibSWMP-246"><span class="linenos">246</span></a>            <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;F_CONTIGUOUS&#39;</span><span class="p">),</span>  <span class="c1"># positions (Fortran order)</span>
</span><span id="LibSWMP-247"><a href="#LibSWMP-247"><span class="linenos">247</span></a>        <span class="p">]</span>
</span><span id="LibSWMP-248"><a href="#LibSWMP-248"><span class="linenos">248</span></a>        <span class="n">lib</span><span class="o">.</span><span class="n">set_receivers_from_memory</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LibSWMP-249"><a href="#LibSWMP-249"><span class="linenos">249</span></a>
</span><span id="LibSWMP-250"><a href="#LibSWMP-250"><span class="linenos">250</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-251"><a href="#LibSWMP-251"><span class="linenos">251</span></a>        <span class="c1"># Jacobian (Frechet Matrix)</span>
</span><span id="LibSWMP-252"><a href="#LibSWMP-252"><span class="linenos">252</span></a>        <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-253"><a href="#LibSWMP-253"><span class="linenos">253</span></a>        <span class="c1"># Note: The existing Jacobian functions use sparse matrix format</span>
</span><span id="LibSWMP-254"><a href="#LibSWMP-254"><span class="linenos">254</span></a>        <span class="c1"># get_sparse_jacobian_size and get_sparse_jacobian exist</span>
</span><span id="LibSWMP-255"><a href="#LibSWMP-255"><span class="linenos">255</span></a>        <span class="c1"># TODO: Implement dense matrix extraction if needed</span>
</span><span id="LibSWMP-256"><a href="#LibSWMP-256"><span class="linenos">256</span></a>
</span><span id="LibSWMP-257"><a href="#LibSWMP-257"><span class="linenos">257</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
</span><span id="LibSWMP-258"><a href="#LibSWMP-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check return status and raise exception if error occurred.</span>
</span><span id="LibSWMP-259"><a href="#LibSWMP-259"><span class="linenos">259</span></a>
</span><span id="LibSWMP-260"><a href="#LibSWMP-260"><span class="linenos">260</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-261"><a href="#LibSWMP-261"><span class="linenos">261</span></a><span class="sd">            status: Return code from library function</span>
</span><span id="LibSWMP-262"><a href="#LibSWMP-262"><span class="linenos">262</span></a>
</span><span id="LibSWMP-263"><a href="#LibSWMP-263"><span class="linenos">263</span></a><span class="sd">        Raises:</span>
</span><span id="LibSWMP-264"><a href="#LibSWMP-264"><span class="linenos">264</span></a><span class="sd">            SWMPError: If status indicates an error</span>
</span><span id="LibSWMP-265"><a href="#LibSWMP-265"><span class="linenos">265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-266"><a href="#LibSWMP-266"><span class="linenos">266</span></a>        <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="n">SWMP_SUCCESS</span><span class="p">:</span>
</span><span id="LibSWMP-267"><a href="#LibSWMP-267"><span class="linenos">267</span></a>            <span class="c1"># Get detailed error message from library</span>
</span><span id="LibSWMP-268"><a href="#LibSWMP-268"><span class="linenos">268</span></a>            <span class="n">error_code</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP-269"><a href="#LibSWMP-269"><span class="linenos">269</span></a>            <span class="n">msg_buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
</span><span id="LibSWMP-270"><a href="#LibSWMP-270"><span class="linenos">270</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_last_error</span><span class="p">(</span>
</span><span id="LibSWMP-271"><a href="#LibSWMP-271"><span class="linenos">271</span></a>                <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">error_code</span><span class="p">),</span>
</span><span id="LibSWMP-272"><a href="#LibSWMP-272"><span class="linenos">272</span></a>                <span class="n">msg_buf</span><span class="p">,</span>
</span><span id="LibSWMP-273"><a href="#LibSWMP-273"><span class="linenos">273</span></a>                <span class="mi">256</span>
</span><span id="LibSWMP-274"><a href="#LibSWMP-274"><span class="linenos">274</span></a>            <span class="p">)</span>
</span><span id="LibSWMP-275"><a href="#LibSWMP-275"><span class="linenos">275</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="n">msg_buf</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="LibSWMP-276"><a href="#LibSWMP-276"><span class="linenos">276</span></a>
</span><span id="LibSWMP-277"><a href="#LibSWMP-277"><span class="linenos">277</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">msg</span><span class="p">:</span>
</span><span id="LibSWMP-278"><a href="#LibSWMP-278"><span class="linenos">278</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unknown error (code </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="LibSWMP-279"><a href="#LibSWMP-279"><span class="linenos">279</span></a>
</span><span id="LibSWMP-280"><a href="#LibSWMP-280"><span class="linenos">280</span></a>            <span class="k">raise</span> <span class="n">SWMPError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SWMP error </span><span class="si">{</span><span class="n">error_code</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="LibSWMP-281"><a href="#LibSWMP-281"><span class="linenos">281</span></a>
</span><span id="LibSWMP-282"><a href="#LibSWMP-282"><span class="linenos">282</span></a>    <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-283"><a href="#LibSWMP-283"><span class="linenos">283</span></a>    <span class="c1"># High-Level Wrappers</span>
</span><span id="LibSWMP-284"><a href="#LibSWMP-284"><span class="linenos">284</span></a>    <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-285"><a href="#LibSWMP-285"><span class="linenos">285</span></a>
</span><span id="LibSWMP-286"><a href="#LibSWMP-286"><span class="linenos">286</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_file</span><span class="p">):</span>
</span><span id="LibSWMP-287"><a href="#LibSWMP-287"><span class="linenos">287</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Read configuration from file.</span>
</span><span id="LibSWMP-288"><a href="#LibSWMP-288"><span class="linenos">288</span></a>
</span><span id="LibSWMP-289"><a href="#LibSWMP-289"><span class="linenos">289</span></a><span class="sd">        This loads everything specified in the config file:</span>
</span><span id="LibSWMP-290"><a href="#LibSWMP-290"><span class="linenos">290</span></a><span class="sd">        model, sources, receivers, and all ray tracing parameters.</span>
</span><span id="LibSWMP-291"><a href="#LibSWMP-291"><span class="linenos">291</span></a>
</span><span id="LibSWMP-292"><a href="#LibSWMP-292"><span class="linenos">292</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-293"><a href="#LibSWMP-293"><span class="linenos">293</span></a><span class="sd">            config_file: Path to configuration file</span>
</span><span id="LibSWMP-294"><a href="#LibSWMP-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-295"><a href="#LibSWMP-295"><span class="linenos">295</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="LibSWMP-296"><a href="#LibSWMP-296"><span class="linenos">296</span></a>            <span class="n">config_file</span> <span class="o">=</span> <span class="n">config_file</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="LibSWMP-297"><a href="#LibSWMP-297"><span class="linenos">297</span></a>        <span class="c1"># rat_read_conf doesn&#39;t return status, but we can check for exceptions</span>
</span><span id="LibSWMP-298"><a href="#LibSWMP-298"><span class="linenos">298</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="LibSWMP-299"><a href="#LibSWMP-299"><span class="linenos">299</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">rat_read_conf</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">config_file</span><span class="p">))</span>
</span><span id="LibSWMP-300"><a href="#LibSWMP-300"><span class="linenos">300</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="LibSWMP-301"><a href="#LibSWMP-301"><span class="linenos">301</span></a>            <span class="k">raise</span> <span class="n">SWMPError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to read configuration: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="LibSWMP-302"><a href="#LibSWMP-302"><span class="linenos">302</span></a>
</span><span id="LibSWMP-303"><a href="#LibSWMP-303"><span class="linenos">303</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LibSWMP-304"><a href="#LibSWMP-304"><span class="linenos">304</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run forward modeling for all sources (sequential).</span>
</span><span id="LibSWMP-305"><a href="#LibSWMP-305"><span class="linenos">305</span></a>
</span><span id="LibSWMP-306"><a href="#LibSWMP-306"><span class="linenos">306</span></a><span class="sd">        This is the backward-compatible sequential execution path.</span>
</span><span id="LibSWMP-307"><a href="#LibSWMP-307"><span class="linenos">307</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-308"><a href="#LibSWMP-308"><span class="linenos">308</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</span><span id="LibSWMP-309"><a href="#LibSWMP-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP-310"><a href="#LibSWMP-310"><span class="linenos">310</span></a>
</span><span id="LibSWMP-311"><a href="#LibSWMP-311"><span class="linenos">311</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_single_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
</span><span id="LibSWMP-312"><a href="#LibSWMP-312"><span class="linenos">312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run forward modeling for a single source.</span>
</span><span id="LibSWMP-313"><a href="#LibSWMP-313"><span class="linenos">313</span></a>
</span><span id="LibSWMP-314"><a href="#LibSWMP-314"><span class="linenos">314</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-315"><a href="#LibSWMP-315"><span class="linenos">315</span></a><span class="sd">            source_id: Source ID (1-based indexing)</span>
</span><span id="LibSWMP-316"><a href="#LibSWMP-316"><span class="linenos">316</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-317"><a href="#LibSWMP-317"><span class="linenos">317</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">forward_single_source</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">source_id</span><span class="p">))</span>
</span><span id="LibSWMP-318"><a href="#LibSWMP-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP-319"><a href="#LibSWMP-319"><span class="linenos">319</span></a>
</span><span id="LibSWMP-320"><a href="#LibSWMP-320"><span class="linenos">320</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_n_sources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LibSWMP-321"><a href="#LibSWMP-321"><span class="linenos">321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get number of sources.</span>
</span><span id="LibSWMP-322"><a href="#LibSWMP-322"><span class="linenos">322</span></a>
</span><span id="LibSWMP-323"><a href="#LibSWMP-323"><span class="linenos">323</span></a><span class="sd">        Returns:</span>
</span><span id="LibSWMP-324"><a href="#LibSWMP-324"><span class="linenos">324</span></a><span class="sd">            Number of sources</span>
</span><span id="LibSWMP-325"><a href="#LibSWMP-325"><span class="linenos">325</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-326"><a href="#LibSWMP-326"><span class="linenos">326</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP-327"><a href="#LibSWMP-327"><span class="linenos">327</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_number_of_sources</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="LibSWMP-328"><a href="#LibSWMP-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP-329"><a href="#LibSWMP-329"><span class="linenos">329</span></a>        <span class="k">return</span> <span class="n">n</span><span class="o">.</span><span class="n">value</span>
</span><span id="LibSWMP-330"><a href="#LibSWMP-330"><span class="linenos">330</span></a>
</span><span id="LibSWMP-331"><a href="#LibSWMP-331"><span class="linenos">331</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_file_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable</span><span class="p">):</span>
</span><span id="LibSWMP-332"><a href="#LibSWMP-332"><span class="linenos">332</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Enable or disable file output.</span>
</span><span id="LibSWMP-333"><a href="#LibSWMP-333"><span class="linenos">333</span></a>
</span><span id="LibSWMP-334"><a href="#LibSWMP-334"><span class="linenos">334</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-335"><a href="#LibSWMP-335"><span class="linenos">335</span></a><span class="sd">            enable: True to enable file output, False for memory-only</span>
</span><span id="LibSWMP-336"><a href="#LibSWMP-336"><span class="linenos">336</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-337"><a href="#LibSWMP-337"><span class="linenos">337</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_enable_file_output</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">enable</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="LibSWMP-338"><a href="#LibSWMP-338"><span class="linenos">338</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP-339"><a href="#LibSWMP-339"><span class="linenos">339</span></a>
</span><span id="LibSWMP-340"><a href="#LibSWMP-340"><span class="linenos">340</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_arrivals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
</span><span id="LibSWMP-341"><a href="#LibSWMP-341"><span class="linenos">341</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract arrival data from memory for given source.</span>
</span><span id="LibSWMP-342"><a href="#LibSWMP-342"><span class="linenos">342</span></a>
</span><span id="LibSWMP-343"><a href="#LibSWMP-343"><span class="linenos">343</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-344"><a href="#LibSWMP-344"><span class="linenos">344</span></a><span class="sd">            source_id: Source ID for which arrivals were computed</span>
</span><span id="LibSWMP-345"><a href="#LibSWMP-345"><span class="linenos">345</span></a>
</span><span id="LibSWMP-346"><a href="#LibSWMP-346"><span class="linenos">346</span></a><span class="sd">        Returns:</span>
</span><span id="LibSWMP-347"><a href="#LibSWMP-347"><span class="linenos">347</span></a><span class="sd">            Tuple of (source_ids, receiver_ids, arrival_nums, times, azimuths, spreading_factors)</span>
</span><span id="LibSWMP-348"><a href="#LibSWMP-348"><span class="linenos">348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-349"><a href="#LibSWMP-349"><span class="linenos">349</span></a>        <span class="c1"># Get count</span>
</span><span id="LibSWMP-350"><a href="#LibSWMP-350"><span class="linenos">350</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP-351"><a href="#LibSWMP-351"><span class="linenos">351</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_number_of_arrivals_in_memory</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="LibSWMP-352"><a href="#LibSWMP-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP-353"><a href="#LibSWMP-353"><span class="linenos">353</span></a>
</span><span id="LibSWMP-354"><a href="#LibSWMP-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LibSWMP-355"><a href="#LibSWMP-355"><span class="linenos">355</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="LibSWMP-356"><a href="#LibSWMP-356"><span class="linenos">356</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>  <span class="c1"># source_ids</span>
</span><span id="LibSWMP-357"><a href="#LibSWMP-357"><span class="linenos">357</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>  <span class="c1"># receiver_ids</span>
</span><span id="LibSWMP-358"><a href="#LibSWMP-358"><span class="linenos">358</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>  <span class="c1"># arrival_nums</span>
</span><span id="LibSWMP-359"><a href="#LibSWMP-359"><span class="linenos">359</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>  <span class="c1"># times</span>
</span><span id="LibSWMP-360"><a href="#LibSWMP-360"><span class="linenos">360</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>  <span class="c1"># azimuths</span>
</span><span id="LibSWMP-361"><a href="#LibSWMP-361"><span class="linenos">361</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>  <span class="c1"># spreading</span>
</span><span id="LibSWMP-362"><a href="#LibSWMP-362"><span class="linenos">362</span></a>            <span class="p">)</span>
</span><span id="LibSWMP-363"><a href="#LibSWMP-363"><span class="linenos">363</span></a>
</span><span id="LibSWMP-364"><a href="#LibSWMP-364"><span class="linenos">364</span></a>        <span class="c1"># Allocate arrays</span>
</span><span id="LibSWMP-365"><a href="#LibSWMP-365"><span class="linenos">365</span></a>        <span class="n">receivers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP-366"><a href="#LibSWMP-366"><span class="linenos">366</span></a>        <span class="n">arrival_nums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP-367"><a href="#LibSWMP-367"><span class="linenos">367</span></a>        <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP-368"><a href="#LibSWMP-368"><span class="linenos">368</span></a>        <span class="n">azimuths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP-369"><a href="#LibSWMP-369"><span class="linenos">369</span></a>        <span class="n">spreading</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP-370"><a href="#LibSWMP-370"><span class="linenos">370</span></a>
</span><span id="LibSWMP-371"><a href="#LibSWMP-371"><span class="linenos">371</span></a>        <span class="c1"># Extract data</span>
</span><span id="LibSWMP-372"><a href="#LibSWMP-372"><span class="linenos">372</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_arrivals_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP-373"><a href="#LibSWMP-373"><span class="linenos">373</span></a>            <span class="n">receivers</span><span class="p">,</span> <span class="n">arrival_nums</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">azimuths</span><span class="p">,</span> <span class="n">spreading</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">value</span>
</span><span id="LibSWMP-374"><a href="#LibSWMP-374"><span class="linenos">374</span></a>        <span class="p">)</span>
</span><span id="LibSWMP-375"><a href="#LibSWMP-375"><span class="linenos">375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP-376"><a href="#LibSWMP-376"><span class="linenos">376</span></a>
</span><span id="LibSWMP-377"><a href="#LibSWMP-377"><span class="linenos">377</span></a>        <span class="c1"># Add source_id to all arrivals</span>
</span><span id="LibSWMP-378"><a href="#LibSWMP-378"><span class="linenos">378</span></a>        <span class="n">source_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">source_id</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP-379"><a href="#LibSWMP-379"><span class="linenos">379</span></a>
</span><span id="LibSWMP-380"><a href="#LibSWMP-380"><span class="linenos">380</span></a>        <span class="k">return</span> <span class="n">source_ids</span><span class="p">,</span> <span class="n">receivers</span><span class="p">,</span> <span class="n">arrival_nums</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">azimuths</span><span class="p">,</span> <span class="n">spreading</span>
</span><span id="LibSWMP-381"><a href="#LibSWMP-381"><span class="linenos">381</span></a>
</span><span id="LibSWMP-382"><a href="#LibSWMP-382"><span class="linenos">382</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_raypaths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
</span><span id="LibSWMP-383"><a href="#LibSWMP-383"><span class="linenos">383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract raypath data from memory for given source.</span>
</span><span id="LibSWMP-384"><a href="#LibSWMP-384"><span class="linenos">384</span></a>
</span><span id="LibSWMP-385"><a href="#LibSWMP-385"><span class="linenos">385</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-386"><a href="#LibSWMP-386"><span class="linenos">386</span></a><span class="sd">            source_id: Source ID for which raypaths were computed</span>
</span><span id="LibSWMP-387"><a href="#LibSWMP-387"><span class="linenos">387</span></a>
</span><span id="LibSWMP-388"><a href="#LibSWMP-388"><span class="linenos">388</span></a><span class="sd">        Returns:</span>
</span><span id="LibSWMP-389"><a href="#LibSWMP-389"><span class="linenos">389</span></a><span class="sd">            List of dicts with keys: source, receiver, arrival, path (ndarray)</span>
</span><span id="LibSWMP-390"><a href="#LibSWMP-390"><span class="linenos">390</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-391"><a href="#LibSWMP-391"><span class="linenos">391</span></a>        <span class="c1"># Get counts</span>
</span><span id="LibSWMP-392"><a href="#LibSWMP-392"><span class="linenos">392</span></a>        <span class="n">n_paths</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP-393"><a href="#LibSWMP-393"><span class="linenos">393</span></a>        <span class="n">total_pts</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP-394"><a href="#LibSWMP-394"><span class="linenos">394</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_raypath_count_in_memory</span><span class="p">(</span>
</span><span id="LibSWMP-395"><a href="#LibSWMP-395"><span class="linenos">395</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">n_paths</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">total_pts</span><span class="p">)</span>
</span><span id="LibSWMP-396"><a href="#LibSWMP-396"><span class="linenos">396</span></a>        <span class="p">)</span>
</span><span id="LibSWMP-397"><a href="#LibSWMP-397"><span class="linenos">397</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP-398"><a href="#LibSWMP-398"><span class="linenos">398</span></a>
</span><span id="LibSWMP-399"><a href="#LibSWMP-399"><span class="linenos">399</span></a>        <span class="k">if</span> <span class="n">n_paths</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LibSWMP-400"><a href="#LibSWMP-400"><span class="linenos">400</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="LibSWMP-401"><a href="#LibSWMP-401"><span class="linenos">401</span></a>
</span><span id="LibSWMP-402"><a href="#LibSWMP-402"><span class="linenos">402</span></a>        <span class="c1"># Get metadata</span>
</span><span id="LibSWMP-403"><a href="#LibSWMP-403"><span class="linenos">403</span></a>        <span class="n">receivers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_paths</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP-404"><a href="#LibSWMP-404"><span class="linenos">404</span></a>        <span class="n">arrival_nums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_paths</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP-405"><a href="#LibSWMP-405"><span class="linenos">405</span></a>        <span class="n">npts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_paths</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP-406"><a href="#LibSWMP-406"><span class="linenos">406</span></a>
</span><span id="LibSWMP-407"><a href="#LibSWMP-407"><span class="linenos">407</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_raypath_metadata_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP-408"><a href="#LibSWMP-408"><span class="linenos">408</span></a>            <span class="n">receivers</span><span class="p">,</span> <span class="n">arrival_nums</span><span class="p">,</span> <span class="n">npts</span><span class="p">,</span> <span class="n">n_paths</span><span class="o">.</span><span class="n">value</span>
</span><span id="LibSWMP-409"><a href="#LibSWMP-409"><span class="linenos">409</span></a>        <span class="p">)</span>
</span><span id="LibSWMP-410"><a href="#LibSWMP-410"><span class="linenos">410</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP-411"><a href="#LibSWMP-411"><span class="linenos">411</span></a>
</span><span id="LibSWMP-412"><a href="#LibSWMP-412"><span class="linenos">412</span></a>        <span class="c1"># Get positions (flattened)</span>
</span><span id="LibSWMP-413"><a href="#LibSWMP-413"><span class="linenos">413</span></a>        <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">total_pts</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP-414"><a href="#LibSWMP-414"><span class="linenos">414</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_raypath_positions_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP-415"><a href="#LibSWMP-415"><span class="linenos">415</span></a>            <span class="n">positions</span><span class="p">,</span> <span class="n">total_pts</span><span class="o">.</span><span class="n">value</span>
</span><span id="LibSWMP-416"><a href="#LibSWMP-416"><span class="linenos">416</span></a>        <span class="p">)</span>
</span><span id="LibSWMP-417"><a href="#LibSWMP-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP-418"><a href="#LibSWMP-418"><span class="linenos">418</span></a>
</span><span id="LibSWMP-419"><a href="#LibSWMP-419"><span class="linenos">419</span></a>        <span class="c1"># Reconstruct raypaths</span>
</span><span id="LibSWMP-420"><a href="#LibSWMP-420"><span class="linenos">420</span></a>        <span class="n">raypaths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LibSWMP-421"><a href="#LibSWMP-421"><span class="linenos">421</span></a>        <span class="n">pos_idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="LibSWMP-422"><a href="#LibSWMP-422"><span class="linenos">422</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_paths</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
</span><span id="LibSWMP-423"><a href="#LibSWMP-423"><span class="linenos">423</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">npts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="LibSWMP-424"><a href="#LibSWMP-424"><span class="linenos">424</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">pos_idx</span><span class="o">*</span><span class="mi">2</span><span class="p">:(</span><span class="n">pos_idx</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="LibSWMP-425"><a href="#LibSWMP-425"><span class="linenos">425</span></a>            <span class="n">raypaths</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="LibSWMP-426"><a href="#LibSWMP-426"><span class="linenos">426</span></a>                <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">source_id</span><span class="p">,</span>
</span><span id="LibSWMP-427"><a href="#LibSWMP-427"><span class="linenos">427</span></a>                <span class="s1">&#39;receiver&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">receivers</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="LibSWMP-428"><a href="#LibSWMP-428"><span class="linenos">428</span></a>                <span class="s1">&#39;arrival&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">arrival_nums</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="LibSWMP-429"><a href="#LibSWMP-429"><span class="linenos">429</span></a>                <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
</span><span id="LibSWMP-430"><a href="#LibSWMP-430"><span class="linenos">430</span></a>            <span class="p">})</span>
</span><span id="LibSWMP-431"><a href="#LibSWMP-431"><span class="linenos">431</span></a>            <span class="n">pos_idx</span> <span class="o">+=</span> <span class="n">n</span>
</span><span id="LibSWMP-432"><a href="#LibSWMP-432"><span class="linenos">432</span></a>
</span><span id="LibSWMP-433"><a href="#LibSWMP-433"><span class="linenos">433</span></a>        <span class="k">return</span> <span class="n">raypaths</span>
</span><span id="LibSWMP-434"><a href="#LibSWMP-434"><span class="linenos">434</span></a>
</span><span id="LibSWMP-435"><a href="#LibSWMP-435"><span class="linenos">435</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_wavefronts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
</span><span id="LibSWMP-436"><a href="#LibSWMP-436"><span class="linenos">436</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract wavefront data from memory for given source.</span>
</span><span id="LibSWMP-437"><a href="#LibSWMP-437"><span class="linenos">437</span></a>
</span><span id="LibSWMP-438"><a href="#LibSWMP-438"><span class="linenos">438</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-439"><a href="#LibSWMP-439"><span class="linenos">439</span></a><span class="sd">            source_id: Source ID for which wavefronts were computed</span>
</span><span id="LibSWMP-440"><a href="#LibSWMP-440"><span class="linenos">440</span></a>
</span><span id="LibSWMP-441"><a href="#LibSWMP-441"><span class="linenos">441</span></a><span class="sd">        Returns:</span>
</span><span id="LibSWMP-442"><a href="#LibSWMP-442"><span class="linenos">442</span></a><span class="sd">            List of wavefront arrays (each is ndarray of shape (n, 2))</span>
</span><span id="LibSWMP-443"><a href="#LibSWMP-443"><span class="linenos">443</span></a>
</span><span id="LibSWMP-444"><a href="#LibSWMP-444"><span class="linenos">444</span></a><span class="sd">        Note:</span>
</span><span id="LibSWMP-445"><a href="#LibSWMP-445"><span class="linenos">445</span></a><span class="sd">            Wavefront extraction not yet implemented in Fortran.</span>
</span><span id="LibSWMP-446"><a href="#LibSWMP-446"><span class="linenos">446</span></a><span class="sd">            This method always returns an empty list.</span>
</span><span id="LibSWMP-447"><a href="#LibSWMP-447"><span class="linenos">447</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-448"><a href="#LibSWMP-448"><span class="linenos">448</span></a>        <span class="c1"># TODO: Implement wavefront extraction functions in m_swmp.f90</span>
</span><span id="LibSWMP-449"><a href="#LibSWMP-449"><span class="linenos">449</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="LibSWMP-450"><a href="#LibSWMP-450"><span class="linenos">450</span></a>
</span><span id="LibSWMP-451"><a href="#LibSWMP-451"><span class="linenos">451</span></a>    <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-452"><a href="#LibSWMP-452"><span class="linenos">452</span></a>    <span class="c1"># Parameter Configuration Methods</span>
</span><span id="LibSWMP-453"><a href="#LibSWMP-453"><span class="linenos">453</span></a>    <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-454"><a href="#LibSWMP-454"><span class="linenos">454</span></a>
</span><span id="LibSWMP-455"><a href="#LibSWMP-455"><span class="linenos">455</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_dt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
</span><span id="LibSWMP-456"><a href="#LibSWMP-456"><span class="linenos">456</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set ODE solver time step.</span>
</span><span id="LibSWMP-457"><a href="#LibSWMP-457"><span class="linenos">457</span></a>
</span><span id="LibSWMP-458"><a href="#LibSWMP-458"><span class="linenos">458</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-459"><a href="#LibSWMP-459"><span class="linenos">459</span></a><span class="sd">            dt: Time step size</span>
</span><span id="LibSWMP-460"><a href="#LibSWMP-460"><span class="linenos">460</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-461"><a href="#LibSWMP-461"><span class="linenos">461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">dt</span><span class="p">))</span>
</span><span id="LibSWMP-462"><a href="#LibSWMP-462"><span class="linenos">462</span></a>
</span><span id="LibSWMP-463"><a href="#LibSWMP-463"><span class="linenos">463</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_max_iterations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxit</span><span class="p">):</span>
</span><span id="LibSWMP-464"><a href="#LibSWMP-464"><span class="linenos">464</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set maximum number of iterations.</span>
</span><span id="LibSWMP-465"><a href="#LibSWMP-465"><span class="linenos">465</span></a>
</span><span id="LibSWMP-466"><a href="#LibSWMP-466"><span class="linenos">466</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-467"><a href="#LibSWMP-467"><span class="linenos">467</span></a><span class="sd">            maxit: Maximum iterations</span>
</span><span id="LibSWMP-468"><a href="#LibSWMP-468"><span class="linenos">468</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-469"><a href="#LibSWMP-469"><span class="linenos">469</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_maxit</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">maxit</span><span class="p">))</span>
</span><span id="LibSWMP-470"><a href="#LibSWMP-470"><span class="linenos">470</span></a>
</span><span id="LibSWMP-471"><a href="#LibSWMP-471"><span class="linenos">471</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_n_bichar_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsenod</span><span class="p">):</span>
</span><span id="LibSWMP-472"><a href="#LibSWMP-472"><span class="linenos">472</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set number of nodes on bicharacteristic strip.</span>
</span><span id="LibSWMP-473"><a href="#LibSWMP-473"><span class="linenos">473</span></a>
</span><span id="LibSWMP-474"><a href="#LibSWMP-474"><span class="linenos">474</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-475"><a href="#LibSWMP-475"><span class="linenos">475</span></a><span class="sd">            nsenod: Number of nodes</span>
</span><span id="LibSWMP-476"><a href="#LibSWMP-476"><span class="linenos">476</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-477"><a href="#LibSWMP-477"><span class="linenos">477</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_nsenod</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">nsenod</span><span class="p">))</span>
</span><span id="LibSWMP-478"><a href="#LibSWMP-478"><span class="linenos">478</span></a>
</span><span id="LibSWMP-479"><a href="#LibSWMP-479"><span class="linenos">479</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_computation_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
</span><span id="LibSWMP-480"><a href="#LibSWMP-480"><span class="linenos">480</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set computation mode.</span>
</span><span id="LibSWMP-481"><a href="#LibSWMP-481"><span class="linenos">481</span></a>
</span><span id="LibSWMP-482"><a href="#LibSWMP-482"><span class="linenos">482</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-483"><a href="#LibSWMP-483"><span class="linenos">483</span></a><span class="sd">            mode: Computation mode</span>
</span><span id="LibSWMP-484"><a href="#LibSWMP-484"><span class="linenos">484</span></a><span class="sd">                1 = Kinematic ray tracing only</span>
</span><span id="LibSWMP-485"><a href="#LibSWMP-485"><span class="linenos">485</span></a><span class="sd">                2 = Kinematic ray tracing + spreading factors</span>
</span><span id="LibSWMP-486"><a href="#LibSWMP-486"><span class="linenos">486</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-487"><a href="#LibSWMP-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
</span><span id="LibSWMP-488"><a href="#LibSWMP-488"><span class="linenos">488</span></a>
</span><span id="LibSWMP-489"><a href="#LibSWMP-489"><span class="linenos">489</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_ode_solver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solver</span><span class="p">):</span>
</span><span id="LibSWMP-490"><a href="#LibSWMP-490"><span class="linenos">490</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set ODE solver type.</span>
</span><span id="LibSWMP-491"><a href="#LibSWMP-491"><span class="linenos">491</span></a>
</span><span id="LibSWMP-492"><a href="#LibSWMP-492"><span class="linenos">492</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-493"><a href="#LibSWMP-493"><span class="linenos">493</span></a><span class="sd">            solver: Solver type</span>
</span><span id="LibSWMP-494"><a href="#LibSWMP-494"><span class="linenos">494</span></a><span class="sd">                1 = 4th order Runge-Kutta</span>
</span><span id="LibSWMP-495"><a href="#LibSWMP-495"><span class="linenos">495</span></a><span class="sd">                2 = 5th order Runge-Kutta</span>
</span><span id="LibSWMP-496"><a href="#LibSWMP-496"><span class="linenos">496</span></a><span class="sd">                3 = 5th order adaptive Runge-Kutta</span>
</span><span id="LibSWMP-497"><a href="#LibSWMP-497"><span class="linenos">497</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-498"><a href="#LibSWMP-498"><span class="linenos">498</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_solver</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
</span><span id="LibSWMP-499"><a href="#LibSWMP-499"><span class="linenos">499</span></a>
</span><span id="LibSWMP-500"><a href="#LibSWMP-500"><span class="linenos">500</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="p">):</span>
</span><span id="LibSWMP-501"><a href="#LibSWMP-501"><span class="linenos">501</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set velocity interpolation method.</span>
</span><span id="LibSWMP-502"><a href="#LibSWMP-502"><span class="linenos">502</span></a>
</span><span id="LibSWMP-503"><a href="#LibSWMP-503"><span class="linenos">503</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-504"><a href="#LibSWMP-504"><span class="linenos">504</span></a><span class="sd">            interp: Interpolation method</span>
</span><span id="LibSWMP-505"><a href="#LibSWMP-505"><span class="linenos">505</span></a><span class="sd">                1 = Linear interpolation</span>
</span><span id="LibSWMP-506"><a href="#LibSWMP-506"><span class="linenos">506</span></a><span class="sd">                2 = Weighted average</span>
</span><span id="LibSWMP-507"><a href="#LibSWMP-507"><span class="linenos">507</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-508"><a href="#LibSWMP-508"><span class="linenos">508</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_interp</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">interp</span><span class="p">))</span>
</span><span id="LibSWMP-509"><a href="#LibSWMP-509"><span class="linenos">509</span></a>
</span><span id="LibSWMP-510"><a href="#LibSWMP-510"><span class="linenos">510</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_max_arrivals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mar</span><span class="p">):</span>
</span><span id="LibSWMP-511"><a href="#LibSWMP-511"><span class="linenos">511</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set maximum number of arrivals per receiver.</span>
</span><span id="LibSWMP-512"><a href="#LibSWMP-512"><span class="linenos">512</span></a>
</span><span id="LibSWMP-513"><a href="#LibSWMP-513"><span class="linenos">513</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-514"><a href="#LibSWMP-514"><span class="linenos">514</span></a><span class="sd">            mar: Maximum number of arrivals</span>
</span><span id="LibSWMP-515"><a href="#LibSWMP-515"><span class="linenos">515</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-516"><a href="#LibSWMP-516"><span class="linenos">516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_mar</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">mar</span><span class="p">))</span>
</span><span id="LibSWMP-517"><a href="#LibSWMP-517"><span class="linenos">517</span></a>
</span><span id="LibSWMP-518"><a href="#LibSWMP-518"><span class="linenos">518</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_coordinate_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">velint</span><span class="p">):</span>
</span><span id="LibSWMP-519"><a href="#LibSWMP-519"><span class="linenos">519</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set coordinate system type.</span>
</span><span id="LibSWMP-520"><a href="#LibSWMP-520"><span class="linenos">520</span></a>
</span><span id="LibSWMP-521"><a href="#LibSWMP-521"><span class="linenos">521</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-522"><a href="#LibSWMP-522"><span class="linenos">522</span></a><span class="sd">            velint: Coordinate system</span>
</span><span id="LibSWMP-523"><a href="#LibSWMP-523"><span class="linenos">523</span></a><span class="sd">                1 = Cartesian cubic B-splines</span>
</span><span id="LibSWMP-524"><a href="#LibSWMP-524"><span class="linenos">524</span></a><span class="sd">                2 = Spherical splines</span>
</span><span id="LibSWMP-525"><a href="#LibSWMP-525"><span class="linenos">525</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-526"><a href="#LibSWMP-526"><span class="linenos">526</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_velint</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">velint</span><span class="p">))</span>
</span><span id="LibSWMP-527"><a href="#LibSWMP-527"><span class="linenos">527</span></a>
</span><span id="LibSWMP-528"><a href="#LibSWMP-528"><span class="linenos">528</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_earth_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rearth</span><span class="p">):</span>
</span><span id="LibSWMP-529"><a href="#LibSWMP-529"><span class="linenos">529</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set Earth radius for spherical coordinates.</span>
</span><span id="LibSWMP-530"><a href="#LibSWMP-530"><span class="linenos">530</span></a>
</span><span id="LibSWMP-531"><a href="#LibSWMP-531"><span class="linenos">531</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-532"><a href="#LibSWMP-532"><span class="linenos">532</span></a><span class="sd">            rearth: Earth radius in km (default: 6371.0)</span>
</span><span id="LibSWMP-533"><a href="#LibSWMP-533"><span class="linenos">533</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-534"><a href="#LibSWMP-534"><span class="linenos">534</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_rearth</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">rearth</span><span class="p">))</span>
</span><span id="LibSWMP-535"><a href="#LibSWMP-535"><span class="linenos">535</span></a>
</span><span id="LibSWMP-536"><a href="#LibSWMP-536"><span class="linenos">536</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
</span><span id="LibSWMP-537"><a href="#LibSWMP-537"><span class="linenos">537</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply TrackerOptions to configure all parameters.</span>
</span><span id="LibSWMP-538"><a href="#LibSWMP-538"><span class="linenos">538</span></a>
</span><span id="LibSWMP-539"><a href="#LibSWMP-539"><span class="linenos">539</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-540"><a href="#LibSWMP-540"><span class="linenos">540</span></a><span class="sd">            options: TrackerOptions instance with configuration</span>
</span><span id="LibSWMP-541"><a href="#LibSWMP-541"><span class="linenos">541</span></a>
</span><span id="LibSWMP-542"><a href="#LibSWMP-542"><span class="linenos">542</span></a><span class="sd">        Example:</span>
</span><span id="LibSWMP-543"><a href="#LibSWMP-543"><span class="linenos">543</span></a><span class="sd">            &gt;&gt;&gt; lib = LibSWMP()</span>
</span><span id="LibSWMP-544"><a href="#LibSWMP-544"><span class="linenos">544</span></a><span class="sd">            &gt;&gt;&gt; opts = TrackerOptions(dt=2.0, max_iterations=1000)</span>
</span><span id="LibSWMP-545"><a href="#LibSWMP-545"><span class="linenos">545</span></a><span class="sd">            &gt;&gt;&gt; lib.apply_options(opts)</span>
</span><span id="LibSWMP-546"><a href="#LibSWMP-546"><span class="linenos">546</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-547"><a href="#LibSWMP-547"><span class="linenos">547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
</span><span id="LibSWMP-548"><a href="#LibSWMP-548"><span class="linenos">548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_max_iterations</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">)</span>
</span><span id="LibSWMP-549"><a href="#LibSWMP-549"><span class="linenos">549</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_n_bichar_nodes</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">n_bichar_nodes</span><span class="p">)</span>
</span><span id="LibSWMP-550"><a href="#LibSWMP-550"><span class="linenos">550</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_computation_mode</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">computation_mode</span><span class="p">)</span>
</span><span id="LibSWMP-551"><a href="#LibSWMP-551"><span class="linenos">551</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_ode_solver</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">ode_solver</span><span class="p">)</span>
</span><span id="LibSWMP-552"><a href="#LibSWMP-552"><span class="linenos">552</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_interpolator</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">interpolator</span><span class="p">)</span>
</span><span id="LibSWMP-553"><a href="#LibSWMP-553"><span class="linenos">553</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_max_arrivals</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">max_arrivals</span><span class="p">)</span>
</span><span id="LibSWMP-554"><a href="#LibSWMP-554"><span class="linenos">554</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_coordinate_system</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">coordinate_system</span><span class="p">)</span>
</span><span id="LibSWMP-555"><a href="#LibSWMP-555"><span class="linenos">555</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_earth_radius</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">earth_radius</span><span class="p">)</span>
</span><span id="LibSWMP-556"><a href="#LibSWMP-556"><span class="linenos">556</span></a>
</span><span id="LibSWMP-557"><a href="#LibSWMP-557"><span class="linenos">557</span></a>    <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-558"><a href="#LibSWMP-558"><span class="linenos">558</span></a>    <span class="c1"># Model, Sources, Receivers Configuration</span>
</span><span id="LibSWMP-559"><a href="#LibSWMP-559"><span class="linenos">559</span></a>    <span class="c1"># ================================================================</span>
</span><span id="LibSWMP-560"><a href="#LibSWMP-560"><span class="linenos">560</span></a>
</span><span id="LibSWMP-561"><a href="#LibSWMP-561"><span class="linenos">561</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_velocity_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
</span><span id="LibSWMP-562"><a href="#LibSWMP-562"><span class="linenos">562</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set velocity model from VelocityModel2D object.</span>
</span><span id="LibSWMP-563"><a href="#LibSWMP-563"><span class="linenos">563</span></a>
</span><span id="LibSWMP-564"><a href="#LibSWMP-564"><span class="linenos">564</span></a><span class="sd">        This uses the new file-free API that initializes the complete</span>
</span><span id="LibSWMP-565"><a href="#LibSWMP-565"><span class="linenos">565</span></a><span class="sd">        velocity model structure in memory.</span>
</span><span id="LibSWMP-566"><a href="#LibSWMP-566"><span class="linenos">566</span></a>
</span><span id="LibSWMP-567"><a href="#LibSWMP-567"><span class="linenos">567</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-568"><a href="#LibSWMP-568"><span class="linenos">568</span></a><span class="sd">            model: VelocityModel2D instance</span>
</span><span id="LibSWMP-569"><a href="#LibSWMP-569"><span class="linenos">569</span></a>
</span><span id="LibSWMP-570"><a href="#LibSWMP-570"><span class="linenos">570</span></a><span class="sd">        Example:</span>
</span><span id="LibSWMP-571"><a href="#LibSWMP-571"><span class="linenos">571</span></a><span class="sd">            &gt;&gt;&gt; from pyswmp.data import VelocityModel2D</span>
</span><span id="LibSWMP-572"><a href="#LibSWMP-572"><span class="linenos">572</span></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
</span><span id="LibSWMP-573"><a href="#LibSWMP-573"><span class="linenos">573</span></a><span class="sd">            &gt;&gt;&gt; velocities = np.full((100, 80), 3.5, dtype=np.float32)</span>
</span><span id="LibSWMP-574"><a href="#LibSWMP-574"><span class="linenos">574</span></a><span class="sd">            &gt;&gt;&gt; model = VelocityModel2D(velocities, 110.0, -45.0, 0.5, 0.5)</span>
</span><span id="LibSWMP-575"><a href="#LibSWMP-575"><span class="linenos">575</span></a><span class="sd">            &gt;&gt;&gt; lib.set_velocity_model(model)</span>
</span><span id="LibSWMP-576"><a href="#LibSWMP-576"><span class="linenos">576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-577"><a href="#LibSWMP-577"><span class="linenos">577</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">VelocityModel2D</span>
</span><span id="LibSWMP-578"><a href="#LibSWMP-578"><span class="linenos">578</span></a>
</span><span id="LibSWMP-579"><a href="#LibSWMP-579"><span class="linenos">579</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">VelocityModel2D</span><span class="p">):</span>
</span><span id="LibSWMP-580"><a href="#LibSWMP-580"><span class="linenos">580</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;model must be a VelocityModel2D instance&quot;</span><span class="p">)</span>
</span><span id="LibSWMP-581"><a href="#LibSWMP-581"><span class="linenos">581</span></a>
</span><span id="LibSWMP-582"><a href="#LibSWMP-582"><span class="linenos">582</span></a>        <span class="c1"># Ensure velocities are float32</span>
</span><span id="LibSWMP-583"><a href="#LibSWMP-583"><span class="linenos">583</span></a>        <span class="n">velocities</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP-584"><a href="#LibSWMP-584"><span class="linenos">584</span></a>
</span><span id="LibSWMP-585"><a href="#LibSWMP-585"><span class="linenos">585</span></a>        <span class="c1"># Add cushion nodes if needed</span>
</span><span id="LibSWMP-586"><a href="#LibSWMP-586"><span class="linenos">586</span></a>        <span class="c1"># Fortran expects array of size (nx+2*cn, ny+2*cn)</span>
</span><span id="LibSWMP-587"><a href="#LibSWMP-587"><span class="linenos">587</span></a>        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">cushion_nodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LibSWMP-588"><a href="#LibSWMP-588"><span class="linenos">588</span></a>            <span class="c1"># Pad with edge replication</span>
</span><span id="LibSWMP-589"><a href="#LibSWMP-589"><span class="linenos">589</span></a>            <span class="n">padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
</span><span id="LibSWMP-590"><a href="#LibSWMP-590"><span class="linenos">590</span></a>                <span class="n">velocities</span><span class="p">,</span>
</span><span id="LibSWMP-591"><a href="#LibSWMP-591"><span class="linenos">591</span></a>                <span class="n">pad_width</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">cushion_nodes</span><span class="p">,</span>
</span><span id="LibSWMP-592"><a href="#LibSWMP-592"><span class="linenos">592</span></a>                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span>
</span><span id="LibSWMP-593"><a href="#LibSWMP-593"><span class="linenos">593</span></a>            <span class="p">)</span>
</span><span id="LibSWMP-594"><a href="#LibSWMP-594"><span class="linenos">594</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LibSWMP-595"><a href="#LibSWMP-595"><span class="linenos">595</span></a>            <span class="n">padded</span> <span class="o">=</span> <span class="n">velocities</span>
</span><span id="LibSWMP-596"><a href="#LibSWMP-596"><span class="linenos">596</span></a>
</span><span id="LibSWMP-597"><a href="#LibSWMP-597"><span class="linenos">597</span></a>        <span class="c1"># Flatten velocity array in Fortran order (column-major)</span>
</span><span id="LibSWMP-598"><a href="#LibSWMP-598"><span class="linenos">598</span></a>        <span class="n">vel_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">padded</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
</span><span id="LibSWMP-599"><a href="#LibSWMP-599"><span class="linenos">599</span></a>
</span><span id="LibSWMP-600"><a href="#LibSWMP-600"><span class="linenos">600</span></a>        <span class="c1"># Set complete model with metadata</span>
</span><span id="LibSWMP-601"><a href="#LibSWMP-601"><span class="linenos">601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_velocity_model_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP-602"><a href="#LibSWMP-602"><span class="linenos">602</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">x0</span><span class="p">),</span>
</span><span id="LibSWMP-603"><a href="#LibSWMP-603"><span class="linenos">603</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">y0</span><span class="p">),</span>
</span><span id="LibSWMP-604"><a href="#LibSWMP-604"><span class="linenos">604</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">nx</span><span class="p">),</span>
</span><span id="LibSWMP-605"><a href="#LibSWMP-605"><span class="linenos">605</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">ny</span><span class="p">),</span>
</span><span id="LibSWMP-606"><a href="#LibSWMP-606"><span class="linenos">606</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">dx</span><span class="p">),</span>
</span><span id="LibSWMP-607"><a href="#LibSWMP-607"><span class="linenos">607</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">dy</span><span class="p">),</span>
</span><span id="LibSWMP-608"><a href="#LibSWMP-608"><span class="linenos">608</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">cushion_nodes</span><span class="p">),</span>
</span><span id="LibSWMP-609"><a href="#LibSWMP-609"><span class="linenos">609</span></a>            <span class="n">vel_flat</span>
</span><span id="LibSWMP-610"><a href="#LibSWMP-610"><span class="linenos">610</span></a>        <span class="p">)</span>
</span><span id="LibSWMP-611"><a href="#LibSWMP-611"><span class="linenos">611</span></a>
</span><span id="LibSWMP-612"><a href="#LibSWMP-612"><span class="linenos">612</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_sources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">):</span>
</span><span id="LibSWMP-613"><a href="#LibSWMP-613"><span class="linenos">613</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set sources from Sources object (in-memory, no file).</span>
</span><span id="LibSWMP-614"><a href="#LibSWMP-614"><span class="linenos">614</span></a>
</span><span id="LibSWMP-615"><a href="#LibSWMP-615"><span class="linenos">615</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-616"><a href="#LibSWMP-616"><span class="linenos">616</span></a><span class="sd">            sources: Sources instance</span>
</span><span id="LibSWMP-617"><a href="#LibSWMP-617"><span class="linenos">617</span></a>
</span><span id="LibSWMP-618"><a href="#LibSWMP-618"><span class="linenos">618</span></a><span class="sd">        Example:</span>
</span><span id="LibSWMP-619"><a href="#LibSWMP-619"><span class="linenos">619</span></a><span class="sd">            &gt;&gt;&gt; from pyswmp.data import Sources</span>
</span><span id="LibSWMP-620"><a href="#LibSWMP-620"><span class="linenos">620</span></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
</span><span id="LibSWMP-621"><a href="#LibSWMP-621"><span class="linenos">621</span></a><span class="sd">            &gt;&gt;&gt; positions = np.array([[135.0, -25.0], [140.0, -30.0]])</span>
</span><span id="LibSWMP-622"><a href="#LibSWMP-622"><span class="linenos">622</span></a><span class="sd">            &gt;&gt;&gt; sources = Sources(positions, source_type=1)</span>
</span><span id="LibSWMP-623"><a href="#LibSWMP-623"><span class="linenos">623</span></a><span class="sd">            &gt;&gt;&gt; lib.set_sources(sources)</span>
</span><span id="LibSWMP-624"><a href="#LibSWMP-624"><span class="linenos">624</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-625"><a href="#LibSWMP-625"><span class="linenos">625</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sources</span>
</span><span id="LibSWMP-626"><a href="#LibSWMP-626"><span class="linenos">626</span></a>
</span><span id="LibSWMP-627"><a href="#LibSWMP-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">Sources</span><span class="p">):</span>
</span><span id="LibSWMP-628"><a href="#LibSWMP-628"><span class="linenos">628</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;sources must be a Sources instance&quot;</span><span class="p">)</span>
</span><span id="LibSWMP-629"><a href="#LibSWMP-629"><span class="linenos">629</span></a>
</span><span id="LibSWMP-630"><a href="#LibSWMP-630"><span class="linenos">630</span></a>        <span class="c1"># Ensure positions are Fortran-contiguous (column-major)</span>
</span><span id="LibSWMP-631"><a href="#LibSWMP-631"><span class="linenos">631</span></a>        <span class="c1"># Fortran expects dimension(n, 2) in column-major order</span>
</span><span id="LibSWMP-632"><a href="#LibSWMP-632"><span class="linenos">632</span></a>        <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">sources</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="LibSWMP-633"><a href="#LibSWMP-633"><span class="linenos">633</span></a>
</span><span id="LibSWMP-634"><a href="#LibSWMP-634"><span class="linenos">634</span></a>        <span class="c1"># Set sources in Fortran</span>
</span><span id="LibSWMP-635"><a href="#LibSWMP-635"><span class="linenos">635</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_sources_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP-636"><a href="#LibSWMP-636"><span class="linenos">636</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">sources</span><span class="o">.</span><span class="n">n_sources</span><span class="p">),</span>
</span><span id="LibSWMP-637"><a href="#LibSWMP-637"><span class="linenos">637</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">sources</span><span class="o">.</span><span class="n">source_type</span><span class="p">),</span>
</span><span id="LibSWMP-638"><a href="#LibSWMP-638"><span class="linenos">638</span></a>            <span class="n">positions</span>
</span><span id="LibSWMP-639"><a href="#LibSWMP-639"><span class="linenos">639</span></a>        <span class="p">)</span>
</span><span id="LibSWMP-640"><a href="#LibSWMP-640"><span class="linenos">640</span></a>
</span><span id="LibSWMP-641"><a href="#LibSWMP-641"><span class="linenos">641</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_receivers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receivers</span><span class="p">,</span> <span class="n">max_arrivals</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="LibSWMP-642"><a href="#LibSWMP-642"><span class="linenos">642</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set receivers from Receivers object (in-memory, no file).</span>
</span><span id="LibSWMP-643"><a href="#LibSWMP-643"><span class="linenos">643</span></a>
</span><span id="LibSWMP-644"><a href="#LibSWMP-644"><span class="linenos">644</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP-645"><a href="#LibSWMP-645"><span class="linenos">645</span></a><span class="sd">            receivers: Receivers instance</span>
</span><span id="LibSWMP-646"><a href="#LibSWMP-646"><span class="linenos">646</span></a><span class="sd">            max_arrivals: Maximum number of arrivals per receiver (default: 10)</span>
</span><span id="LibSWMP-647"><a href="#LibSWMP-647"><span class="linenos">647</span></a>
</span><span id="LibSWMP-648"><a href="#LibSWMP-648"><span class="linenos">648</span></a><span class="sd">        Example:</span>
</span><span id="LibSWMP-649"><a href="#LibSWMP-649"><span class="linenos">649</span></a><span class="sd">            &gt;&gt;&gt; from pyswmp.data import Receivers</span>
</span><span id="LibSWMP-650"><a href="#LibSWMP-650"><span class="linenos">650</span></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
</span><span id="LibSWMP-651"><a href="#LibSWMP-651"><span class="linenos">651</span></a><span class="sd">            &gt;&gt;&gt; positions = np.array([[120.0, -30.0], [130.0, -25.0]])</span>
</span><span id="LibSWMP-652"><a href="#LibSWMP-652"><span class="linenos">652</span></a><span class="sd">            &gt;&gt;&gt; receivers = Receivers(positions)</span>
</span><span id="LibSWMP-653"><a href="#LibSWMP-653"><span class="linenos">653</span></a><span class="sd">            &gt;&gt;&gt; lib.set_receivers(receivers, max_arrivals=10)</span>
</span><span id="LibSWMP-654"><a href="#LibSWMP-654"><span class="linenos">654</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-655"><a href="#LibSWMP-655"><span class="linenos">655</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Receivers</span>
</span><span id="LibSWMP-656"><a href="#LibSWMP-656"><span class="linenos">656</span></a>
</span><span id="LibSWMP-657"><a href="#LibSWMP-657"><span class="linenos">657</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">receivers</span><span class="p">,</span> <span class="n">Receivers</span><span class="p">):</span>
</span><span id="LibSWMP-658"><a href="#LibSWMP-658"><span class="linenos">658</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;receivers must be a Receivers instance&quot;</span><span class="p">)</span>
</span><span id="LibSWMP-659"><a href="#LibSWMP-659"><span class="linenos">659</span></a>
</span><span id="LibSWMP-660"><a href="#LibSWMP-660"><span class="linenos">660</span></a>        <span class="c1"># Ensure positions are Fortran-contiguous (column-major)</span>
</span><span id="LibSWMP-661"><a href="#LibSWMP-661"><span class="linenos">661</span></a>        <span class="c1"># Fortran expects dimension(n, 2) in column-major order</span>
</span><span id="LibSWMP-662"><a href="#LibSWMP-662"><span class="linenos">662</span></a>        <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">receivers</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="LibSWMP-663"><a href="#LibSWMP-663"><span class="linenos">663</span></a>
</span><span id="LibSWMP-664"><a href="#LibSWMP-664"><span class="linenos">664</span></a>        <span class="c1"># Set receivers in Fortran</span>
</span><span id="LibSWMP-665"><a href="#LibSWMP-665"><span class="linenos">665</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_receivers_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP-666"><a href="#LibSWMP-666"><span class="linenos">666</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">receivers</span><span class="o">.</span><span class="n">n_receivers</span><span class="p">),</span>
</span><span id="LibSWMP-667"><a href="#LibSWMP-667"><span class="linenos">667</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">max_arrivals</span><span class="p">),</span>
</span><span id="LibSWMP-668"><a href="#LibSWMP-668"><span class="linenos">668</span></a>            <span class="n">positions</span>
</span><span id="LibSWMP-669"><a href="#LibSWMP-669"><span class="linenos">669</span></a>        <span class="p">)</span>
</span><span id="LibSWMP-670"><a href="#LibSWMP-670"><span class="linenos">670</span></a>
</span><span id="LibSWMP-671"><a href="#LibSWMP-671"><span class="linenos">671</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_velocity_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LibSWMP-672"><a href="#LibSWMP-672"><span class="linenos">672</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current velocity model as VelocityModel2D object.</span>
</span><span id="LibSWMP-673"><a href="#LibSWMP-673"><span class="linenos">673</span></a>
</span><span id="LibSWMP-674"><a href="#LibSWMP-674"><span class="linenos">674</span></a><span class="sd">        Returns:</span>
</span><span id="LibSWMP-675"><a href="#LibSWMP-675"><span class="linenos">675</span></a><span class="sd">            VelocityModel2D instance with current model data</span>
</span><span id="LibSWMP-676"><a href="#LibSWMP-676"><span class="linenos">676</span></a>
</span><span id="LibSWMP-677"><a href="#LibSWMP-677"><span class="linenos">677</span></a><span class="sd">        Example:</span>
</span><span id="LibSWMP-678"><a href="#LibSWMP-678"><span class="linenos">678</span></a><span class="sd">            &gt;&gt;&gt; model = lib.get_velocity_model()</span>
</span><span id="LibSWMP-679"><a href="#LibSWMP-679"><span class="linenos">679</span></a><span class="sd">            &gt;&gt;&gt; print(model.nx, model.ny)</span>
</span><span id="LibSWMP-680"><a href="#LibSWMP-680"><span class="linenos">680</span></a><span class="sd">            &gt;&gt;&gt; print(model.velocities.shape)</span>
</span><span id="LibSWMP-681"><a href="#LibSWMP-681"><span class="linenos">681</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP-682"><a href="#LibSWMP-682"><span class="linenos">682</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">VelocityModel2D</span>
</span><span id="LibSWMP-683"><a href="#LibSWMP-683"><span class="linenos">683</span></a>
</span><span id="LibSWMP-684"><a href="#LibSWMP-684"><span class="linenos">684</span></a>        <span class="c1"># Get metadata</span>
</span><span id="LibSWMP-685"><a href="#LibSWMP-685"><span class="linenos">685</span></a>        <span class="n">x0</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="LibSWMP-686"><a href="#LibSWMP-686"><span class="linenos">686</span></a>        <span class="n">y0</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="LibSWMP-687"><a href="#LibSWMP-687"><span class="linenos">687</span></a>        <span class="n">nx</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP-688"><a href="#LibSWMP-688"><span class="linenos">688</span></a>        <span class="n">ny</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP-689"><a href="#LibSWMP-689"><span class="linenos">689</span></a>        <span class="n">dx</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="LibSWMP-690"><a href="#LibSWMP-690"><span class="linenos">690</span></a>        <span class="n">dy</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="LibSWMP-691"><a href="#LibSWMP-691"><span class="linenos">691</span></a>        <span class="n">cn</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP-692"><a href="#LibSWMP-692"><span class="linenos">692</span></a>
</span><span id="LibSWMP-693"><a href="#LibSWMP-693"><span class="linenos">693</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_model_meta_data</span><span class="p">(</span>
</span><span id="LibSWMP-694"><a href="#LibSWMP-694"><span class="linenos">694</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span>
</span><span id="LibSWMP-695"><a href="#LibSWMP-695"><span class="linenos">695</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">y0</span><span class="p">),</span>
</span><span id="LibSWMP-696"><a href="#LibSWMP-696"><span class="linenos">696</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">nx</span><span class="p">),</span>
</span><span id="LibSWMP-697"><a href="#LibSWMP-697"><span class="linenos">697</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">ny</span><span class="p">),</span>
</span><span id="LibSWMP-698"><a href="#LibSWMP-698"><span class="linenos">698</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">dx</span><span class="p">),</span>
</span><span id="LibSWMP-699"><a href="#LibSWMP-699"><span class="linenos">699</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">dy</span><span class="p">),</span>
</span><span id="LibSWMP-700"><a href="#LibSWMP-700"><span class="linenos">700</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
</span><span id="LibSWMP-701"><a href="#LibSWMP-701"><span class="linenos">701</span></a>        <span class="p">)</span>
</span><span id="LibSWMP-702"><a href="#LibSWMP-702"><span class="linenos">702</span></a>
</span><span id="LibSWMP-703"><a href="#LibSWMP-703"><span class="linenos">703</span></a>        <span class="c1"># Get velocity data</span>
</span><span id="LibSWMP-704"><a href="#LibSWMP-704"><span class="linenos">704</span></a>        <span class="n">total_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cn</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ny</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cn</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="LibSWMP-705"><a href="#LibSWMP-705"><span class="linenos">705</span></a>        <span class="n">vel_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">total_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP-706"><a href="#LibSWMP-706"><span class="linenos">706</span></a>
</span><span id="LibSWMP-707"><a href="#LibSWMP-707"><span class="linenos">707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_model_vector</span><span class="p">(</span>
</span><span id="LibSWMP-708"><a href="#LibSWMP-708"><span class="linenos">708</span></a>            <span class="n">vel_flat</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">)),</span>
</span><span id="LibSWMP-709"><a href="#LibSWMP-709"><span class="linenos">709</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span>
</span><span id="LibSWMP-710"><a href="#LibSWMP-710"><span class="linenos">710</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">y0</span><span class="p">),</span>
</span><span id="LibSWMP-711"><a href="#LibSWMP-711"><span class="linenos">711</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">nx</span><span class="p">),</span>
</span><span id="LibSWMP-712"><a href="#LibSWMP-712"><span class="linenos">712</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">ny</span><span class="p">),</span>
</span><span id="LibSWMP-713"><a href="#LibSWMP-713"><span class="linenos">713</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">dx</span><span class="p">),</span>
</span><span id="LibSWMP-714"><a href="#LibSWMP-714"><span class="linenos">714</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">dy</span><span class="p">),</span>
</span><span id="LibSWMP-715"><a href="#LibSWMP-715"><span class="linenos">715</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
</span><span id="LibSWMP-716"><a href="#LibSWMP-716"><span class="linenos">716</span></a>        <span class="p">)</span>
</span><span id="LibSWMP-717"><a href="#LibSWMP-717"><span class="linenos">717</span></a>
</span><span id="LibSWMP-718"><a href="#LibSWMP-718"><span class="linenos">718</span></a>        <span class="c1"># Reshape to 2D (without cushion nodes for now)</span>
</span><span id="LibSWMP-719"><a href="#LibSWMP-719"><span class="linenos">719</span></a>        <span class="n">velocities</span> <span class="o">=</span> <span class="n">vel_flat</span><span class="p">[:</span><span class="n">nx</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">ny</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nx</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ny</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
</span><span id="LibSWMP-720"><a href="#LibSWMP-720"><span class="linenos">720</span></a>
</span><span id="LibSWMP-721"><a href="#LibSWMP-721"><span class="linenos">721</span></a>        <span class="k">return</span> <span class="n">VelocityModel2D</span><span class="p">(</span>
</span><span id="LibSWMP-722"><a href="#LibSWMP-722"><span class="linenos">722</span></a>            <span class="n">velocities</span><span class="o">=</span><span class="n">velocities</span><span class="p">,</span>
</span><span id="LibSWMP-723"><a href="#LibSWMP-723"><span class="linenos">723</span></a>            <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="LibSWMP-724"><a href="#LibSWMP-724"><span class="linenos">724</span></a>            <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="LibSWMP-725"><a href="#LibSWMP-725"><span class="linenos">725</span></a>            <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="LibSWMP-726"><a href="#LibSWMP-726"><span class="linenos">726</span></a>            <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="LibSWMP-727"><a href="#LibSWMP-727"><span class="linenos">727</span></a>            <span class="n">cushion_nodes</span><span class="o">=</span><span class="n">cn</span><span class="o">.</span><span class="n">value</span>
</span><span id="LibSWMP-728"><a href="#LibSWMP-728"><span class="linenos">728</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Wrapper for the SWMP Fortran library.</p>

<p>This class loads the compiled library and defines ctypes signatures
for all C-callable functions. Each instance maintains independent state.</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>lib = LibSWMP()
      lib.read_rat_conf(b"config.in")
      lib.read_model(b"model.vel")
      lib.forward()</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            <div id="LibSWMP.__init__" class="classattr">
                                        <input id="LibSWMP.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">LibSWMP</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">lib_path</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="LibSWMP.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.__init__-90"><a href="#LibSWMP.__init__-90"><span class="linenos"> 90</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="LibSWMP.__init__-91"><a href="#LibSWMP.__init__-91"><span class="linenos"> 91</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize library wrapper.</span>
</span><span id="LibSWMP.__init__-92"><a href="#LibSWMP.__init__-92"><span class="linenos"> 92</span></a>
</span><span id="LibSWMP.__init__-93"><a href="#LibSWMP.__init__-93"><span class="linenos"> 93</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.__init__-94"><a href="#LibSWMP.__init__-94"><span class="linenos"> 94</span></a><span class="sd">            lib_path: Optional explicit path to library file</span>
</span><span id="LibSWMP.__init__-95"><a href="#LibSWMP.__init__-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.__init__-96"><a href="#LibSWMP.__init__-96"><span class="linenos"> 96</span></a>        <span class="k">if</span> <span class="n">lib_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LibSWMP.__init__-97"><a href="#LibSWMP.__init__-97"><span class="linenos"> 97</span></a>            <span class="n">lib_path</span> <span class="o">=</span> <span class="n">_find_library</span><span class="p">()</span>
</span><span id="LibSWMP.__init__-98"><a href="#LibSWMP.__init__-98"><span class="linenos"> 98</span></a>
</span><span id="LibSWMP.__init__-99"><a href="#LibSWMP.__init__-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">CDLL</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lib_path</span><span class="p">))</span>
</span><span id="LibSWMP.__init__-100"><a href="#LibSWMP.__init__-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_functions</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize library wrapper.</p>

<p>Args:
    lib_path: Optional explicit path to library file</p>
</div>


                            </div>
                            <div id="LibSWMP.check_error" class="classattr">
                                        <input id="LibSWMP.check_error-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_error</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">status</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.check_error-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.check_error"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.check_error-257"><a href="#LibSWMP.check_error-257"><span class="linenos">257</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
</span><span id="LibSWMP.check_error-258"><a href="#LibSWMP.check_error-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check return status and raise exception if error occurred.</span>
</span><span id="LibSWMP.check_error-259"><a href="#LibSWMP.check_error-259"><span class="linenos">259</span></a>
</span><span id="LibSWMP.check_error-260"><a href="#LibSWMP.check_error-260"><span class="linenos">260</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.check_error-261"><a href="#LibSWMP.check_error-261"><span class="linenos">261</span></a><span class="sd">            status: Return code from library function</span>
</span><span id="LibSWMP.check_error-262"><a href="#LibSWMP.check_error-262"><span class="linenos">262</span></a>
</span><span id="LibSWMP.check_error-263"><a href="#LibSWMP.check_error-263"><span class="linenos">263</span></a><span class="sd">        Raises:</span>
</span><span id="LibSWMP.check_error-264"><a href="#LibSWMP.check_error-264"><span class="linenos">264</span></a><span class="sd">            SWMPError: If status indicates an error</span>
</span><span id="LibSWMP.check_error-265"><a href="#LibSWMP.check_error-265"><span class="linenos">265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.check_error-266"><a href="#LibSWMP.check_error-266"><span class="linenos">266</span></a>        <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="n">SWMP_SUCCESS</span><span class="p">:</span>
</span><span id="LibSWMP.check_error-267"><a href="#LibSWMP.check_error-267"><span class="linenos">267</span></a>            <span class="c1"># Get detailed error message from library</span>
</span><span id="LibSWMP.check_error-268"><a href="#LibSWMP.check_error-268"><span class="linenos">268</span></a>            <span class="n">error_code</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP.check_error-269"><a href="#LibSWMP.check_error-269"><span class="linenos">269</span></a>            <span class="n">msg_buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
</span><span id="LibSWMP.check_error-270"><a href="#LibSWMP.check_error-270"><span class="linenos">270</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_last_error</span><span class="p">(</span>
</span><span id="LibSWMP.check_error-271"><a href="#LibSWMP.check_error-271"><span class="linenos">271</span></a>                <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">error_code</span><span class="p">),</span>
</span><span id="LibSWMP.check_error-272"><a href="#LibSWMP.check_error-272"><span class="linenos">272</span></a>                <span class="n">msg_buf</span><span class="p">,</span>
</span><span id="LibSWMP.check_error-273"><a href="#LibSWMP.check_error-273"><span class="linenos">273</span></a>                <span class="mi">256</span>
</span><span id="LibSWMP.check_error-274"><a href="#LibSWMP.check_error-274"><span class="linenos">274</span></a>            <span class="p">)</span>
</span><span id="LibSWMP.check_error-275"><a href="#LibSWMP.check_error-275"><span class="linenos">275</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="n">msg_buf</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="LibSWMP.check_error-276"><a href="#LibSWMP.check_error-276"><span class="linenos">276</span></a>
</span><span id="LibSWMP.check_error-277"><a href="#LibSWMP.check_error-277"><span class="linenos">277</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">msg</span><span class="p">:</span>
</span><span id="LibSWMP.check_error-278"><a href="#LibSWMP.check_error-278"><span class="linenos">278</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unknown error (code </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="LibSWMP.check_error-279"><a href="#LibSWMP.check_error-279"><span class="linenos">279</span></a>
</span><span id="LibSWMP.check_error-280"><a href="#LibSWMP.check_error-280"><span class="linenos">280</span></a>            <span class="k">raise</span> <span class="n">SWMPError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SWMP error </span><span class="si">{</span><span class="n">error_code</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Check return status and raise exception if error occurred.</p>

<p>Args:
    status: Return code from library function</p>

<p>Raises:
    SWMPError: If status indicates an error</p>
</div>


                            </div>
                            <div id="LibSWMP.read_configuration" class="classattr">
                                        <input id="LibSWMP.read_configuration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_configuration</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">config_file</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.read_configuration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.read_configuration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.read_configuration-286"><a href="#LibSWMP.read_configuration-286"><span class="linenos">286</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_file</span><span class="p">):</span>
</span><span id="LibSWMP.read_configuration-287"><a href="#LibSWMP.read_configuration-287"><span class="linenos">287</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Read configuration from file.</span>
</span><span id="LibSWMP.read_configuration-288"><a href="#LibSWMP.read_configuration-288"><span class="linenos">288</span></a>
</span><span id="LibSWMP.read_configuration-289"><a href="#LibSWMP.read_configuration-289"><span class="linenos">289</span></a><span class="sd">        This loads everything specified in the config file:</span>
</span><span id="LibSWMP.read_configuration-290"><a href="#LibSWMP.read_configuration-290"><span class="linenos">290</span></a><span class="sd">        model, sources, receivers, and all ray tracing parameters.</span>
</span><span id="LibSWMP.read_configuration-291"><a href="#LibSWMP.read_configuration-291"><span class="linenos">291</span></a>
</span><span id="LibSWMP.read_configuration-292"><a href="#LibSWMP.read_configuration-292"><span class="linenos">292</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.read_configuration-293"><a href="#LibSWMP.read_configuration-293"><span class="linenos">293</span></a><span class="sd">            config_file: Path to configuration file</span>
</span><span id="LibSWMP.read_configuration-294"><a href="#LibSWMP.read_configuration-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.read_configuration-295"><a href="#LibSWMP.read_configuration-295"><span class="linenos">295</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="LibSWMP.read_configuration-296"><a href="#LibSWMP.read_configuration-296"><span class="linenos">296</span></a>            <span class="n">config_file</span> <span class="o">=</span> <span class="n">config_file</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="LibSWMP.read_configuration-297"><a href="#LibSWMP.read_configuration-297"><span class="linenos">297</span></a>        <span class="c1"># rat_read_conf doesn&#39;t return status, but we can check for exceptions</span>
</span><span id="LibSWMP.read_configuration-298"><a href="#LibSWMP.read_configuration-298"><span class="linenos">298</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="LibSWMP.read_configuration-299"><a href="#LibSWMP.read_configuration-299"><span class="linenos">299</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">rat_read_conf</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">config_file</span><span class="p">))</span>
</span><span id="LibSWMP.read_configuration-300"><a href="#LibSWMP.read_configuration-300"><span class="linenos">300</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="LibSWMP.read_configuration-301"><a href="#LibSWMP.read_configuration-301"><span class="linenos">301</span></a>            <span class="k">raise</span> <span class="n">SWMPError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to read configuration: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Read configuration from file.</p>

<p>This loads everything specified in the config file:
model, sources, receivers, and all ray tracing parameters.</p>

<p>Args:
    config_file: Path to configuration file</p>
</div>


                            </div>
                            <div id="LibSWMP.run_forward" class="classattr">
                                        <input id="LibSWMP.run_forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run_forward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.run_forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.run_forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.run_forward-303"><a href="#LibSWMP.run_forward-303"><span class="linenos">303</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LibSWMP.run_forward-304"><a href="#LibSWMP.run_forward-304"><span class="linenos">304</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run forward modeling for all sources (sequential).</span>
</span><span id="LibSWMP.run_forward-305"><a href="#LibSWMP.run_forward-305"><span class="linenos">305</span></a>
</span><span id="LibSWMP.run_forward-306"><a href="#LibSWMP.run_forward-306"><span class="linenos">306</span></a><span class="sd">        This is the backward-compatible sequential execution path.</span>
</span><span id="LibSWMP.run_forward-307"><a href="#LibSWMP.run_forward-307"><span class="linenos">307</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.run_forward-308"><a href="#LibSWMP.run_forward-308"><span class="linenos">308</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</span><span id="LibSWMP.run_forward-309"><a href="#LibSWMP.run_forward-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Run forward modeling for all sources (sequential).</p>

<p>This is the backward-compatible sequential execution path.</p>
</div>


                            </div>
                            <div id="LibSWMP.run_single_source" class="classattr">
                                        <input id="LibSWMP.run_single_source-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run_single_source</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">source_id</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.run_single_source-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.run_single_source"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.run_single_source-311"><a href="#LibSWMP.run_single_source-311"><span class="linenos">311</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_single_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
</span><span id="LibSWMP.run_single_source-312"><a href="#LibSWMP.run_single_source-312"><span class="linenos">312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run forward modeling for a single source.</span>
</span><span id="LibSWMP.run_single_source-313"><a href="#LibSWMP.run_single_source-313"><span class="linenos">313</span></a>
</span><span id="LibSWMP.run_single_source-314"><a href="#LibSWMP.run_single_source-314"><span class="linenos">314</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.run_single_source-315"><a href="#LibSWMP.run_single_source-315"><span class="linenos">315</span></a><span class="sd">            source_id: Source ID (1-based indexing)</span>
</span><span id="LibSWMP.run_single_source-316"><a href="#LibSWMP.run_single_source-316"><span class="linenos">316</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.run_single_source-317"><a href="#LibSWMP.run_single_source-317"><span class="linenos">317</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">forward_single_source</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">source_id</span><span class="p">))</span>
</span><span id="LibSWMP.run_single_source-318"><a href="#LibSWMP.run_single_source-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Run forward modeling for a single source.</p>

<p>Args:
    source_id: Source ID (1-based indexing)</p>
</div>


                            </div>
                            <div id="LibSWMP.get_n_sources" class="classattr">
                                        <input id="LibSWMP.get_n_sources-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_n_sources</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.get_n_sources-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.get_n_sources"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.get_n_sources-320"><a href="#LibSWMP.get_n_sources-320"><span class="linenos">320</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_n_sources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LibSWMP.get_n_sources-321"><a href="#LibSWMP.get_n_sources-321"><span class="linenos">321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get number of sources.</span>
</span><span id="LibSWMP.get_n_sources-322"><a href="#LibSWMP.get_n_sources-322"><span class="linenos">322</span></a>
</span><span id="LibSWMP.get_n_sources-323"><a href="#LibSWMP.get_n_sources-323"><span class="linenos">323</span></a><span class="sd">        Returns:</span>
</span><span id="LibSWMP.get_n_sources-324"><a href="#LibSWMP.get_n_sources-324"><span class="linenos">324</span></a><span class="sd">            Number of sources</span>
</span><span id="LibSWMP.get_n_sources-325"><a href="#LibSWMP.get_n_sources-325"><span class="linenos">325</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.get_n_sources-326"><a href="#LibSWMP.get_n_sources-326"><span class="linenos">326</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP.get_n_sources-327"><a href="#LibSWMP.get_n_sources-327"><span class="linenos">327</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_number_of_sources</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="LibSWMP.get_n_sources-328"><a href="#LibSWMP.get_n_sources-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP.get_n_sources-329"><a href="#LibSWMP.get_n_sources-329"><span class="linenos">329</span></a>        <span class="k">return</span> <span class="n">n</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Get number of sources.</p>

<p>Returns:
    Number of sources</p>
</div>


                            </div>
                            <div id="LibSWMP.set_file_output" class="classattr">
                                        <input id="LibSWMP.set_file_output-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_file_output</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">enable</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_file_output-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_file_output"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_file_output-331"><a href="#LibSWMP.set_file_output-331"><span class="linenos">331</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_file_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable</span><span class="p">):</span>
</span><span id="LibSWMP.set_file_output-332"><a href="#LibSWMP.set_file_output-332"><span class="linenos">332</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Enable or disable file output.</span>
</span><span id="LibSWMP.set_file_output-333"><a href="#LibSWMP.set_file_output-333"><span class="linenos">333</span></a>
</span><span id="LibSWMP.set_file_output-334"><a href="#LibSWMP.set_file_output-334"><span class="linenos">334</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_file_output-335"><a href="#LibSWMP.set_file_output-335"><span class="linenos">335</span></a><span class="sd">            enable: True to enable file output, False for memory-only</span>
</span><span id="LibSWMP.set_file_output-336"><a href="#LibSWMP.set_file_output-336"><span class="linenos">336</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_file_output-337"><a href="#LibSWMP.set_file_output-337"><span class="linenos">337</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_enable_file_output</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">enable</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="LibSWMP.set_file_output-338"><a href="#LibSWMP.set_file_output-338"><span class="linenos">338</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Enable or disable file output.</p>

<p>Args:
    enable: True to enable file output, False for memory-only</p>
</div>


                            </div>
                            <div id="LibSWMP.get_arrivals" class="classattr">
                                        <input id="LibSWMP.get_arrivals-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_arrivals</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">source_id</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.get_arrivals-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.get_arrivals"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.get_arrivals-340"><a href="#LibSWMP.get_arrivals-340"><span class="linenos">340</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_arrivals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
</span><span id="LibSWMP.get_arrivals-341"><a href="#LibSWMP.get_arrivals-341"><span class="linenos">341</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract arrival data from memory for given source.</span>
</span><span id="LibSWMP.get_arrivals-342"><a href="#LibSWMP.get_arrivals-342"><span class="linenos">342</span></a>
</span><span id="LibSWMP.get_arrivals-343"><a href="#LibSWMP.get_arrivals-343"><span class="linenos">343</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.get_arrivals-344"><a href="#LibSWMP.get_arrivals-344"><span class="linenos">344</span></a><span class="sd">            source_id: Source ID for which arrivals were computed</span>
</span><span id="LibSWMP.get_arrivals-345"><a href="#LibSWMP.get_arrivals-345"><span class="linenos">345</span></a>
</span><span id="LibSWMP.get_arrivals-346"><a href="#LibSWMP.get_arrivals-346"><span class="linenos">346</span></a><span class="sd">        Returns:</span>
</span><span id="LibSWMP.get_arrivals-347"><a href="#LibSWMP.get_arrivals-347"><span class="linenos">347</span></a><span class="sd">            Tuple of (source_ids, receiver_ids, arrival_nums, times, azimuths, spreading_factors)</span>
</span><span id="LibSWMP.get_arrivals-348"><a href="#LibSWMP.get_arrivals-348"><span class="linenos">348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.get_arrivals-349"><a href="#LibSWMP.get_arrivals-349"><span class="linenos">349</span></a>        <span class="c1"># Get count</span>
</span><span id="LibSWMP.get_arrivals-350"><a href="#LibSWMP.get_arrivals-350"><span class="linenos">350</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP.get_arrivals-351"><a href="#LibSWMP.get_arrivals-351"><span class="linenos">351</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_number_of_arrivals_in_memory</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="LibSWMP.get_arrivals-352"><a href="#LibSWMP.get_arrivals-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP.get_arrivals-353"><a href="#LibSWMP.get_arrivals-353"><span class="linenos">353</span></a>
</span><span id="LibSWMP.get_arrivals-354"><a href="#LibSWMP.get_arrivals-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LibSWMP.get_arrivals-355"><a href="#LibSWMP.get_arrivals-355"><span class="linenos">355</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="LibSWMP.get_arrivals-356"><a href="#LibSWMP.get_arrivals-356"><span class="linenos">356</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>  <span class="c1"># source_ids</span>
</span><span id="LibSWMP.get_arrivals-357"><a href="#LibSWMP.get_arrivals-357"><span class="linenos">357</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>  <span class="c1"># receiver_ids</span>
</span><span id="LibSWMP.get_arrivals-358"><a href="#LibSWMP.get_arrivals-358"><span class="linenos">358</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>  <span class="c1"># arrival_nums</span>
</span><span id="LibSWMP.get_arrivals-359"><a href="#LibSWMP.get_arrivals-359"><span class="linenos">359</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>  <span class="c1"># times</span>
</span><span id="LibSWMP.get_arrivals-360"><a href="#LibSWMP.get_arrivals-360"><span class="linenos">360</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>  <span class="c1"># azimuths</span>
</span><span id="LibSWMP.get_arrivals-361"><a href="#LibSWMP.get_arrivals-361"><span class="linenos">361</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>  <span class="c1"># spreading</span>
</span><span id="LibSWMP.get_arrivals-362"><a href="#LibSWMP.get_arrivals-362"><span class="linenos">362</span></a>            <span class="p">)</span>
</span><span id="LibSWMP.get_arrivals-363"><a href="#LibSWMP.get_arrivals-363"><span class="linenos">363</span></a>
</span><span id="LibSWMP.get_arrivals-364"><a href="#LibSWMP.get_arrivals-364"><span class="linenos">364</span></a>        <span class="c1"># Allocate arrays</span>
</span><span id="LibSWMP.get_arrivals-365"><a href="#LibSWMP.get_arrivals-365"><span class="linenos">365</span></a>        <span class="n">receivers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP.get_arrivals-366"><a href="#LibSWMP.get_arrivals-366"><span class="linenos">366</span></a>        <span class="n">arrival_nums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP.get_arrivals-367"><a href="#LibSWMP.get_arrivals-367"><span class="linenos">367</span></a>        <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP.get_arrivals-368"><a href="#LibSWMP.get_arrivals-368"><span class="linenos">368</span></a>        <span class="n">azimuths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP.get_arrivals-369"><a href="#LibSWMP.get_arrivals-369"><span class="linenos">369</span></a>        <span class="n">spreading</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP.get_arrivals-370"><a href="#LibSWMP.get_arrivals-370"><span class="linenos">370</span></a>
</span><span id="LibSWMP.get_arrivals-371"><a href="#LibSWMP.get_arrivals-371"><span class="linenos">371</span></a>        <span class="c1"># Extract data</span>
</span><span id="LibSWMP.get_arrivals-372"><a href="#LibSWMP.get_arrivals-372"><span class="linenos">372</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_arrivals_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP.get_arrivals-373"><a href="#LibSWMP.get_arrivals-373"><span class="linenos">373</span></a>            <span class="n">receivers</span><span class="p">,</span> <span class="n">arrival_nums</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">azimuths</span><span class="p">,</span> <span class="n">spreading</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">value</span>
</span><span id="LibSWMP.get_arrivals-374"><a href="#LibSWMP.get_arrivals-374"><span class="linenos">374</span></a>        <span class="p">)</span>
</span><span id="LibSWMP.get_arrivals-375"><a href="#LibSWMP.get_arrivals-375"><span class="linenos">375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP.get_arrivals-376"><a href="#LibSWMP.get_arrivals-376"><span class="linenos">376</span></a>
</span><span id="LibSWMP.get_arrivals-377"><a href="#LibSWMP.get_arrivals-377"><span class="linenos">377</span></a>        <span class="c1"># Add source_id to all arrivals</span>
</span><span id="LibSWMP.get_arrivals-378"><a href="#LibSWMP.get_arrivals-378"><span class="linenos">378</span></a>        <span class="n">source_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">source_id</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP.get_arrivals-379"><a href="#LibSWMP.get_arrivals-379"><span class="linenos">379</span></a>
</span><span id="LibSWMP.get_arrivals-380"><a href="#LibSWMP.get_arrivals-380"><span class="linenos">380</span></a>        <span class="k">return</span> <span class="n">source_ids</span><span class="p">,</span> <span class="n">receivers</span><span class="p">,</span> <span class="n">arrival_nums</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">azimuths</span><span class="p">,</span> <span class="n">spreading</span>
</span></pre></div>


            <div class="docstring"><p>Extract arrival data from memory for given source.</p>

<p>Args:
    source_id: Source ID for which arrivals were computed</p>

<p>Returns:
    Tuple of (source_ids, receiver_ids, arrival_nums, times, azimuths, spreading_factors)</p>
</div>


                            </div>
                            <div id="LibSWMP.get_raypaths" class="classattr">
                                        <input id="LibSWMP.get_raypaths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_raypaths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">source_id</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.get_raypaths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.get_raypaths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.get_raypaths-382"><a href="#LibSWMP.get_raypaths-382"><span class="linenos">382</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_raypaths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
</span><span id="LibSWMP.get_raypaths-383"><a href="#LibSWMP.get_raypaths-383"><span class="linenos">383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract raypath data from memory for given source.</span>
</span><span id="LibSWMP.get_raypaths-384"><a href="#LibSWMP.get_raypaths-384"><span class="linenos">384</span></a>
</span><span id="LibSWMP.get_raypaths-385"><a href="#LibSWMP.get_raypaths-385"><span class="linenos">385</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.get_raypaths-386"><a href="#LibSWMP.get_raypaths-386"><span class="linenos">386</span></a><span class="sd">            source_id: Source ID for which raypaths were computed</span>
</span><span id="LibSWMP.get_raypaths-387"><a href="#LibSWMP.get_raypaths-387"><span class="linenos">387</span></a>
</span><span id="LibSWMP.get_raypaths-388"><a href="#LibSWMP.get_raypaths-388"><span class="linenos">388</span></a><span class="sd">        Returns:</span>
</span><span id="LibSWMP.get_raypaths-389"><a href="#LibSWMP.get_raypaths-389"><span class="linenos">389</span></a><span class="sd">            List of dicts with keys: source, receiver, arrival, path (ndarray)</span>
</span><span id="LibSWMP.get_raypaths-390"><a href="#LibSWMP.get_raypaths-390"><span class="linenos">390</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.get_raypaths-391"><a href="#LibSWMP.get_raypaths-391"><span class="linenos">391</span></a>        <span class="c1"># Get counts</span>
</span><span id="LibSWMP.get_raypaths-392"><a href="#LibSWMP.get_raypaths-392"><span class="linenos">392</span></a>        <span class="n">n_paths</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP.get_raypaths-393"><a href="#LibSWMP.get_raypaths-393"><span class="linenos">393</span></a>        <span class="n">total_pts</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP.get_raypaths-394"><a href="#LibSWMP.get_raypaths-394"><span class="linenos">394</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_raypath_count_in_memory</span><span class="p">(</span>
</span><span id="LibSWMP.get_raypaths-395"><a href="#LibSWMP.get_raypaths-395"><span class="linenos">395</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">n_paths</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">total_pts</span><span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-396"><a href="#LibSWMP.get_raypaths-396"><span class="linenos">396</span></a>        <span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-397"><a href="#LibSWMP.get_raypaths-397"><span class="linenos">397</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-398"><a href="#LibSWMP.get_raypaths-398"><span class="linenos">398</span></a>
</span><span id="LibSWMP.get_raypaths-399"><a href="#LibSWMP.get_raypaths-399"><span class="linenos">399</span></a>        <span class="k">if</span> <span class="n">n_paths</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LibSWMP.get_raypaths-400"><a href="#LibSWMP.get_raypaths-400"><span class="linenos">400</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="LibSWMP.get_raypaths-401"><a href="#LibSWMP.get_raypaths-401"><span class="linenos">401</span></a>
</span><span id="LibSWMP.get_raypaths-402"><a href="#LibSWMP.get_raypaths-402"><span class="linenos">402</span></a>        <span class="c1"># Get metadata</span>
</span><span id="LibSWMP.get_raypaths-403"><a href="#LibSWMP.get_raypaths-403"><span class="linenos">403</span></a>        <span class="n">receivers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_paths</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-404"><a href="#LibSWMP.get_raypaths-404"><span class="linenos">404</span></a>        <span class="n">arrival_nums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_paths</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-405"><a href="#LibSWMP.get_raypaths-405"><span class="linenos">405</span></a>        <span class="n">npts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_paths</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-406"><a href="#LibSWMP.get_raypaths-406"><span class="linenos">406</span></a>
</span><span id="LibSWMP.get_raypaths-407"><a href="#LibSWMP.get_raypaths-407"><span class="linenos">407</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_raypath_metadata_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP.get_raypaths-408"><a href="#LibSWMP.get_raypaths-408"><span class="linenos">408</span></a>            <span class="n">receivers</span><span class="p">,</span> <span class="n">arrival_nums</span><span class="p">,</span> <span class="n">npts</span><span class="p">,</span> <span class="n">n_paths</span><span class="o">.</span><span class="n">value</span>
</span><span id="LibSWMP.get_raypaths-409"><a href="#LibSWMP.get_raypaths-409"><span class="linenos">409</span></a>        <span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-410"><a href="#LibSWMP.get_raypaths-410"><span class="linenos">410</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-411"><a href="#LibSWMP.get_raypaths-411"><span class="linenos">411</span></a>
</span><span id="LibSWMP.get_raypaths-412"><a href="#LibSWMP.get_raypaths-412"><span class="linenos">412</span></a>        <span class="c1"># Get positions (flattened)</span>
</span><span id="LibSWMP.get_raypaths-413"><a href="#LibSWMP.get_raypaths-413"><span class="linenos">413</span></a>        <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">total_pts</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-414"><a href="#LibSWMP.get_raypaths-414"><span class="linenos">414</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_raypath_positions_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP.get_raypaths-415"><a href="#LibSWMP.get_raypaths-415"><span class="linenos">415</span></a>            <span class="n">positions</span><span class="p">,</span> <span class="n">total_pts</span><span class="o">.</span><span class="n">value</span>
</span><span id="LibSWMP.get_raypaths-416"><a href="#LibSWMP.get_raypaths-416"><span class="linenos">416</span></a>        <span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-417"><a href="#LibSWMP.get_raypaths-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-418"><a href="#LibSWMP.get_raypaths-418"><span class="linenos">418</span></a>
</span><span id="LibSWMP.get_raypaths-419"><a href="#LibSWMP.get_raypaths-419"><span class="linenos">419</span></a>        <span class="c1"># Reconstruct raypaths</span>
</span><span id="LibSWMP.get_raypaths-420"><a href="#LibSWMP.get_raypaths-420"><span class="linenos">420</span></a>        <span class="n">raypaths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LibSWMP.get_raypaths-421"><a href="#LibSWMP.get_raypaths-421"><span class="linenos">421</span></a>        <span class="n">pos_idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="LibSWMP.get_raypaths-422"><a href="#LibSWMP.get_raypaths-422"><span class="linenos">422</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_paths</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
</span><span id="LibSWMP.get_raypaths-423"><a href="#LibSWMP.get_raypaths-423"><span class="linenos">423</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">npts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="LibSWMP.get_raypaths-424"><a href="#LibSWMP.get_raypaths-424"><span class="linenos">424</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">pos_idx</span><span class="o">*</span><span class="mi">2</span><span class="p">:(</span><span class="n">pos_idx</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="LibSWMP.get_raypaths-425"><a href="#LibSWMP.get_raypaths-425"><span class="linenos">425</span></a>            <span class="n">raypaths</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="LibSWMP.get_raypaths-426"><a href="#LibSWMP.get_raypaths-426"><span class="linenos">426</span></a>                <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">source_id</span><span class="p">,</span>
</span><span id="LibSWMP.get_raypaths-427"><a href="#LibSWMP.get_raypaths-427"><span class="linenos">427</span></a>                <span class="s1">&#39;receiver&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">receivers</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="LibSWMP.get_raypaths-428"><a href="#LibSWMP.get_raypaths-428"><span class="linenos">428</span></a>                <span class="s1">&#39;arrival&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">arrival_nums</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="LibSWMP.get_raypaths-429"><a href="#LibSWMP.get_raypaths-429"><span class="linenos">429</span></a>                <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
</span><span id="LibSWMP.get_raypaths-430"><a href="#LibSWMP.get_raypaths-430"><span class="linenos">430</span></a>            <span class="p">})</span>
</span><span id="LibSWMP.get_raypaths-431"><a href="#LibSWMP.get_raypaths-431"><span class="linenos">431</span></a>            <span class="n">pos_idx</span> <span class="o">+=</span> <span class="n">n</span>
</span><span id="LibSWMP.get_raypaths-432"><a href="#LibSWMP.get_raypaths-432"><span class="linenos">432</span></a>
</span><span id="LibSWMP.get_raypaths-433"><a href="#LibSWMP.get_raypaths-433"><span class="linenos">433</span></a>        <span class="k">return</span> <span class="n">raypaths</span>
</span></pre></div>


            <div class="docstring"><p>Extract raypath data from memory for given source.</p>

<p>Args:
    source_id: Source ID for which raypaths were computed</p>

<p>Returns:
    List of dicts with keys: source, receiver, arrival, path (ndarray)</p>
</div>


                            </div>
                            <div id="LibSWMP.get_wavefronts" class="classattr">
                                        <input id="LibSWMP.get_wavefronts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_wavefronts</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">source_id</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.get_wavefronts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.get_wavefronts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.get_wavefronts-435"><a href="#LibSWMP.get_wavefronts-435"><span class="linenos">435</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_wavefronts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
</span><span id="LibSWMP.get_wavefronts-436"><a href="#LibSWMP.get_wavefronts-436"><span class="linenos">436</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract wavefront data from memory for given source.</span>
</span><span id="LibSWMP.get_wavefronts-437"><a href="#LibSWMP.get_wavefronts-437"><span class="linenos">437</span></a>
</span><span id="LibSWMP.get_wavefronts-438"><a href="#LibSWMP.get_wavefronts-438"><span class="linenos">438</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.get_wavefronts-439"><a href="#LibSWMP.get_wavefronts-439"><span class="linenos">439</span></a><span class="sd">            source_id: Source ID for which wavefronts were computed</span>
</span><span id="LibSWMP.get_wavefronts-440"><a href="#LibSWMP.get_wavefronts-440"><span class="linenos">440</span></a>
</span><span id="LibSWMP.get_wavefronts-441"><a href="#LibSWMP.get_wavefronts-441"><span class="linenos">441</span></a><span class="sd">        Returns:</span>
</span><span id="LibSWMP.get_wavefronts-442"><a href="#LibSWMP.get_wavefronts-442"><span class="linenos">442</span></a><span class="sd">            List of wavefront arrays (each is ndarray of shape (n, 2))</span>
</span><span id="LibSWMP.get_wavefronts-443"><a href="#LibSWMP.get_wavefronts-443"><span class="linenos">443</span></a>
</span><span id="LibSWMP.get_wavefronts-444"><a href="#LibSWMP.get_wavefronts-444"><span class="linenos">444</span></a><span class="sd">        Note:</span>
</span><span id="LibSWMP.get_wavefronts-445"><a href="#LibSWMP.get_wavefronts-445"><span class="linenos">445</span></a><span class="sd">            Wavefront extraction not yet implemented in Fortran.</span>
</span><span id="LibSWMP.get_wavefronts-446"><a href="#LibSWMP.get_wavefronts-446"><span class="linenos">446</span></a><span class="sd">            This method always returns an empty list.</span>
</span><span id="LibSWMP.get_wavefronts-447"><a href="#LibSWMP.get_wavefronts-447"><span class="linenos">447</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.get_wavefronts-448"><a href="#LibSWMP.get_wavefronts-448"><span class="linenos">448</span></a>        <span class="c1"># TODO: Implement wavefront extraction functions in m_swmp.f90</span>
</span><span id="LibSWMP.get_wavefronts-449"><a href="#LibSWMP.get_wavefronts-449"><span class="linenos">449</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Extract wavefront data from memory for given source.</p>

<p>Args:
    source_id: Source ID for which wavefronts were computed</p>

<p>Returns:
    List of wavefront arrays (each is ndarray of shape (n, 2))</p>

<p>Note:
    Wavefront extraction not yet implemented in Fortran.
    This method always returns an empty list.</p>
</div>


                            </div>
                            <div id="LibSWMP.set_dt" class="classattr">
                                        <input id="LibSWMP.set_dt-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_dt</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">dt</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_dt-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_dt"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_dt-455"><a href="#LibSWMP.set_dt-455"><span class="linenos">455</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_dt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
</span><span id="LibSWMP.set_dt-456"><a href="#LibSWMP.set_dt-456"><span class="linenos">456</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set ODE solver time step.</span>
</span><span id="LibSWMP.set_dt-457"><a href="#LibSWMP.set_dt-457"><span class="linenos">457</span></a>
</span><span id="LibSWMP.set_dt-458"><a href="#LibSWMP.set_dt-458"><span class="linenos">458</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_dt-459"><a href="#LibSWMP.set_dt-459"><span class="linenos">459</span></a><span class="sd">            dt: Time step size</span>
</span><span id="LibSWMP.set_dt-460"><a href="#LibSWMP.set_dt-460"><span class="linenos">460</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_dt-461"><a href="#LibSWMP.set_dt-461"><span class="linenos">461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">dt</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Set ODE solver time step.</p>

<p>Args:
    dt: Time step size</p>
</div>


                            </div>
                            <div id="LibSWMP.set_max_iterations" class="classattr">
                                        <input id="LibSWMP.set_max_iterations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_max_iterations</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">maxit</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_max_iterations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_max_iterations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_max_iterations-463"><a href="#LibSWMP.set_max_iterations-463"><span class="linenos">463</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_max_iterations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxit</span><span class="p">):</span>
</span><span id="LibSWMP.set_max_iterations-464"><a href="#LibSWMP.set_max_iterations-464"><span class="linenos">464</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set maximum number of iterations.</span>
</span><span id="LibSWMP.set_max_iterations-465"><a href="#LibSWMP.set_max_iterations-465"><span class="linenos">465</span></a>
</span><span id="LibSWMP.set_max_iterations-466"><a href="#LibSWMP.set_max_iterations-466"><span class="linenos">466</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_max_iterations-467"><a href="#LibSWMP.set_max_iterations-467"><span class="linenos">467</span></a><span class="sd">            maxit: Maximum iterations</span>
</span><span id="LibSWMP.set_max_iterations-468"><a href="#LibSWMP.set_max_iterations-468"><span class="linenos">468</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_max_iterations-469"><a href="#LibSWMP.set_max_iterations-469"><span class="linenos">469</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_maxit</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">maxit</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Set maximum number of iterations.</p>

<p>Args:
    maxit: Maximum iterations</p>
</div>


                            </div>
                            <div id="LibSWMP.set_n_bichar_nodes" class="classattr">
                                        <input id="LibSWMP.set_n_bichar_nodes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_n_bichar_nodes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nsenod</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_n_bichar_nodes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_n_bichar_nodes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_n_bichar_nodes-471"><a href="#LibSWMP.set_n_bichar_nodes-471"><span class="linenos">471</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_n_bichar_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsenod</span><span class="p">):</span>
</span><span id="LibSWMP.set_n_bichar_nodes-472"><a href="#LibSWMP.set_n_bichar_nodes-472"><span class="linenos">472</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set number of nodes on bicharacteristic strip.</span>
</span><span id="LibSWMP.set_n_bichar_nodes-473"><a href="#LibSWMP.set_n_bichar_nodes-473"><span class="linenos">473</span></a>
</span><span id="LibSWMP.set_n_bichar_nodes-474"><a href="#LibSWMP.set_n_bichar_nodes-474"><span class="linenos">474</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_n_bichar_nodes-475"><a href="#LibSWMP.set_n_bichar_nodes-475"><span class="linenos">475</span></a><span class="sd">            nsenod: Number of nodes</span>
</span><span id="LibSWMP.set_n_bichar_nodes-476"><a href="#LibSWMP.set_n_bichar_nodes-476"><span class="linenos">476</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_n_bichar_nodes-477"><a href="#LibSWMP.set_n_bichar_nodes-477"><span class="linenos">477</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_nsenod</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">nsenod</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Set number of nodes on bicharacteristic strip.</p>

<p>Args:
    nsenod: Number of nodes</p>
</div>


                            </div>
                            <div id="LibSWMP.set_computation_mode" class="classattr">
                                        <input id="LibSWMP.set_computation_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_computation_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mode</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_computation_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_computation_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_computation_mode-479"><a href="#LibSWMP.set_computation_mode-479"><span class="linenos">479</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_computation_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
</span><span id="LibSWMP.set_computation_mode-480"><a href="#LibSWMP.set_computation_mode-480"><span class="linenos">480</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set computation mode.</span>
</span><span id="LibSWMP.set_computation_mode-481"><a href="#LibSWMP.set_computation_mode-481"><span class="linenos">481</span></a>
</span><span id="LibSWMP.set_computation_mode-482"><a href="#LibSWMP.set_computation_mode-482"><span class="linenos">482</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_computation_mode-483"><a href="#LibSWMP.set_computation_mode-483"><span class="linenos">483</span></a><span class="sd">            mode: Computation mode</span>
</span><span id="LibSWMP.set_computation_mode-484"><a href="#LibSWMP.set_computation_mode-484"><span class="linenos">484</span></a><span class="sd">                1 = Kinematic ray tracing only</span>
</span><span id="LibSWMP.set_computation_mode-485"><a href="#LibSWMP.set_computation_mode-485"><span class="linenos">485</span></a><span class="sd">                2 = Kinematic ray tracing + spreading factors</span>
</span><span id="LibSWMP.set_computation_mode-486"><a href="#LibSWMP.set_computation_mode-486"><span class="linenos">486</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_computation_mode-487"><a href="#LibSWMP.set_computation_mode-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Set computation mode.</p>

<p>Args:
    mode: Computation mode
        1 = Kinematic ray tracing only
        2 = Kinematic ray tracing + spreading factors</p>
</div>


                            </div>
                            <div id="LibSWMP.set_ode_solver" class="classattr">
                                        <input id="LibSWMP.set_ode_solver-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_ode_solver</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">solver</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_ode_solver-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_ode_solver"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_ode_solver-489"><a href="#LibSWMP.set_ode_solver-489"><span class="linenos">489</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_ode_solver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solver</span><span class="p">):</span>
</span><span id="LibSWMP.set_ode_solver-490"><a href="#LibSWMP.set_ode_solver-490"><span class="linenos">490</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set ODE solver type.</span>
</span><span id="LibSWMP.set_ode_solver-491"><a href="#LibSWMP.set_ode_solver-491"><span class="linenos">491</span></a>
</span><span id="LibSWMP.set_ode_solver-492"><a href="#LibSWMP.set_ode_solver-492"><span class="linenos">492</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_ode_solver-493"><a href="#LibSWMP.set_ode_solver-493"><span class="linenos">493</span></a><span class="sd">            solver: Solver type</span>
</span><span id="LibSWMP.set_ode_solver-494"><a href="#LibSWMP.set_ode_solver-494"><span class="linenos">494</span></a><span class="sd">                1 = 4th order Runge-Kutta</span>
</span><span id="LibSWMP.set_ode_solver-495"><a href="#LibSWMP.set_ode_solver-495"><span class="linenos">495</span></a><span class="sd">                2 = 5th order Runge-Kutta</span>
</span><span id="LibSWMP.set_ode_solver-496"><a href="#LibSWMP.set_ode_solver-496"><span class="linenos">496</span></a><span class="sd">                3 = 5th order adaptive Runge-Kutta</span>
</span><span id="LibSWMP.set_ode_solver-497"><a href="#LibSWMP.set_ode_solver-497"><span class="linenos">497</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_ode_solver-498"><a href="#LibSWMP.set_ode_solver-498"><span class="linenos">498</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_solver</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Set ODE solver type.</p>

<p>Args:
    solver: Solver type
        1 = 4th order Runge-Kutta
        2 = 5th order Runge-Kutta
        3 = 5th order adaptive Runge-Kutta</p>
</div>


                            </div>
                            <div id="LibSWMP.set_interpolator" class="classattr">
                                        <input id="LibSWMP.set_interpolator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_interpolator</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">interp</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_interpolator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_interpolator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_interpolator-500"><a href="#LibSWMP.set_interpolator-500"><span class="linenos">500</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="p">):</span>
</span><span id="LibSWMP.set_interpolator-501"><a href="#LibSWMP.set_interpolator-501"><span class="linenos">501</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set velocity interpolation method.</span>
</span><span id="LibSWMP.set_interpolator-502"><a href="#LibSWMP.set_interpolator-502"><span class="linenos">502</span></a>
</span><span id="LibSWMP.set_interpolator-503"><a href="#LibSWMP.set_interpolator-503"><span class="linenos">503</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_interpolator-504"><a href="#LibSWMP.set_interpolator-504"><span class="linenos">504</span></a><span class="sd">            interp: Interpolation method</span>
</span><span id="LibSWMP.set_interpolator-505"><a href="#LibSWMP.set_interpolator-505"><span class="linenos">505</span></a><span class="sd">                1 = Linear interpolation</span>
</span><span id="LibSWMP.set_interpolator-506"><a href="#LibSWMP.set_interpolator-506"><span class="linenos">506</span></a><span class="sd">                2 = Weighted average</span>
</span><span id="LibSWMP.set_interpolator-507"><a href="#LibSWMP.set_interpolator-507"><span class="linenos">507</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_interpolator-508"><a href="#LibSWMP.set_interpolator-508"><span class="linenos">508</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_interp</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">interp</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Set velocity interpolation method.</p>

<p>Args:
    interp: Interpolation method
        1 = Linear interpolation
        2 = Weighted average</p>
</div>


                            </div>
                            <div id="LibSWMP.set_max_arrivals" class="classattr">
                                        <input id="LibSWMP.set_max_arrivals-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_max_arrivals</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mar</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_max_arrivals-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_max_arrivals"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_max_arrivals-510"><a href="#LibSWMP.set_max_arrivals-510"><span class="linenos">510</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_max_arrivals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mar</span><span class="p">):</span>
</span><span id="LibSWMP.set_max_arrivals-511"><a href="#LibSWMP.set_max_arrivals-511"><span class="linenos">511</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set maximum number of arrivals per receiver.</span>
</span><span id="LibSWMP.set_max_arrivals-512"><a href="#LibSWMP.set_max_arrivals-512"><span class="linenos">512</span></a>
</span><span id="LibSWMP.set_max_arrivals-513"><a href="#LibSWMP.set_max_arrivals-513"><span class="linenos">513</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_max_arrivals-514"><a href="#LibSWMP.set_max_arrivals-514"><span class="linenos">514</span></a><span class="sd">            mar: Maximum number of arrivals</span>
</span><span id="LibSWMP.set_max_arrivals-515"><a href="#LibSWMP.set_max_arrivals-515"><span class="linenos">515</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_max_arrivals-516"><a href="#LibSWMP.set_max_arrivals-516"><span class="linenos">516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_mar</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">mar</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Set maximum number of arrivals per receiver.</p>

<p>Args:
    mar: Maximum number of arrivals</p>
</div>


                            </div>
                            <div id="LibSWMP.set_coordinate_system" class="classattr">
                                        <input id="LibSWMP.set_coordinate_system-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_coordinate_system</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">velint</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_coordinate_system-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_coordinate_system"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_coordinate_system-518"><a href="#LibSWMP.set_coordinate_system-518"><span class="linenos">518</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_coordinate_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">velint</span><span class="p">):</span>
</span><span id="LibSWMP.set_coordinate_system-519"><a href="#LibSWMP.set_coordinate_system-519"><span class="linenos">519</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set coordinate system type.</span>
</span><span id="LibSWMP.set_coordinate_system-520"><a href="#LibSWMP.set_coordinate_system-520"><span class="linenos">520</span></a>
</span><span id="LibSWMP.set_coordinate_system-521"><a href="#LibSWMP.set_coordinate_system-521"><span class="linenos">521</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_coordinate_system-522"><a href="#LibSWMP.set_coordinate_system-522"><span class="linenos">522</span></a><span class="sd">            velint: Coordinate system</span>
</span><span id="LibSWMP.set_coordinate_system-523"><a href="#LibSWMP.set_coordinate_system-523"><span class="linenos">523</span></a><span class="sd">                1 = Cartesian cubic B-splines</span>
</span><span id="LibSWMP.set_coordinate_system-524"><a href="#LibSWMP.set_coordinate_system-524"><span class="linenos">524</span></a><span class="sd">                2 = Spherical splines</span>
</span><span id="LibSWMP.set_coordinate_system-525"><a href="#LibSWMP.set_coordinate_system-525"><span class="linenos">525</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_coordinate_system-526"><a href="#LibSWMP.set_coordinate_system-526"><span class="linenos">526</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_velint</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">velint</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Set coordinate system type.</p>

<p>Args:
    velint: Coordinate system
        1 = Cartesian cubic B-splines
        2 = Spherical splines</p>
</div>


                            </div>
                            <div id="LibSWMP.set_earth_radius" class="classattr">
                                        <input id="LibSWMP.set_earth_radius-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_earth_radius</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">rearth</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_earth_radius-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_earth_radius"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_earth_radius-528"><a href="#LibSWMP.set_earth_radius-528"><span class="linenos">528</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_earth_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rearth</span><span class="p">):</span>
</span><span id="LibSWMP.set_earth_radius-529"><a href="#LibSWMP.set_earth_radius-529"><span class="linenos">529</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set Earth radius for spherical coordinates.</span>
</span><span id="LibSWMP.set_earth_radius-530"><a href="#LibSWMP.set_earth_radius-530"><span class="linenos">530</span></a>
</span><span id="LibSWMP.set_earth_radius-531"><a href="#LibSWMP.set_earth_radius-531"><span class="linenos">531</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_earth_radius-532"><a href="#LibSWMP.set_earth_radius-532"><span class="linenos">532</span></a><span class="sd">            rearth: Earth radius in km (default: 6371.0)</span>
</span><span id="LibSWMP.set_earth_radius-533"><a href="#LibSWMP.set_earth_radius-533"><span class="linenos">533</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_earth_radius-534"><a href="#LibSWMP.set_earth_radius-534"><span class="linenos">534</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_rearth</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">rearth</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Set Earth radius for spherical coordinates.</p>

<p>Args:
    rearth: Earth radius in km (default: 6371.0)</p>
</div>


                            </div>
                            <div id="LibSWMP.apply_options" class="classattr">
                                        <input id="LibSWMP.apply_options-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_options</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">options</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.apply_options-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.apply_options"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.apply_options-536"><a href="#LibSWMP.apply_options-536"><span class="linenos">536</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
</span><span id="LibSWMP.apply_options-537"><a href="#LibSWMP.apply_options-537"><span class="linenos">537</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply TrackerOptions to configure all parameters.</span>
</span><span id="LibSWMP.apply_options-538"><a href="#LibSWMP.apply_options-538"><span class="linenos">538</span></a>
</span><span id="LibSWMP.apply_options-539"><a href="#LibSWMP.apply_options-539"><span class="linenos">539</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.apply_options-540"><a href="#LibSWMP.apply_options-540"><span class="linenos">540</span></a><span class="sd">            options: TrackerOptions instance with configuration</span>
</span><span id="LibSWMP.apply_options-541"><a href="#LibSWMP.apply_options-541"><span class="linenos">541</span></a>
</span><span id="LibSWMP.apply_options-542"><a href="#LibSWMP.apply_options-542"><span class="linenos">542</span></a><span class="sd">        Example:</span>
</span><span id="LibSWMP.apply_options-543"><a href="#LibSWMP.apply_options-543"><span class="linenos">543</span></a><span class="sd">            &gt;&gt;&gt; lib = LibSWMP()</span>
</span><span id="LibSWMP.apply_options-544"><a href="#LibSWMP.apply_options-544"><span class="linenos">544</span></a><span class="sd">            &gt;&gt;&gt; opts = TrackerOptions(dt=2.0, max_iterations=1000)</span>
</span><span id="LibSWMP.apply_options-545"><a href="#LibSWMP.apply_options-545"><span class="linenos">545</span></a><span class="sd">            &gt;&gt;&gt; lib.apply_options(opts)</span>
</span><span id="LibSWMP.apply_options-546"><a href="#LibSWMP.apply_options-546"><span class="linenos">546</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.apply_options-547"><a href="#LibSWMP.apply_options-547"><span class="linenos">547</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
</span><span id="LibSWMP.apply_options-548"><a href="#LibSWMP.apply_options-548"><span class="linenos">548</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_max_iterations</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">)</span>
</span><span id="LibSWMP.apply_options-549"><a href="#LibSWMP.apply_options-549"><span class="linenos">549</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_n_bichar_nodes</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">n_bichar_nodes</span><span class="p">)</span>
</span><span id="LibSWMP.apply_options-550"><a href="#LibSWMP.apply_options-550"><span class="linenos">550</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_computation_mode</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">computation_mode</span><span class="p">)</span>
</span><span id="LibSWMP.apply_options-551"><a href="#LibSWMP.apply_options-551"><span class="linenos">551</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_ode_solver</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">ode_solver</span><span class="p">)</span>
</span><span id="LibSWMP.apply_options-552"><a href="#LibSWMP.apply_options-552"><span class="linenos">552</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_interpolator</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">interpolator</span><span class="p">)</span>
</span><span id="LibSWMP.apply_options-553"><a href="#LibSWMP.apply_options-553"><span class="linenos">553</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_max_arrivals</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">max_arrivals</span><span class="p">)</span>
</span><span id="LibSWMP.apply_options-554"><a href="#LibSWMP.apply_options-554"><span class="linenos">554</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_coordinate_system</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">coordinate_system</span><span class="p">)</span>
</span><span id="LibSWMP.apply_options-555"><a href="#LibSWMP.apply_options-555"><span class="linenos">555</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_earth_radius</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">earth_radius</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Apply TrackerOptions to configure all parameters.</p>

<p>Args:
    options: TrackerOptions instance with configuration</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>lib = LibSWMP()
      opts = TrackerOptions(dt=2.0, max_iterations=1000)
      lib.apply_options(opts)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="LibSWMP.set_velocity_model" class="classattr">
                                        <input id="LibSWMP.set_velocity_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_velocity_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_velocity_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_velocity_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_velocity_model-561"><a href="#LibSWMP.set_velocity_model-561"><span class="linenos">561</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_velocity_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
</span><span id="LibSWMP.set_velocity_model-562"><a href="#LibSWMP.set_velocity_model-562"><span class="linenos">562</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set velocity model from VelocityModel2D object.</span>
</span><span id="LibSWMP.set_velocity_model-563"><a href="#LibSWMP.set_velocity_model-563"><span class="linenos">563</span></a>
</span><span id="LibSWMP.set_velocity_model-564"><a href="#LibSWMP.set_velocity_model-564"><span class="linenos">564</span></a><span class="sd">        This uses the new file-free API that initializes the complete</span>
</span><span id="LibSWMP.set_velocity_model-565"><a href="#LibSWMP.set_velocity_model-565"><span class="linenos">565</span></a><span class="sd">        velocity model structure in memory.</span>
</span><span id="LibSWMP.set_velocity_model-566"><a href="#LibSWMP.set_velocity_model-566"><span class="linenos">566</span></a>
</span><span id="LibSWMP.set_velocity_model-567"><a href="#LibSWMP.set_velocity_model-567"><span class="linenos">567</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_velocity_model-568"><a href="#LibSWMP.set_velocity_model-568"><span class="linenos">568</span></a><span class="sd">            model: VelocityModel2D instance</span>
</span><span id="LibSWMP.set_velocity_model-569"><a href="#LibSWMP.set_velocity_model-569"><span class="linenos">569</span></a>
</span><span id="LibSWMP.set_velocity_model-570"><a href="#LibSWMP.set_velocity_model-570"><span class="linenos">570</span></a><span class="sd">        Example:</span>
</span><span id="LibSWMP.set_velocity_model-571"><a href="#LibSWMP.set_velocity_model-571"><span class="linenos">571</span></a><span class="sd">            &gt;&gt;&gt; from pyswmp.data import VelocityModel2D</span>
</span><span id="LibSWMP.set_velocity_model-572"><a href="#LibSWMP.set_velocity_model-572"><span class="linenos">572</span></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
</span><span id="LibSWMP.set_velocity_model-573"><a href="#LibSWMP.set_velocity_model-573"><span class="linenos">573</span></a><span class="sd">            &gt;&gt;&gt; velocities = np.full((100, 80), 3.5, dtype=np.float32)</span>
</span><span id="LibSWMP.set_velocity_model-574"><a href="#LibSWMP.set_velocity_model-574"><span class="linenos">574</span></a><span class="sd">            &gt;&gt;&gt; model = VelocityModel2D(velocities, 110.0, -45.0, 0.5, 0.5)</span>
</span><span id="LibSWMP.set_velocity_model-575"><a href="#LibSWMP.set_velocity_model-575"><span class="linenos">575</span></a><span class="sd">            &gt;&gt;&gt; lib.set_velocity_model(model)</span>
</span><span id="LibSWMP.set_velocity_model-576"><a href="#LibSWMP.set_velocity_model-576"><span class="linenos">576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_velocity_model-577"><a href="#LibSWMP.set_velocity_model-577"><span class="linenos">577</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">VelocityModel2D</span>
</span><span id="LibSWMP.set_velocity_model-578"><a href="#LibSWMP.set_velocity_model-578"><span class="linenos">578</span></a>
</span><span id="LibSWMP.set_velocity_model-579"><a href="#LibSWMP.set_velocity_model-579"><span class="linenos">579</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">VelocityModel2D</span><span class="p">):</span>
</span><span id="LibSWMP.set_velocity_model-580"><a href="#LibSWMP.set_velocity_model-580"><span class="linenos">580</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;model must be a VelocityModel2D instance&quot;</span><span class="p">)</span>
</span><span id="LibSWMP.set_velocity_model-581"><a href="#LibSWMP.set_velocity_model-581"><span class="linenos">581</span></a>
</span><span id="LibSWMP.set_velocity_model-582"><a href="#LibSWMP.set_velocity_model-582"><span class="linenos">582</span></a>        <span class="c1"># Ensure velocities are float32</span>
</span><span id="LibSWMP.set_velocity_model-583"><a href="#LibSWMP.set_velocity_model-583"><span class="linenos">583</span></a>        <span class="n">velocities</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP.set_velocity_model-584"><a href="#LibSWMP.set_velocity_model-584"><span class="linenos">584</span></a>
</span><span id="LibSWMP.set_velocity_model-585"><a href="#LibSWMP.set_velocity_model-585"><span class="linenos">585</span></a>        <span class="c1"># Add cushion nodes if needed</span>
</span><span id="LibSWMP.set_velocity_model-586"><a href="#LibSWMP.set_velocity_model-586"><span class="linenos">586</span></a>        <span class="c1"># Fortran expects array of size (nx+2*cn, ny+2*cn)</span>
</span><span id="LibSWMP.set_velocity_model-587"><a href="#LibSWMP.set_velocity_model-587"><span class="linenos">587</span></a>        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">cushion_nodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LibSWMP.set_velocity_model-588"><a href="#LibSWMP.set_velocity_model-588"><span class="linenos">588</span></a>            <span class="c1"># Pad with edge replication</span>
</span><span id="LibSWMP.set_velocity_model-589"><a href="#LibSWMP.set_velocity_model-589"><span class="linenos">589</span></a>            <span class="n">padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
</span><span id="LibSWMP.set_velocity_model-590"><a href="#LibSWMP.set_velocity_model-590"><span class="linenos">590</span></a>                <span class="n">velocities</span><span class="p">,</span>
</span><span id="LibSWMP.set_velocity_model-591"><a href="#LibSWMP.set_velocity_model-591"><span class="linenos">591</span></a>                <span class="n">pad_width</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">cushion_nodes</span><span class="p">,</span>
</span><span id="LibSWMP.set_velocity_model-592"><a href="#LibSWMP.set_velocity_model-592"><span class="linenos">592</span></a>                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span>
</span><span id="LibSWMP.set_velocity_model-593"><a href="#LibSWMP.set_velocity_model-593"><span class="linenos">593</span></a>            <span class="p">)</span>
</span><span id="LibSWMP.set_velocity_model-594"><a href="#LibSWMP.set_velocity_model-594"><span class="linenos">594</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LibSWMP.set_velocity_model-595"><a href="#LibSWMP.set_velocity_model-595"><span class="linenos">595</span></a>            <span class="n">padded</span> <span class="o">=</span> <span class="n">velocities</span>
</span><span id="LibSWMP.set_velocity_model-596"><a href="#LibSWMP.set_velocity_model-596"><span class="linenos">596</span></a>
</span><span id="LibSWMP.set_velocity_model-597"><a href="#LibSWMP.set_velocity_model-597"><span class="linenos">597</span></a>        <span class="c1"># Flatten velocity array in Fortran order (column-major)</span>
</span><span id="LibSWMP.set_velocity_model-598"><a href="#LibSWMP.set_velocity_model-598"><span class="linenos">598</span></a>        <span class="n">vel_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">padded</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
</span><span id="LibSWMP.set_velocity_model-599"><a href="#LibSWMP.set_velocity_model-599"><span class="linenos">599</span></a>
</span><span id="LibSWMP.set_velocity_model-600"><a href="#LibSWMP.set_velocity_model-600"><span class="linenos">600</span></a>        <span class="c1"># Set complete model with metadata</span>
</span><span id="LibSWMP.set_velocity_model-601"><a href="#LibSWMP.set_velocity_model-601"><span class="linenos">601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_velocity_model_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP.set_velocity_model-602"><a href="#LibSWMP.set_velocity_model-602"><span class="linenos">602</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">x0</span><span class="p">),</span>
</span><span id="LibSWMP.set_velocity_model-603"><a href="#LibSWMP.set_velocity_model-603"><span class="linenos">603</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">y0</span><span class="p">),</span>
</span><span id="LibSWMP.set_velocity_model-604"><a href="#LibSWMP.set_velocity_model-604"><span class="linenos">604</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">nx</span><span class="p">),</span>
</span><span id="LibSWMP.set_velocity_model-605"><a href="#LibSWMP.set_velocity_model-605"><span class="linenos">605</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">ny</span><span class="p">),</span>
</span><span id="LibSWMP.set_velocity_model-606"><a href="#LibSWMP.set_velocity_model-606"><span class="linenos">606</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">dx</span><span class="p">),</span>
</span><span id="LibSWMP.set_velocity_model-607"><a href="#LibSWMP.set_velocity_model-607"><span class="linenos">607</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">dy</span><span class="p">),</span>
</span><span id="LibSWMP.set_velocity_model-608"><a href="#LibSWMP.set_velocity_model-608"><span class="linenos">608</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">cushion_nodes</span><span class="p">),</span>
</span><span id="LibSWMP.set_velocity_model-609"><a href="#LibSWMP.set_velocity_model-609"><span class="linenos">609</span></a>            <span class="n">vel_flat</span>
</span><span id="LibSWMP.set_velocity_model-610"><a href="#LibSWMP.set_velocity_model-610"><span class="linenos">610</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set velocity model from VelocityModel2D object.</p>

<p>This uses the new file-free API that initializes the complete
velocity model structure in memory.</p>

<p>Args:
    model: VelocityModel2D instance</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>from pyswmp.data import VelocityModel2D
      import numpy as np
      velocities = np.full((100, 80), 3.5, dtype=np.float32)
      model = VelocityModel2D(velocities, 110.0, -45.0, 0.5, 0.5)
      lib.set_velocity_model(model)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="LibSWMP.set_sources" class="classattr">
                                        <input id="LibSWMP.set_sources-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_sources</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">sources</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_sources-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_sources"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_sources-612"><a href="#LibSWMP.set_sources-612"><span class="linenos">612</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_sources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">):</span>
</span><span id="LibSWMP.set_sources-613"><a href="#LibSWMP.set_sources-613"><span class="linenos">613</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set sources from Sources object (in-memory, no file).</span>
</span><span id="LibSWMP.set_sources-614"><a href="#LibSWMP.set_sources-614"><span class="linenos">614</span></a>
</span><span id="LibSWMP.set_sources-615"><a href="#LibSWMP.set_sources-615"><span class="linenos">615</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_sources-616"><a href="#LibSWMP.set_sources-616"><span class="linenos">616</span></a><span class="sd">            sources: Sources instance</span>
</span><span id="LibSWMP.set_sources-617"><a href="#LibSWMP.set_sources-617"><span class="linenos">617</span></a>
</span><span id="LibSWMP.set_sources-618"><a href="#LibSWMP.set_sources-618"><span class="linenos">618</span></a><span class="sd">        Example:</span>
</span><span id="LibSWMP.set_sources-619"><a href="#LibSWMP.set_sources-619"><span class="linenos">619</span></a><span class="sd">            &gt;&gt;&gt; from pyswmp.data import Sources</span>
</span><span id="LibSWMP.set_sources-620"><a href="#LibSWMP.set_sources-620"><span class="linenos">620</span></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
</span><span id="LibSWMP.set_sources-621"><a href="#LibSWMP.set_sources-621"><span class="linenos">621</span></a><span class="sd">            &gt;&gt;&gt; positions = np.array([[135.0, -25.0], [140.0, -30.0]])</span>
</span><span id="LibSWMP.set_sources-622"><a href="#LibSWMP.set_sources-622"><span class="linenos">622</span></a><span class="sd">            &gt;&gt;&gt; sources = Sources(positions, source_type=1)</span>
</span><span id="LibSWMP.set_sources-623"><a href="#LibSWMP.set_sources-623"><span class="linenos">623</span></a><span class="sd">            &gt;&gt;&gt; lib.set_sources(sources)</span>
</span><span id="LibSWMP.set_sources-624"><a href="#LibSWMP.set_sources-624"><span class="linenos">624</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_sources-625"><a href="#LibSWMP.set_sources-625"><span class="linenos">625</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sources</span>
</span><span id="LibSWMP.set_sources-626"><a href="#LibSWMP.set_sources-626"><span class="linenos">626</span></a>
</span><span id="LibSWMP.set_sources-627"><a href="#LibSWMP.set_sources-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">Sources</span><span class="p">):</span>
</span><span id="LibSWMP.set_sources-628"><a href="#LibSWMP.set_sources-628"><span class="linenos">628</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;sources must be a Sources instance&quot;</span><span class="p">)</span>
</span><span id="LibSWMP.set_sources-629"><a href="#LibSWMP.set_sources-629"><span class="linenos">629</span></a>
</span><span id="LibSWMP.set_sources-630"><a href="#LibSWMP.set_sources-630"><span class="linenos">630</span></a>        <span class="c1"># Ensure positions are Fortran-contiguous (column-major)</span>
</span><span id="LibSWMP.set_sources-631"><a href="#LibSWMP.set_sources-631"><span class="linenos">631</span></a>        <span class="c1"># Fortran expects dimension(n, 2) in column-major order</span>
</span><span id="LibSWMP.set_sources-632"><a href="#LibSWMP.set_sources-632"><span class="linenos">632</span></a>        <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">sources</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="LibSWMP.set_sources-633"><a href="#LibSWMP.set_sources-633"><span class="linenos">633</span></a>
</span><span id="LibSWMP.set_sources-634"><a href="#LibSWMP.set_sources-634"><span class="linenos">634</span></a>        <span class="c1"># Set sources in Fortran</span>
</span><span id="LibSWMP.set_sources-635"><a href="#LibSWMP.set_sources-635"><span class="linenos">635</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_sources_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP.set_sources-636"><a href="#LibSWMP.set_sources-636"><span class="linenos">636</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">sources</span><span class="o">.</span><span class="n">n_sources</span><span class="p">),</span>
</span><span id="LibSWMP.set_sources-637"><a href="#LibSWMP.set_sources-637"><span class="linenos">637</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">sources</span><span class="o">.</span><span class="n">source_type</span><span class="p">),</span>
</span><span id="LibSWMP.set_sources-638"><a href="#LibSWMP.set_sources-638"><span class="linenos">638</span></a>            <span class="n">positions</span>
</span><span id="LibSWMP.set_sources-639"><a href="#LibSWMP.set_sources-639"><span class="linenos">639</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set sources from Sources object (in-memory, no file).</p>

<p>Args:
    sources: Sources instance</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>from pyswmp.data import Sources
      import numpy as np
      positions = np.array([[135.0, -25.0], [140.0, -30.0]])
      sources = Sources(positions, source_type=1)
      lib.set_sources(sources)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="LibSWMP.set_receivers" class="classattr">
                                        <input id="LibSWMP.set_receivers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_receivers</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">receivers</span>, </span><span class="param"><span class="n">max_arrivals</span><span class="o">=</span><span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.set_receivers-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.set_receivers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.set_receivers-641"><a href="#LibSWMP.set_receivers-641"><span class="linenos">641</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_receivers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receivers</span><span class="p">,</span> <span class="n">max_arrivals</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="LibSWMP.set_receivers-642"><a href="#LibSWMP.set_receivers-642"><span class="linenos">642</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set receivers from Receivers object (in-memory, no file).</span>
</span><span id="LibSWMP.set_receivers-643"><a href="#LibSWMP.set_receivers-643"><span class="linenos">643</span></a>
</span><span id="LibSWMP.set_receivers-644"><a href="#LibSWMP.set_receivers-644"><span class="linenos">644</span></a><span class="sd">        Args:</span>
</span><span id="LibSWMP.set_receivers-645"><a href="#LibSWMP.set_receivers-645"><span class="linenos">645</span></a><span class="sd">            receivers: Receivers instance</span>
</span><span id="LibSWMP.set_receivers-646"><a href="#LibSWMP.set_receivers-646"><span class="linenos">646</span></a><span class="sd">            max_arrivals: Maximum number of arrivals per receiver (default: 10)</span>
</span><span id="LibSWMP.set_receivers-647"><a href="#LibSWMP.set_receivers-647"><span class="linenos">647</span></a>
</span><span id="LibSWMP.set_receivers-648"><a href="#LibSWMP.set_receivers-648"><span class="linenos">648</span></a><span class="sd">        Example:</span>
</span><span id="LibSWMP.set_receivers-649"><a href="#LibSWMP.set_receivers-649"><span class="linenos">649</span></a><span class="sd">            &gt;&gt;&gt; from pyswmp.data import Receivers</span>
</span><span id="LibSWMP.set_receivers-650"><a href="#LibSWMP.set_receivers-650"><span class="linenos">650</span></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
</span><span id="LibSWMP.set_receivers-651"><a href="#LibSWMP.set_receivers-651"><span class="linenos">651</span></a><span class="sd">            &gt;&gt;&gt; positions = np.array([[120.0, -30.0], [130.0, -25.0]])</span>
</span><span id="LibSWMP.set_receivers-652"><a href="#LibSWMP.set_receivers-652"><span class="linenos">652</span></a><span class="sd">            &gt;&gt;&gt; receivers = Receivers(positions)</span>
</span><span id="LibSWMP.set_receivers-653"><a href="#LibSWMP.set_receivers-653"><span class="linenos">653</span></a><span class="sd">            &gt;&gt;&gt; lib.set_receivers(receivers, max_arrivals=10)</span>
</span><span id="LibSWMP.set_receivers-654"><a href="#LibSWMP.set_receivers-654"><span class="linenos">654</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.set_receivers-655"><a href="#LibSWMP.set_receivers-655"><span class="linenos">655</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Receivers</span>
</span><span id="LibSWMP.set_receivers-656"><a href="#LibSWMP.set_receivers-656"><span class="linenos">656</span></a>
</span><span id="LibSWMP.set_receivers-657"><a href="#LibSWMP.set_receivers-657"><span class="linenos">657</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">receivers</span><span class="p">,</span> <span class="n">Receivers</span><span class="p">):</span>
</span><span id="LibSWMP.set_receivers-658"><a href="#LibSWMP.set_receivers-658"><span class="linenos">658</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;receivers must be a Receivers instance&quot;</span><span class="p">)</span>
</span><span id="LibSWMP.set_receivers-659"><a href="#LibSWMP.set_receivers-659"><span class="linenos">659</span></a>
</span><span id="LibSWMP.set_receivers-660"><a href="#LibSWMP.set_receivers-660"><span class="linenos">660</span></a>        <span class="c1"># Ensure positions are Fortran-contiguous (column-major)</span>
</span><span id="LibSWMP.set_receivers-661"><a href="#LibSWMP.set_receivers-661"><span class="linenos">661</span></a>        <span class="c1"># Fortran expects dimension(n, 2) in column-major order</span>
</span><span id="LibSWMP.set_receivers-662"><a href="#LibSWMP.set_receivers-662"><span class="linenos">662</span></a>        <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">receivers</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="LibSWMP.set_receivers-663"><a href="#LibSWMP.set_receivers-663"><span class="linenos">663</span></a>
</span><span id="LibSWMP.set_receivers-664"><a href="#LibSWMP.set_receivers-664"><span class="linenos">664</span></a>        <span class="c1"># Set receivers in Fortran</span>
</span><span id="LibSWMP.set_receivers-665"><a href="#LibSWMP.set_receivers-665"><span class="linenos">665</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">set_receivers_from_memory</span><span class="p">(</span>
</span><span id="LibSWMP.set_receivers-666"><a href="#LibSWMP.set_receivers-666"><span class="linenos">666</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">receivers</span><span class="o">.</span><span class="n">n_receivers</span><span class="p">),</span>
</span><span id="LibSWMP.set_receivers-667"><a href="#LibSWMP.set_receivers-667"><span class="linenos">667</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">(</span><span class="n">max_arrivals</span><span class="p">),</span>
</span><span id="LibSWMP.set_receivers-668"><a href="#LibSWMP.set_receivers-668"><span class="linenos">668</span></a>            <span class="n">positions</span>
</span><span id="LibSWMP.set_receivers-669"><a href="#LibSWMP.set_receivers-669"><span class="linenos">669</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set receivers from Receivers object (in-memory, no file).</p>

<p>Args:
    receivers: Receivers instance
    max_arrivals: Maximum number of arrivals per receiver (default: 10)</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>from pyswmp.data import Receivers
      import numpy as np
      positions = np.array([[120.0, -30.0], [130.0, -25.0]])
      receivers = Receivers(positions)
      lib.set_receivers(receivers, max_arrivals=10)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="LibSWMP.get_velocity_model" class="classattr">
                                        <input id="LibSWMP.get_velocity_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_velocity_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LibSWMP.get_velocity_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LibSWMP.get_velocity_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LibSWMP.get_velocity_model-671"><a href="#LibSWMP.get_velocity_model-671"><span class="linenos">671</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_velocity_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LibSWMP.get_velocity_model-672"><a href="#LibSWMP.get_velocity_model-672"><span class="linenos">672</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current velocity model as VelocityModel2D object.</span>
</span><span id="LibSWMP.get_velocity_model-673"><a href="#LibSWMP.get_velocity_model-673"><span class="linenos">673</span></a>
</span><span id="LibSWMP.get_velocity_model-674"><a href="#LibSWMP.get_velocity_model-674"><span class="linenos">674</span></a><span class="sd">        Returns:</span>
</span><span id="LibSWMP.get_velocity_model-675"><a href="#LibSWMP.get_velocity_model-675"><span class="linenos">675</span></a><span class="sd">            VelocityModel2D instance with current model data</span>
</span><span id="LibSWMP.get_velocity_model-676"><a href="#LibSWMP.get_velocity_model-676"><span class="linenos">676</span></a>
</span><span id="LibSWMP.get_velocity_model-677"><a href="#LibSWMP.get_velocity_model-677"><span class="linenos">677</span></a><span class="sd">        Example:</span>
</span><span id="LibSWMP.get_velocity_model-678"><a href="#LibSWMP.get_velocity_model-678"><span class="linenos">678</span></a><span class="sd">            &gt;&gt;&gt; model = lib.get_velocity_model()</span>
</span><span id="LibSWMP.get_velocity_model-679"><a href="#LibSWMP.get_velocity_model-679"><span class="linenos">679</span></a><span class="sd">            &gt;&gt;&gt; print(model.nx, model.ny)</span>
</span><span id="LibSWMP.get_velocity_model-680"><a href="#LibSWMP.get_velocity_model-680"><span class="linenos">680</span></a><span class="sd">            &gt;&gt;&gt; print(model.velocities.shape)</span>
</span><span id="LibSWMP.get_velocity_model-681"><a href="#LibSWMP.get_velocity_model-681"><span class="linenos">681</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LibSWMP.get_velocity_model-682"><a href="#LibSWMP.get_velocity_model-682"><span class="linenos">682</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">VelocityModel2D</span>
</span><span id="LibSWMP.get_velocity_model-683"><a href="#LibSWMP.get_velocity_model-683"><span class="linenos">683</span></a>
</span><span id="LibSWMP.get_velocity_model-684"><a href="#LibSWMP.get_velocity_model-684"><span class="linenos">684</span></a>        <span class="c1"># Get metadata</span>
</span><span id="LibSWMP.get_velocity_model-685"><a href="#LibSWMP.get_velocity_model-685"><span class="linenos">685</span></a>        <span class="n">x0</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="LibSWMP.get_velocity_model-686"><a href="#LibSWMP.get_velocity_model-686"><span class="linenos">686</span></a>        <span class="n">y0</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="LibSWMP.get_velocity_model-687"><a href="#LibSWMP.get_velocity_model-687"><span class="linenos">687</span></a>        <span class="n">nx</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP.get_velocity_model-688"><a href="#LibSWMP.get_velocity_model-688"><span class="linenos">688</span></a>        <span class="n">ny</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP.get_velocity_model-689"><a href="#LibSWMP.get_velocity_model-689"><span class="linenos">689</span></a>        <span class="n">dx</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="LibSWMP.get_velocity_model-690"><a href="#LibSWMP.get_velocity_model-690"><span class="linenos">690</span></a>        <span class="n">dy</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="LibSWMP.get_velocity_model-691"><a href="#LibSWMP.get_velocity_model-691"><span class="linenos">691</span></a>        <span class="n">cn</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">()</span>
</span><span id="LibSWMP.get_velocity_model-692"><a href="#LibSWMP.get_velocity_model-692"><span class="linenos">692</span></a>
</span><span id="LibSWMP.get_velocity_model-693"><a href="#LibSWMP.get_velocity_model-693"><span class="linenos">693</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_model_meta_data</span><span class="p">(</span>
</span><span id="LibSWMP.get_velocity_model-694"><a href="#LibSWMP.get_velocity_model-694"><span class="linenos">694</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-695"><a href="#LibSWMP.get_velocity_model-695"><span class="linenos">695</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">y0</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-696"><a href="#LibSWMP.get_velocity_model-696"><span class="linenos">696</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">nx</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-697"><a href="#LibSWMP.get_velocity_model-697"><span class="linenos">697</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">ny</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-698"><a href="#LibSWMP.get_velocity_model-698"><span class="linenos">698</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">dx</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-699"><a href="#LibSWMP.get_velocity_model-699"><span class="linenos">699</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">dy</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-700"><a href="#LibSWMP.get_velocity_model-700"><span class="linenos">700</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
</span><span id="LibSWMP.get_velocity_model-701"><a href="#LibSWMP.get_velocity_model-701"><span class="linenos">701</span></a>        <span class="p">)</span>
</span><span id="LibSWMP.get_velocity_model-702"><a href="#LibSWMP.get_velocity_model-702"><span class="linenos">702</span></a>
</span><span id="LibSWMP.get_velocity_model-703"><a href="#LibSWMP.get_velocity_model-703"><span class="linenos">703</span></a>        <span class="c1"># Get velocity data</span>
</span><span id="LibSWMP.get_velocity_model-704"><a href="#LibSWMP.get_velocity_model-704"><span class="linenos">704</span></a>        <span class="n">total_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cn</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ny</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cn</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="LibSWMP.get_velocity_model-705"><a href="#LibSWMP.get_velocity_model-705"><span class="linenos">705</span></a>        <span class="n">vel_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">total_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LibSWMP.get_velocity_model-706"><a href="#LibSWMP.get_velocity_model-706"><span class="linenos">706</span></a>
</span><span id="LibSWMP.get_velocity_model-707"><a href="#LibSWMP.get_velocity_model-707"><span class="linenos">707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lib</span><span class="o">.</span><span class="n">get_model_vector</span><span class="p">(</span>
</span><span id="LibSWMP.get_velocity_model-708"><a href="#LibSWMP.get_velocity_model-708"><span class="linenos">708</span></a>            <span class="n">vel_flat</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">)),</span>
</span><span id="LibSWMP.get_velocity_model-709"><a href="#LibSWMP.get_velocity_model-709"><span class="linenos">709</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-710"><a href="#LibSWMP.get_velocity_model-710"><span class="linenos">710</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">y0</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-711"><a href="#LibSWMP.get_velocity_model-711"><span class="linenos">711</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">nx</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-712"><a href="#LibSWMP.get_velocity_model-712"><span class="linenos">712</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">ny</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-713"><a href="#LibSWMP.get_velocity_model-713"><span class="linenos">713</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">dx</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-714"><a href="#LibSWMP.get_velocity_model-714"><span class="linenos">714</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">dy</span><span class="p">),</span>
</span><span id="LibSWMP.get_velocity_model-715"><a href="#LibSWMP.get_velocity_model-715"><span class="linenos">715</span></a>            <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
</span><span id="LibSWMP.get_velocity_model-716"><a href="#LibSWMP.get_velocity_model-716"><span class="linenos">716</span></a>        <span class="p">)</span>
</span><span id="LibSWMP.get_velocity_model-717"><a href="#LibSWMP.get_velocity_model-717"><span class="linenos">717</span></a>
</span><span id="LibSWMP.get_velocity_model-718"><a href="#LibSWMP.get_velocity_model-718"><span class="linenos">718</span></a>        <span class="c1"># Reshape to 2D (without cushion nodes for now)</span>
</span><span id="LibSWMP.get_velocity_model-719"><a href="#LibSWMP.get_velocity_model-719"><span class="linenos">719</span></a>        <span class="n">velocities</span> <span class="o">=</span> <span class="n">vel_flat</span><span class="p">[:</span><span class="n">nx</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">ny</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nx</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ny</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
</span><span id="LibSWMP.get_velocity_model-720"><a href="#LibSWMP.get_velocity_model-720"><span class="linenos">720</span></a>
</span><span id="LibSWMP.get_velocity_model-721"><a href="#LibSWMP.get_velocity_model-721"><span class="linenos">721</span></a>        <span class="k">return</span> <span class="n">VelocityModel2D</span><span class="p">(</span>
</span><span id="LibSWMP.get_velocity_model-722"><a href="#LibSWMP.get_velocity_model-722"><span class="linenos">722</span></a>            <span class="n">velocities</span><span class="o">=</span><span class="n">velocities</span><span class="p">,</span>
</span><span id="LibSWMP.get_velocity_model-723"><a href="#LibSWMP.get_velocity_model-723"><span class="linenos">723</span></a>            <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="LibSWMP.get_velocity_model-724"><a href="#LibSWMP.get_velocity_model-724"><span class="linenos">724</span></a>            <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="LibSWMP.get_velocity_model-725"><a href="#LibSWMP.get_velocity_model-725"><span class="linenos">725</span></a>            <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="LibSWMP.get_velocity_model-726"><a href="#LibSWMP.get_velocity_model-726"><span class="linenos">726</span></a>            <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="LibSWMP.get_velocity_model-727"><a href="#LibSWMP.get_velocity_model-727"><span class="linenos">727</span></a>            <span class="n">cushion_nodes</span><span class="o">=</span><span class="n">cn</span><span class="o">.</span><span class="n">value</span>
</span><span id="LibSWMP.get_velocity_model-728"><a href="#LibSWMP.get_velocity_model-728"><span class="linenos">728</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get current velocity model as VelocityModel2D object.</p>

<p>Returns:
    VelocityModel2D instance with current model data</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>model = lib.get_velocity_model()
      print(model.nx, model.ny)
      print(model.velocities.shape)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                </section>
                <section id="SWMPError">
                            <input id="SWMPError-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SWMPError</span><wbr>(<span class="base">builtins.Exception</span>):

                <label class="view-source-button" for="SWMPError-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SWMPError"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SWMPError-21"><a href="#SWMPError-21"><span class="linenos">21</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SWMPError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="SWMPError-22"><a href="#SWMPError-22"><span class="linenos">22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when SWMP library returns an error.&quot;&quot;&quot;</span>
</span><span id="SWMPError-23"><a href="#SWMPError-23"><span class="linenos">23</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Exception raised when SWMP library returns an error.</p>
</div>


                </section>
                <section id="TrackerOptions">
                            <input id="TrackerOptions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">TrackerOptions</span>:

                <label class="view-source-button" for="TrackerOptions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrackerOptions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrackerOptions-14"><a href="#TrackerOptions-14"><span class="linenos"> 14</span></a><span class="nd">@dataclass</span>
</span><span id="TrackerOptions-15"><a href="#TrackerOptions-15"><span class="linenos"> 15</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TrackerOptions</span><span class="p">:</span>
</span><span id="TrackerOptions-16"><a href="#TrackerOptions-16"><span class="linenos"> 16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration options for wavefront tracking.</span>
</span><span id="TrackerOptions-17"><a href="#TrackerOptions-17"><span class="linenos"> 17</span></a>
</span><span id="TrackerOptions-18"><a href="#TrackerOptions-18"><span class="linenos"> 18</span></a><span class="sd">    This dataclass allows programmatic configuration of all parameters</span>
</span><span id="TrackerOptions-19"><a href="#TrackerOptions-19"><span class="linenos"> 19</span></a><span class="sd">    that are typically specified in RAT configuration files.</span>
</span><span id="TrackerOptions-20"><a href="#TrackerOptions-20"><span class="linenos"> 20</span></a>
</span><span id="TrackerOptions-21"><a href="#TrackerOptions-21"><span class="linenos"> 21</span></a><span class="sd">    Physical/Geometric Parameters:</span>
</span><span id="TrackerOptions-22"><a href="#TrackerOptions-22"><span class="linenos"> 22</span></a><span class="sd">        earth_radius: Radius of Earth in km (default: 6371.0)</span>
</span><span id="TrackerOptions-23"><a href="#TrackerOptions-23"><span class="linenos"> 23</span></a><span class="sd">        coordinate_system: Coordinate system type</span>
</span><span id="TrackerOptions-24"><a href="#TrackerOptions-24"><span class="linenos"> 24</span></a><span class="sd">            1 = Cartesian cubic B-splines (default)</span>
</span><span id="TrackerOptions-25"><a href="#TrackerOptions-25"><span class="linenos"> 25</span></a><span class="sd">            2 = Spherical splines</span>
</span><span id="TrackerOptions-26"><a href="#TrackerOptions-26"><span class="linenos"> 26</span></a>
</span><span id="TrackerOptions-27"><a href="#TrackerOptions-27"><span class="linenos"> 27</span></a><span class="sd">    Integration Parameters:</span>
</span><span id="TrackerOptions-28"><a href="#TrackerOptions-28"><span class="linenos"> 28</span></a><span class="sd">        dt: ODE solver time step size (default: 5.0)</span>
</span><span id="TrackerOptions-29"><a href="#TrackerOptions-29"><span class="linenos"> 29</span></a><span class="sd">        max_iterations: Maximum number of iterations (default: 500)</span>
</span><span id="TrackerOptions-30"><a href="#TrackerOptions-30"><span class="linenos"> 30</span></a><span class="sd">        n_bichar_nodes: Number of nodes on bicharacteristic strip (default: 75)</span>
</span><span id="TrackerOptions-31"><a href="#TrackerOptions-31"><span class="linenos"> 31</span></a><span class="sd">        ode_solver: ODE solver type (default: 1)</span>
</span><span id="TrackerOptions-32"><a href="#TrackerOptions-32"><span class="linenos"> 32</span></a><span class="sd">            1 = 4th order Runge-Kutta</span>
</span><span id="TrackerOptions-33"><a href="#TrackerOptions-33"><span class="linenos"> 33</span></a><span class="sd">            2 = 5th order Runge-Kutta</span>
</span><span id="TrackerOptions-34"><a href="#TrackerOptions-34"><span class="linenos"> 34</span></a><span class="sd">            3 = 5th order adaptive Runge-Kutta</span>
</span><span id="TrackerOptions-35"><a href="#TrackerOptions-35"><span class="linenos"> 35</span></a><span class="sd">        interpolator: Velocity interpolation method (default: 1)</span>
</span><span id="TrackerOptions-36"><a href="#TrackerOptions-36"><span class="linenos"> 36</span></a><span class="sd">            1 = Linear interpolation</span>
</span><span id="TrackerOptions-37"><a href="#TrackerOptions-37"><span class="linenos"> 37</span></a><span class="sd">            2 = Weighted average</span>
</span><span id="TrackerOptions-38"><a href="#TrackerOptions-38"><span class="linenos"> 38</span></a>
</span><span id="TrackerOptions-39"><a href="#TrackerOptions-39"><span class="linenos"> 39</span></a><span class="sd">    Computation Options:</span>
</span><span id="TrackerOptions-40"><a href="#TrackerOptions-40"><span class="linenos"> 40</span></a><span class="sd">        computation_mode: What to compute (default: 1)</span>
</span><span id="TrackerOptions-41"><a href="#TrackerOptions-41"><span class="linenos"> 41</span></a><span class="sd">            1 = Kinematic ray tracing only</span>
</span><span id="TrackerOptions-42"><a href="#TrackerOptions-42"><span class="linenos"> 42</span></a><span class="sd">            2 = Kinematic ray tracing + spreading factors</span>
</span><span id="TrackerOptions-43"><a href="#TrackerOptions-43"><span class="linenos"> 43</span></a><span class="sd">        max_arrivals: Maximum number of arrivals per receiver (default: 10)</span>
</span><span id="TrackerOptions-44"><a href="#TrackerOptions-44"><span class="linenos"> 44</span></a><span class="sd">        source_specific_receivers: Use source-specific receiver configuration (default: True)</span>
</span><span id="TrackerOptions-45"><a href="#TrackerOptions-45"><span class="linenos"> 45</span></a>
</span><span id="TrackerOptions-46"><a href="#TrackerOptions-46"><span class="linenos"> 46</span></a><span class="sd">    Output Options:</span>
</span><span id="TrackerOptions-47"><a href="#TrackerOptions-47"><span class="linenos"> 47</span></a><span class="sd">        extract_raypaths: Extract ray path data (default: False)</span>
</span><span id="TrackerOptions-48"><a href="#TrackerOptions-48"><span class="linenos"> 48</span></a><span class="sd">        extract_wavefronts: Extract wavefront data (default: False)</span>
</span><span id="TrackerOptions-49"><a href="#TrackerOptions-49"><span class="linenos"> 49</span></a><span class="sd">        extract_frechet: Compute Frchet derivatives (default: False)</span>
</span><span id="TrackerOptions-50"><a href="#TrackerOptions-50"><span class="linenos"> 50</span></a><span class="sd">        raypath_storage: Ray storage mode (default: 2)</span>
</span><span id="TrackerOptions-51"><a href="#TrackerOptions-51"><span class="linenos"> 51</span></a><span class="sd">            0 = No storage</span>
</span><span id="TrackerOptions-52"><a href="#TrackerOptions-52"><span class="linenos"> 52</span></a><span class="sd">            1 = One file</span>
</span><span id="TrackerOptions-53"><a href="#TrackerOptions-53"><span class="linenos"> 53</span></a><span class="sd">            2 = Sorted by arrival</span>
</span><span id="TrackerOptions-54"><a href="#TrackerOptions-54"><span class="linenos"> 54</span></a><span class="sd">            3 = Both formats</span>
</span><span id="TrackerOptions-55"><a href="#TrackerOptions-55"><span class="linenos"> 55</span></a><span class="sd">        wavefront_interval: Store every n-th wavefront (default: 100)</span>
</span><span id="TrackerOptions-56"><a href="#TrackerOptions-56"><span class="linenos"> 56</span></a>
</span><span id="TrackerOptions-57"><a href="#TrackerOptions-57"><span class="linenos"> 57</span></a><span class="sd">    File Paths:</span>
</span><span id="TrackerOptions-58"><a href="#TrackerOptions-58"><span class="linenos"> 58</span></a><span class="sd">        velocity_file: Path to velocity model file (optional)</span>
</span><span id="TrackerOptions-59"><a href="#TrackerOptions-59"><span class="linenos"> 59</span></a><span class="sd">        sources_file: Path to sources file (optional)</span>
</span><span id="TrackerOptions-60"><a href="#TrackerOptions-60"><span class="linenos"> 60</span></a><span class="sd">        receivers_file: Path to receivers file (optional)</span>
</span><span id="TrackerOptions-61"><a href="#TrackerOptions-61"><span class="linenos"> 61</span></a><span class="sd">        receiver_mode_file: Path to receiver mode configuration (optional)</span>
</span><span id="TrackerOptions-62"><a href="#TrackerOptions-62"><span class="linenos"> 62</span></a>
</span><span id="TrackerOptions-63"><a href="#TrackerOptions-63"><span class="linenos"> 63</span></a><span class="sd">    Example:</span>
</span><span id="TrackerOptions-64"><a href="#TrackerOptions-64"><span class="linenos"> 64</span></a><span class="sd">        &gt;&gt;&gt; # Create default options</span>
</span><span id="TrackerOptions-65"><a href="#TrackerOptions-65"><span class="linenos"> 65</span></a><span class="sd">        &gt;&gt;&gt; opts = TrackerOptions()</span>
</span><span id="TrackerOptions-66"><a href="#TrackerOptions-66"><span class="linenos"> 66</span></a>
</span><span id="TrackerOptions-67"><a href="#TrackerOptions-67"><span class="linenos"> 67</span></a><span class="sd">        &gt;&gt;&gt; # Customize parameters</span>
</span><span id="TrackerOptions-68"><a href="#TrackerOptions-68"><span class="linenos"> 68</span></a><span class="sd">        &gt;&gt;&gt; opts = TrackerOptions(</span>
</span><span id="TrackerOptions-69"><a href="#TrackerOptions-69"><span class="linenos"> 69</span></a><span class="sd">        ...     dt=2.0,</span>
</span><span id="TrackerOptions-70"><a href="#TrackerOptions-70"><span class="linenos"> 70</span></a><span class="sd">        ...     max_iterations=1000,</span>
</span><span id="TrackerOptions-71"><a href="#TrackerOptions-71"><span class="linenos"> 71</span></a><span class="sd">        ...     extract_raypaths=True,</span>
</span><span id="TrackerOptions-72"><a href="#TrackerOptions-72"><span class="linenos"> 72</span></a><span class="sd">        ...     computation_mode=2  # Include spreading factors</span>
</span><span id="TrackerOptions-73"><a href="#TrackerOptions-73"><span class="linenos"> 73</span></a><span class="sd">        ... )</span>
</span><span id="TrackerOptions-74"><a href="#TrackerOptions-74"><span class="linenos"> 74</span></a>
</span><span id="TrackerOptions-75"><a href="#TrackerOptions-75"><span class="linenos"> 75</span></a><span class="sd">        &gt;&gt;&gt; # Use with WaveFrontTracker</span>
</span><span id="TrackerOptions-76"><a href="#TrackerOptions-76"><span class="linenos"> 76</span></a><span class="sd">        &gt;&gt;&gt; tracker = WaveFrontTracker(options=opts)</span>
</span><span id="TrackerOptions-77"><a href="#TrackerOptions-77"><span class="linenos"> 77</span></a><span class="sd">        &gt;&gt;&gt; result = tracker.forward()</span>
</span><span id="TrackerOptions-78"><a href="#TrackerOptions-78"><span class="linenos"> 78</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TrackerOptions-79"><a href="#TrackerOptions-79"><span class="linenos"> 79</span></a>
</span><span id="TrackerOptions-80"><a href="#TrackerOptions-80"><span class="linenos"> 80</span></a>    <span class="c1"># Physical/geometric parameters</span>
</span><span id="TrackerOptions-81"><a href="#TrackerOptions-81"><span class="linenos"> 81</span></a>    <span class="n">earth_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">6371.0</span>
</span><span id="TrackerOptions-82"><a href="#TrackerOptions-82"><span class="linenos"> 82</span></a>    <span class="n">coordinate_system</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="TrackerOptions-83"><a href="#TrackerOptions-83"><span class="linenos"> 83</span></a>
</span><span id="TrackerOptions-84"><a href="#TrackerOptions-84"><span class="linenos"> 84</span></a>    <span class="c1"># Integration parameters</span>
</span><span id="TrackerOptions-85"><a href="#TrackerOptions-85"><span class="linenos"> 85</span></a>    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span>
</span><span id="TrackerOptions-86"><a href="#TrackerOptions-86"><span class="linenos"> 86</span></a>    <span class="n">max_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span>
</span><span id="TrackerOptions-87"><a href="#TrackerOptions-87"><span class="linenos"> 87</span></a>    <span class="n">n_bichar_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">75</span>
</span><span id="TrackerOptions-88"><a href="#TrackerOptions-88"><span class="linenos"> 88</span></a>    <span class="n">ode_solver</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="TrackerOptions-89"><a href="#TrackerOptions-89"><span class="linenos"> 89</span></a>    <span class="n">interpolator</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="TrackerOptions-90"><a href="#TrackerOptions-90"><span class="linenos"> 90</span></a>
</span><span id="TrackerOptions-91"><a href="#TrackerOptions-91"><span class="linenos"> 91</span></a>    <span class="c1"># Computation options</span>
</span><span id="TrackerOptions-92"><a href="#TrackerOptions-92"><span class="linenos"> 92</span></a>    <span class="n">computation_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="TrackerOptions-93"><a href="#TrackerOptions-93"><span class="linenos"> 93</span></a>    <span class="n">max_arrivals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="TrackerOptions-94"><a href="#TrackerOptions-94"><span class="linenos"> 94</span></a>    <span class="n">source_specific_receivers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TrackerOptions-95"><a href="#TrackerOptions-95"><span class="linenos"> 95</span></a>
</span><span id="TrackerOptions-96"><a href="#TrackerOptions-96"><span class="linenos"> 96</span></a>    <span class="c1"># Output options</span>
</span><span id="TrackerOptions-97"><a href="#TrackerOptions-97"><span class="linenos"> 97</span></a>    <span class="n">extract_raypaths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrackerOptions-98"><a href="#TrackerOptions-98"><span class="linenos"> 98</span></a>    <span class="n">extract_wavefronts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrackerOptions-99"><a href="#TrackerOptions-99"><span class="linenos"> 99</span></a>    <span class="n">extract_frechet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrackerOptions-100"><a href="#TrackerOptions-100"><span class="linenos">100</span></a>    <span class="n">raypath_storage</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="TrackerOptions-101"><a href="#TrackerOptions-101"><span class="linenos">101</span></a>    <span class="n">wavefront_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="TrackerOptions-102"><a href="#TrackerOptions-102"><span class="linenos">102</span></a>
</span><span id="TrackerOptions-103"><a href="#TrackerOptions-103"><span class="linenos">103</span></a>    <span class="c1"># File paths (optional - can be provided separately)</span>
</span><span id="TrackerOptions-104"><a href="#TrackerOptions-104"><span class="linenos">104</span></a>    <span class="n">velocity_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TrackerOptions-105"><a href="#TrackerOptions-105"><span class="linenos">105</span></a>    <span class="n">sources_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TrackerOptions-106"><a href="#TrackerOptions-106"><span class="linenos">106</span></a>    <span class="n">receivers_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TrackerOptions-107"><a href="#TrackerOptions-107"><span class="linenos">107</span></a>    <span class="n">receiver_mode_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TrackerOptions-108"><a href="#TrackerOptions-108"><span class="linenos">108</span></a>
</span><span id="TrackerOptions-109"><a href="#TrackerOptions-109"><span class="linenos">109</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TrackerOptions-110"><a href="#TrackerOptions-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate parameters after initialization.&quot;&quot;&quot;</span>
</span><span id="TrackerOptions-111"><a href="#TrackerOptions-111"><span class="linenos">111</span></a>        <span class="c1"># Validate coordinate system</span>
</span><span id="TrackerOptions-112"><a href="#TrackerOptions-112"><span class="linenos">112</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate_system</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
</span><span id="TrackerOptions-113"><a href="#TrackerOptions-113"><span class="linenos">113</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;coordinate_system must be 1 or 2, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">coordinate_system</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-114"><a href="#TrackerOptions-114"><span class="linenos">114</span></a>
</span><span id="TrackerOptions-115"><a href="#TrackerOptions-115"><span class="linenos">115</span></a>        <span class="c1"># Validate ODE solver</span>
</span><span id="TrackerOptions-116"><a href="#TrackerOptions-116"><span class="linenos">116</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ode_solver</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
</span><span id="TrackerOptions-117"><a href="#TrackerOptions-117"><span class="linenos">117</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ode_solver must be 1, 2, or 3, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ode_solver</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-118"><a href="#TrackerOptions-118"><span class="linenos">118</span></a>
</span><span id="TrackerOptions-119"><a href="#TrackerOptions-119"><span class="linenos">119</span></a>        <span class="c1"># Validate interpolator</span>
</span><span id="TrackerOptions-120"><a href="#TrackerOptions-120"><span class="linenos">120</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolator</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
</span><span id="TrackerOptions-121"><a href="#TrackerOptions-121"><span class="linenos">121</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;interpolator must be 1 or 2, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolator</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-122"><a href="#TrackerOptions-122"><span class="linenos">122</span></a>
</span><span id="TrackerOptions-123"><a href="#TrackerOptions-123"><span class="linenos">123</span></a>        <span class="c1"># Validate computation mode</span>
</span><span id="TrackerOptions-124"><a href="#TrackerOptions-124"><span class="linenos">124</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">computation_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
</span><span id="TrackerOptions-125"><a href="#TrackerOptions-125"><span class="linenos">125</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;computation_mode must be 1 or 2, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">computation_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-126"><a href="#TrackerOptions-126"><span class="linenos">126</span></a>
</span><span id="TrackerOptions-127"><a href="#TrackerOptions-127"><span class="linenos">127</span></a>        <span class="c1"># Validate raypath storage</span>
</span><span id="TrackerOptions-128"><a href="#TrackerOptions-128"><span class="linenos">128</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">raypath_storage</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
</span><span id="TrackerOptions-129"><a href="#TrackerOptions-129"><span class="linenos">129</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;raypath_storage must be 0, 1, 2, or 3, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">raypath_storage</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-130"><a href="#TrackerOptions-130"><span class="linenos">130</span></a>
</span><span id="TrackerOptions-131"><a href="#TrackerOptions-131"><span class="linenos">131</span></a>        <span class="c1"># Validate positive parameters</span>
</span><span id="TrackerOptions-132"><a href="#TrackerOptions-132"><span class="linenos">132</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrackerOptions-133"><a href="#TrackerOptions-133"><span class="linenos">133</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dt must be positive, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-134"><a href="#TrackerOptions-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrackerOptions-135"><a href="#TrackerOptions-135"><span class="linenos">135</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_iterations must be positive, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-136"><a href="#TrackerOptions-136"><span class="linenos">136</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bichar_nodes</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrackerOptions-137"><a href="#TrackerOptions-137"><span class="linenos">137</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n_bichar_nodes must be positive, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bichar_nodes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-138"><a href="#TrackerOptions-138"><span class="linenos">138</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_arrivals</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrackerOptions-139"><a href="#TrackerOptions-139"><span class="linenos">139</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_arrivals must be positive, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_arrivals</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-140"><a href="#TrackerOptions-140"><span class="linenos">140</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">earth_radius</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrackerOptions-141"><a href="#TrackerOptions-141"><span class="linenos">141</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;earth_radius must be positive, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">earth_radius</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-142"><a href="#TrackerOptions-142"><span class="linenos">142</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavefront_interval</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrackerOptions-143"><a href="#TrackerOptions-143"><span class="linenos">143</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;wavefront_interval must be positive, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">wavefront_interval</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-144"><a href="#TrackerOptions-144"><span class="linenos">144</span></a>
</span><span id="TrackerOptions-145"><a href="#TrackerOptions-145"><span class="linenos">145</span></a>        <span class="c1"># Convert file paths to Path objects if provided</span>
</span><span id="TrackerOptions-146"><a href="#TrackerOptions-146"><span class="linenos">146</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TrackerOptions-147"><a href="#TrackerOptions-147"><span class="linenos">147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity_file</span><span class="p">))</span>
</span><span id="TrackerOptions-148"><a href="#TrackerOptions-148"><span class="linenos">148</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TrackerOptions-149"><a href="#TrackerOptions-149"><span class="linenos">149</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sources_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources_file</span><span class="p">))</span>
</span><span id="TrackerOptions-150"><a href="#TrackerOptions-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">receivers_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TrackerOptions-151"><a href="#TrackerOptions-151"><span class="linenos">151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">receivers_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">receivers_file</span><span class="p">))</span>
</span><span id="TrackerOptions-152"><a href="#TrackerOptions-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">receiver_mode_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TrackerOptions-153"><a href="#TrackerOptions-153"><span class="linenos">153</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">receiver_mode_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">receiver_mode_file</span><span class="p">))</span>
</span><span id="TrackerOptions-154"><a href="#TrackerOptions-154"><span class="linenos">154</span></a>
</span><span id="TrackerOptions-155"><a href="#TrackerOptions-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="TrackerOptions-156"><a href="#TrackerOptions-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert options to dictionary.</span>
</span><span id="TrackerOptions-157"><a href="#TrackerOptions-157"><span class="linenos">157</span></a>
</span><span id="TrackerOptions-158"><a href="#TrackerOptions-158"><span class="linenos">158</span></a><span class="sd">        Returns:</span>
</span><span id="TrackerOptions-159"><a href="#TrackerOptions-159"><span class="linenos">159</span></a><span class="sd">            Dictionary with all option values</span>
</span><span id="TrackerOptions-160"><a href="#TrackerOptions-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TrackerOptions-161"><a href="#TrackerOptions-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="TrackerOptions-162"><a href="#TrackerOptions-162"><span class="linenos">162</span></a>            <span class="s1">&#39;earth_radius&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">earth_radius</span><span class="p">,</span>
</span><span id="TrackerOptions-163"><a href="#TrackerOptions-163"><span class="linenos">163</span></a>            <span class="s1">&#39;coordinate_system&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate_system</span><span class="p">,</span>
</span><span id="TrackerOptions-164"><a href="#TrackerOptions-164"><span class="linenos">164</span></a>            <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span>
</span><span id="TrackerOptions-165"><a href="#TrackerOptions-165"><span class="linenos">165</span></a>            <span class="s1">&#39;max_iterations&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">,</span>
</span><span id="TrackerOptions-166"><a href="#TrackerOptions-166"><span class="linenos">166</span></a>            <span class="s1">&#39;n_bichar_nodes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bichar_nodes</span><span class="p">,</span>
</span><span id="TrackerOptions-167"><a href="#TrackerOptions-167"><span class="linenos">167</span></a>            <span class="s1">&#39;ode_solver&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ode_solver</span><span class="p">,</span>
</span><span id="TrackerOptions-168"><a href="#TrackerOptions-168"><span class="linenos">168</span></a>            <span class="s1">&#39;interpolator&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolator</span><span class="p">,</span>
</span><span id="TrackerOptions-169"><a href="#TrackerOptions-169"><span class="linenos">169</span></a>            <span class="s1">&#39;computation_mode&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">computation_mode</span><span class="p">,</span>
</span><span id="TrackerOptions-170"><a href="#TrackerOptions-170"><span class="linenos">170</span></a>            <span class="s1">&#39;max_arrivals&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_arrivals</span><span class="p">,</span>
</span><span id="TrackerOptions-171"><a href="#TrackerOptions-171"><span class="linenos">171</span></a>            <span class="s1">&#39;source_specific_receivers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_specific_receivers</span><span class="p">,</span>
</span><span id="TrackerOptions-172"><a href="#TrackerOptions-172"><span class="linenos">172</span></a>            <span class="s1">&#39;extract_raypaths&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_raypaths</span><span class="p">,</span>
</span><span id="TrackerOptions-173"><a href="#TrackerOptions-173"><span class="linenos">173</span></a>            <span class="s1">&#39;extract_wavefronts&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_wavefronts</span><span class="p">,</span>
</span><span id="TrackerOptions-174"><a href="#TrackerOptions-174"><span class="linenos">174</span></a>            <span class="s1">&#39;extract_frechet&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_frechet</span><span class="p">,</span>
</span><span id="TrackerOptions-175"><a href="#TrackerOptions-175"><span class="linenos">175</span></a>            <span class="s1">&#39;raypath_storage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">raypath_storage</span><span class="p">,</span>
</span><span id="TrackerOptions-176"><a href="#TrackerOptions-176"><span class="linenos">176</span></a>            <span class="s1">&#39;wavefront_interval&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavefront_interval</span><span class="p">,</span>
</span><span id="TrackerOptions-177"><a href="#TrackerOptions-177"><span class="linenos">177</span></a>            <span class="s1">&#39;velocity_file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_file</span><span class="p">,</span>
</span><span id="TrackerOptions-178"><a href="#TrackerOptions-178"><span class="linenos">178</span></a>            <span class="s1">&#39;sources_file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources_file</span><span class="p">,</span>
</span><span id="TrackerOptions-179"><a href="#TrackerOptions-179"><span class="linenos">179</span></a>            <span class="s1">&#39;receivers_file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">receivers_file</span><span class="p">,</span>
</span><span id="TrackerOptions-180"><a href="#TrackerOptions-180"><span class="linenos">180</span></a>            <span class="s1">&#39;receiver_mode_file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">receiver_mode_file</span><span class="p">,</span>
</span><span id="TrackerOptions-181"><a href="#TrackerOptions-181"><span class="linenos">181</span></a>        <span class="p">}</span>
</span><span id="TrackerOptions-182"><a href="#TrackerOptions-182"><span class="linenos">182</span></a>
</span><span id="TrackerOptions-183"><a href="#TrackerOptions-183"><span class="linenos">183</span></a>    <span class="nd">@classmethod</span>
</span><span id="TrackerOptions-184"><a href="#TrackerOptions-184"><span class="linenos">184</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_config_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TrackerOptions&#39;</span><span class="p">:</span>
</span><span id="TrackerOptions-185"><a href="#TrackerOptions-185"><span class="linenos">185</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse options from RAT configuration file.</span>
</span><span id="TrackerOptions-186"><a href="#TrackerOptions-186"><span class="linenos">186</span></a>
</span><span id="TrackerOptions-187"><a href="#TrackerOptions-187"><span class="linenos">187</span></a><span class="sd">        Args:</span>
</span><span id="TrackerOptions-188"><a href="#TrackerOptions-188"><span class="linenos">188</span></a><span class="sd">            config_file: Path to RAT configuration file</span>
</span><span id="TrackerOptions-189"><a href="#TrackerOptions-189"><span class="linenos">189</span></a>
</span><span id="TrackerOptions-190"><a href="#TrackerOptions-190"><span class="linenos">190</span></a><span class="sd">        Returns:</span>
</span><span id="TrackerOptions-191"><a href="#TrackerOptions-191"><span class="linenos">191</span></a><span class="sd">            TrackerOptions instance with parameters from file</span>
</span><span id="TrackerOptions-192"><a href="#TrackerOptions-192"><span class="linenos">192</span></a>
</span><span id="TrackerOptions-193"><a href="#TrackerOptions-193"><span class="linenos">193</span></a><span class="sd">        Example:</span>
</span><span id="TrackerOptions-194"><a href="#TrackerOptions-194"><span class="linenos">194</span></a><span class="sd">            &gt;&gt;&gt; opts = TrackerOptions.from_config_file(&#39;config.in&#39;)</span>
</span><span id="TrackerOptions-195"><a href="#TrackerOptions-195"><span class="linenos">195</span></a><span class="sd">            &gt;&gt;&gt; opts.dt = 2.0  # Override specific parameters</span>
</span><span id="TrackerOptions-196"><a href="#TrackerOptions-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TrackerOptions-197"><a href="#TrackerOptions-197"><span class="linenos">197</span></a>        <span class="n">config_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
</span><span id="TrackerOptions-198"><a href="#TrackerOptions-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="TrackerOptions-199"><a href="#TrackerOptions-199"><span class="linenos">199</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuration file not found: </span><span class="si">{</span><span class="n">config_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions-200"><a href="#TrackerOptions-200"><span class="linenos">200</span></a>
</span><span id="TrackerOptions-201"><a href="#TrackerOptions-201"><span class="linenos">201</span></a>        <span class="c1"># Read configuration file</span>
</span><span id="TrackerOptions-202"><a href="#TrackerOptions-202"><span class="linenos">202</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="TrackerOptions-203"><a href="#TrackerOptions-203"><span class="linenos">203</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">)]</span>
</span><span id="TrackerOptions-204"><a href="#TrackerOptions-204"><span class="linenos">204</span></a>
</span><span id="TrackerOptions-205"><a href="#TrackerOptions-205"><span class="linenos">205</span></a>        <span class="c1"># Parse file paths (first 3 non-empty lines)</span>
</span><span id="TrackerOptions-206"><a href="#TrackerOptions-206"><span class="linenos">206</span></a>        <span class="n">velocity_file</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="TrackerOptions-207"><a href="#TrackerOptions-207"><span class="linenos">207</span></a>        <span class="n">sources_file</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="TrackerOptions-208"><a href="#TrackerOptions-208"><span class="linenos">208</span></a>        <span class="n">receivers_file</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="TrackerOptions-209"><a href="#TrackerOptions-209"><span class="linenos">209</span></a>
</span><span id="TrackerOptions-210"><a href="#TrackerOptions-210"><span class="linenos">210</span></a>        <span class="c1"># Parse numeric parameters (next section)</span>
</span><span id="TrackerOptions-211"><a href="#TrackerOptions-211"><span class="linenos">211</span></a>        <span class="n">dt</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="mf">5.0</span>
</span><span id="TrackerOptions-212"><a href="#TrackerOptions-212"><span class="linenos">212</span></a>        <span class="n">max_iterations</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="k">else</span> <span class="mi">500</span>
</span><span id="TrackerOptions-213"><a href="#TrackerOptions-213"><span class="linenos">213</span></a>        <span class="n">n_bichar_nodes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="mi">75</span>
</span><span id="TrackerOptions-214"><a href="#TrackerOptions-214"><span class="linenos">214</span></a>        <span class="n">computation_mode</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">6</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="TrackerOptions-215"><a href="#TrackerOptions-215"><span class="linenos">215</span></a>        <span class="n">ode_solver</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="TrackerOptions-216"><a href="#TrackerOptions-216"><span class="linenos">216</span></a>        <span class="n">interpolator</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">8</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="TrackerOptions-217"><a href="#TrackerOptions-217"><span class="linenos">217</span></a>        <span class="n">max_arrivals</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">9</span> <span class="k">else</span> <span class="mi">10</span>
</span><span id="TrackerOptions-218"><a href="#TrackerOptions-218"><span class="linenos">218</span></a>        <span class="n">coordinate_system</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="TrackerOptions-219"><a href="#TrackerOptions-219"><span class="linenos">219</span></a>        <span class="n">earth_radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">11</span> <span class="k">else</span> <span class="mf">6371.0</span>
</span><span id="TrackerOptions-220"><a href="#TrackerOptions-220"><span class="linenos">220</span></a>        <span class="n">source_specific_receivers</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">12</span><span class="p">]))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">12</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="TrackerOptions-221"><a href="#TrackerOptions-221"><span class="linenos">221</span></a>        <span class="n">receiver_mode_file</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">13</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="TrackerOptions-222"><a href="#TrackerOptions-222"><span class="linenos">222</span></a>
</span><span id="TrackerOptions-223"><a href="#TrackerOptions-223"><span class="linenos">223</span></a>        <span class="c1"># Parse output parameters</span>
</span><span id="TrackerOptions-224"><a href="#TrackerOptions-224"><span class="linenos">224</span></a>        <span class="n">wavefront_interval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">14</span> <span class="k">else</span> <span class="mi">100</span>
</span><span id="TrackerOptions-225"><a href="#TrackerOptions-225"><span class="linenos">225</span></a>        <span class="n">extract_raypaths</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">15</span><span class="p">]))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">15</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="TrackerOptions-226"><a href="#TrackerOptions-226"><span class="linenos">226</span></a>        <span class="n">raypath_storage</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="k">else</span> <span class="mi">2</span>
</span><span id="TrackerOptions-227"><a href="#TrackerOptions-227"><span class="linenos">227</span></a>        <span class="n">extract_frechet</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">17</span><span class="p">]))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">17</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="TrackerOptions-228"><a href="#TrackerOptions-228"><span class="linenos">228</span></a>
</span><span id="TrackerOptions-229"><a href="#TrackerOptions-229"><span class="linenos">229</span></a>        <span class="c1"># Resolve file paths relative to config file directory</span>
</span><span id="TrackerOptions-230"><a href="#TrackerOptions-230"><span class="linenos">230</span></a>        <span class="n">config_dir</span> <span class="o">=</span> <span class="n">config_path</span><span class="o">.</span><span class="n">parent</span>
</span><span id="TrackerOptions-231"><a href="#TrackerOptions-231"><span class="linenos">231</span></a>        <span class="k">if</span> <span class="n">velocity_file</span><span class="p">:</span>
</span><span id="TrackerOptions-232"><a href="#TrackerOptions-232"><span class="linenos">232</span></a>            <span class="n">velocity_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">velocity_file</span><span class="p">)</span>
</span><span id="TrackerOptions-233"><a href="#TrackerOptions-233"><span class="linenos">233</span></a>        <span class="k">if</span> <span class="n">sources_file</span><span class="p">:</span>
</span><span id="TrackerOptions-234"><a href="#TrackerOptions-234"><span class="linenos">234</span></a>            <span class="n">sources_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">sources_file</span><span class="p">)</span>
</span><span id="TrackerOptions-235"><a href="#TrackerOptions-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="n">receivers_file</span><span class="p">:</span>
</span><span id="TrackerOptions-236"><a href="#TrackerOptions-236"><span class="linenos">236</span></a>            <span class="n">receivers_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">receivers_file</span><span class="p">)</span>
</span><span id="TrackerOptions-237"><a href="#TrackerOptions-237"><span class="linenos">237</span></a>        <span class="k">if</span> <span class="n">receiver_mode_file</span><span class="p">:</span>
</span><span id="TrackerOptions-238"><a href="#TrackerOptions-238"><span class="linenos">238</span></a>            <span class="n">receiver_mode_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">receiver_mode_file</span><span class="p">)</span>
</span><span id="TrackerOptions-239"><a href="#TrackerOptions-239"><span class="linenos">239</span></a>
</span><span id="TrackerOptions-240"><a href="#TrackerOptions-240"><span class="linenos">240</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="TrackerOptions-241"><a href="#TrackerOptions-241"><span class="linenos">241</span></a>            <span class="n">earth_radius</span><span class="o">=</span><span class="n">earth_radius</span><span class="p">,</span>
</span><span id="TrackerOptions-242"><a href="#TrackerOptions-242"><span class="linenos">242</span></a>            <span class="n">coordinate_system</span><span class="o">=</span><span class="n">coordinate_system</span><span class="p">,</span>
</span><span id="TrackerOptions-243"><a href="#TrackerOptions-243"><span class="linenos">243</span></a>            <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
</span><span id="TrackerOptions-244"><a href="#TrackerOptions-244"><span class="linenos">244</span></a>            <span class="n">max_iterations</span><span class="o">=</span><span class="n">max_iterations</span><span class="p">,</span>
</span><span id="TrackerOptions-245"><a href="#TrackerOptions-245"><span class="linenos">245</span></a>            <span class="n">n_bichar_nodes</span><span class="o">=</span><span class="n">n_bichar_nodes</span><span class="p">,</span>
</span><span id="TrackerOptions-246"><a href="#TrackerOptions-246"><span class="linenos">246</span></a>            <span class="n">ode_solver</span><span class="o">=</span><span class="n">ode_solver</span><span class="p">,</span>
</span><span id="TrackerOptions-247"><a href="#TrackerOptions-247"><span class="linenos">247</span></a>            <span class="n">interpolator</span><span class="o">=</span><span class="n">interpolator</span><span class="p">,</span>
</span><span id="TrackerOptions-248"><a href="#TrackerOptions-248"><span class="linenos">248</span></a>            <span class="n">computation_mode</span><span class="o">=</span><span class="n">computation_mode</span><span class="p">,</span>
</span><span id="TrackerOptions-249"><a href="#TrackerOptions-249"><span class="linenos">249</span></a>            <span class="n">max_arrivals</span><span class="o">=</span><span class="n">max_arrivals</span><span class="p">,</span>
</span><span id="TrackerOptions-250"><a href="#TrackerOptions-250"><span class="linenos">250</span></a>            <span class="n">source_specific_receivers</span><span class="o">=</span><span class="n">source_specific_receivers</span><span class="p">,</span>
</span><span id="TrackerOptions-251"><a href="#TrackerOptions-251"><span class="linenos">251</span></a>            <span class="n">extract_raypaths</span><span class="o">=</span><span class="n">extract_raypaths</span><span class="p">,</span>
</span><span id="TrackerOptions-252"><a href="#TrackerOptions-252"><span class="linenos">252</span></a>            <span class="n">extract_wavefronts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Not in config file</span>
</span><span id="TrackerOptions-253"><a href="#TrackerOptions-253"><span class="linenos">253</span></a>            <span class="n">extract_frechet</span><span class="o">=</span><span class="n">extract_frechet</span><span class="p">,</span>
</span><span id="TrackerOptions-254"><a href="#TrackerOptions-254"><span class="linenos">254</span></a>            <span class="n">raypath_storage</span><span class="o">=</span><span class="n">raypath_storage</span><span class="p">,</span>
</span><span id="TrackerOptions-255"><a href="#TrackerOptions-255"><span class="linenos">255</span></a>            <span class="n">wavefront_interval</span><span class="o">=</span><span class="n">wavefront_interval</span><span class="p">,</span>
</span><span id="TrackerOptions-256"><a href="#TrackerOptions-256"><span class="linenos">256</span></a>            <span class="n">velocity_file</span><span class="o">=</span><span class="n">velocity_file</span><span class="p">,</span>
</span><span id="TrackerOptions-257"><a href="#TrackerOptions-257"><span class="linenos">257</span></a>            <span class="n">sources_file</span><span class="o">=</span><span class="n">sources_file</span><span class="p">,</span>
</span><span id="TrackerOptions-258"><a href="#TrackerOptions-258"><span class="linenos">258</span></a>            <span class="n">receivers_file</span><span class="o">=</span><span class="n">receivers_file</span><span class="p">,</span>
</span><span id="TrackerOptions-259"><a href="#TrackerOptions-259"><span class="linenos">259</span></a>            <span class="n">receiver_mode_file</span><span class="o">=</span><span class="n">receiver_mode_file</span><span class="p">,</span>
</span><span id="TrackerOptions-260"><a href="#TrackerOptions-260"><span class="linenos">260</span></a>        <span class="p">)</span>
</span><span id="TrackerOptions-261"><a href="#TrackerOptions-261"><span class="linenos">261</span></a>
</span><span id="TrackerOptions-262"><a href="#TrackerOptions-262"><span class="linenos">262</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="TrackerOptions-263"><a href="#TrackerOptions-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation.&quot;&quot;&quot;</span>
</span><span id="TrackerOptions-264"><a href="#TrackerOptions-264"><span class="linenos">264</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="TrackerOptions-265"><a href="#TrackerOptions-265"><span class="linenos">265</span></a>            <span class="sa">f</span><span class="s2">&quot;TrackerOptions(</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="TrackerOptions-266"><a href="#TrackerOptions-266"><span class="linenos">266</span></a>            <span class="sa">f</span><span class="s2">&quot;  dt=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="si">}</span><span class="s2">, max_iterations=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="TrackerOptions-267"><a href="#TrackerOptions-267"><span class="linenos">267</span></a>            <span class="sa">f</span><span class="s2">&quot;  computation_mode=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">computation_mode</span><span class="si">}</span><span class="s2">, ode_solver=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ode_solver</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="TrackerOptions-268"><a href="#TrackerOptions-268"><span class="linenos">268</span></a>            <span class="sa">f</span><span class="s2">&quot;  extract_raypaths=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">extract_raypaths</span><span class="si">}</span><span class="s2">, extract_frechet=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">extract_frechet</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="TrackerOptions-269"><a href="#TrackerOptions-269"><span class="linenos">269</span></a>            <span class="sa">f</span><span class="s2">&quot;)&quot;</span>
</span><span id="TrackerOptions-270"><a href="#TrackerOptions-270"><span class="linenos">270</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Configuration options for wavefront tracking.</p>

<p>This dataclass allows programmatic configuration of all parameters
that are typically specified in RAT configuration files.</p>

<p>Physical/Geometric Parameters:
    earth_radius: Radius of Earth in km (default: 6371.0)
    coordinate_system: Coordinate system type
        1 = Cartesian cubic B-splines (default)
        2 = Spherical splines</p>

<p>Integration Parameters:
    dt: ODE solver time step size (default: 5.0)
    max_iterations: Maximum number of iterations (default: 500)
    n_bichar_nodes: Number of nodes on bicharacteristic strip (default: 75)
    ode_solver: ODE solver type (default: 1)
        1 = 4th order Runge-Kutta
        2 = 5th order Runge-Kutta
        3 = 5th order adaptive Runge-Kutta
    interpolator: Velocity interpolation method (default: 1)
        1 = Linear interpolation
        2 = Weighted average</p>

<p>Computation Options:
    computation_mode: What to compute (default: 1)
        1 = Kinematic ray tracing only
        2 = Kinematic ray tracing + spreading factors
    max_arrivals: Maximum number of arrivals per receiver (default: 10)
    source_specific_receivers: Use source-specific receiver configuration (default: True)</p>

<p>Output Options:
    extract_raypaths: Extract ray path data (default: False)
    extract_wavefronts: Extract wavefront data (default: False)
    extract_frechet: Compute Frchet derivatives (default: False)
    raypath_storage: Ray storage mode (default: 2)
        0 = No storage
        1 = One file
        2 = Sorted by arrival
        3 = Both formats
    wavefront_interval: Store every n-th wavefront (default: 100)</p>

<p>File Paths:
    velocity_file: Path to velocity model file (optional)
    sources_file: Path to sources file (optional)
    receivers_file: Path to receivers file (optional)
    receiver_mode_file: Path to receiver mode configuration (optional)</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <h1 id="create-default-options">Create default options</h1>
      
      <p>opts = TrackerOptions()</p>

<pre><code>&gt;&gt;&gt; # Customize parameters
&gt;&gt;&gt; opts = TrackerOptions(
...     dt=2.0,
...     max_iterations=1000,
...     extract_raypaths=True,
...     computation_mode=2  # Include spreading factors
... )

&gt;&gt;&gt; # Use with WaveFrontTracker
&gt;&gt;&gt; tracker = WaveFrontTracker(options=opts)
&gt;&gt;&gt; result = tracker.forward()
</code></pre>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            <div id="TrackerOptions.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TrackerOptions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">earth_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">6371.0</span>,</span><span class="param">	<span class="n">coordinate_system</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span>,</span><span class="param">	<span class="n">n_bichar_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">75</span>,</span><span class="param">	<span class="n">ode_solver</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">interpolator</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">computation_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">max_arrivals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">source_specific_receivers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extract_raypaths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">extract_wavefronts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">extract_frechet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">raypath_storage</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">wavefront_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span>,</span><span class="param">	<span class="n">velocity_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sources_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">receivers_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">receiver_mode_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.__init__"></a>
    
    

                            </div>
                            <div id="TrackerOptions.earth_radius" class="classattr">
                                <div class="attr variable">
            <span class="name">earth_radius</span><span class="annotation">: float</span>        =
<span class="default_value">6371.0</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.earth_radius"></a>
    
    

                            </div>
                            <div id="TrackerOptions.coordinate_system" class="classattr">
                                <div class="attr variable">
            <span class="name">coordinate_system</span><span class="annotation">: int</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.coordinate_system"></a>
    
    

                            </div>
                            <div id="TrackerOptions.dt" class="classattr">
                                <div class="attr variable">
            <span class="name">dt</span><span class="annotation">: float</span>        =
<span class="default_value">5.0</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.dt"></a>
    
    

                            </div>
                            <div id="TrackerOptions.max_iterations" class="classattr">
                                <div class="attr variable">
            <span class="name">max_iterations</span><span class="annotation">: int</span>        =
<span class="default_value">500</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.max_iterations"></a>
    
    

                            </div>
                            <div id="TrackerOptions.n_bichar_nodes" class="classattr">
                                <div class="attr variable">
            <span class="name">n_bichar_nodes</span><span class="annotation">: int</span>        =
<span class="default_value">75</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.n_bichar_nodes"></a>
    
    

                            </div>
                            <div id="TrackerOptions.ode_solver" class="classattr">
                                <div class="attr variable">
            <span class="name">ode_solver</span><span class="annotation">: int</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.ode_solver"></a>
    
    

                            </div>
                            <div id="TrackerOptions.interpolator" class="classattr">
                                <div class="attr variable">
            <span class="name">interpolator</span><span class="annotation">: int</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.interpolator"></a>
    
    

                            </div>
                            <div id="TrackerOptions.computation_mode" class="classattr">
                                <div class="attr variable">
            <span class="name">computation_mode</span><span class="annotation">: int</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.computation_mode"></a>
    
    

                            </div>
                            <div id="TrackerOptions.max_arrivals" class="classattr">
                                <div class="attr variable">
            <span class="name">max_arrivals</span><span class="annotation">: int</span>        =
<span class="default_value">10</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.max_arrivals"></a>
    
    

                            </div>
                            <div id="TrackerOptions.source_specific_receivers" class="classattr">
                                <div class="attr variable">
            <span class="name">source_specific_receivers</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.source_specific_receivers"></a>
    
    

                            </div>
                            <div id="TrackerOptions.extract_raypaths" class="classattr">
                                <div class="attr variable">
            <span class="name">extract_raypaths</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.extract_raypaths"></a>
    
    

                            </div>
                            <div id="TrackerOptions.extract_wavefronts" class="classattr">
                                <div class="attr variable">
            <span class="name">extract_wavefronts</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.extract_wavefronts"></a>
    
    

                            </div>
                            <div id="TrackerOptions.extract_frechet" class="classattr">
                                <div class="attr variable">
            <span class="name">extract_frechet</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.extract_frechet"></a>
    
    

                            </div>
                            <div id="TrackerOptions.raypath_storage" class="classattr">
                                <div class="attr variable">
            <span class="name">raypath_storage</span><span class="annotation">: int</span>        =
<span class="default_value">2</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.raypath_storage"></a>
    
    

                            </div>
                            <div id="TrackerOptions.wavefront_interval" class="classattr">
                                <div class="attr variable">
            <span class="name">wavefront_interval</span><span class="annotation">: int</span>        =
<span class="default_value">100</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.wavefront_interval"></a>
    
    

                            </div>
                            <div id="TrackerOptions.velocity_file" class="classattr">
                                <div class="attr variable">
            <span class="name">velocity_file</span><span class="annotation">: str | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.velocity_file"></a>
    
    

                            </div>
                            <div id="TrackerOptions.sources_file" class="classattr">
                                <div class="attr variable">
            <span class="name">sources_file</span><span class="annotation">: str | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.sources_file"></a>
    
    

                            </div>
                            <div id="TrackerOptions.receivers_file" class="classattr">
                                <div class="attr variable">
            <span class="name">receivers_file</span><span class="annotation">: str | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.receivers_file"></a>
    
    

                            </div>
                            <div id="TrackerOptions.receiver_mode_file" class="classattr">
                                <div class="attr variable">
            <span class="name">receiver_mode_file</span><span class="annotation">: str | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TrackerOptions.receiver_mode_file"></a>
    
    

                            </div>
                            <div id="TrackerOptions.to_dict" class="classattr">
                                        <input id="TrackerOptions.to_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="TrackerOptions.to_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrackerOptions.to_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrackerOptions.to_dict-155"><a href="#TrackerOptions.to_dict-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="TrackerOptions.to_dict-156"><a href="#TrackerOptions.to_dict-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert options to dictionary.</span>
</span><span id="TrackerOptions.to_dict-157"><a href="#TrackerOptions.to_dict-157"><span class="linenos">157</span></a>
</span><span id="TrackerOptions.to_dict-158"><a href="#TrackerOptions.to_dict-158"><span class="linenos">158</span></a><span class="sd">        Returns:</span>
</span><span id="TrackerOptions.to_dict-159"><a href="#TrackerOptions.to_dict-159"><span class="linenos">159</span></a><span class="sd">            Dictionary with all option values</span>
</span><span id="TrackerOptions.to_dict-160"><a href="#TrackerOptions.to_dict-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TrackerOptions.to_dict-161"><a href="#TrackerOptions.to_dict-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="TrackerOptions.to_dict-162"><a href="#TrackerOptions.to_dict-162"><span class="linenos">162</span></a>            <span class="s1">&#39;earth_radius&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">earth_radius</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-163"><a href="#TrackerOptions.to_dict-163"><span class="linenos">163</span></a>            <span class="s1">&#39;coordinate_system&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate_system</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-164"><a href="#TrackerOptions.to_dict-164"><span class="linenos">164</span></a>            <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-165"><a href="#TrackerOptions.to_dict-165"><span class="linenos">165</span></a>            <span class="s1">&#39;max_iterations&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-166"><a href="#TrackerOptions.to_dict-166"><span class="linenos">166</span></a>            <span class="s1">&#39;n_bichar_nodes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bichar_nodes</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-167"><a href="#TrackerOptions.to_dict-167"><span class="linenos">167</span></a>            <span class="s1">&#39;ode_solver&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ode_solver</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-168"><a href="#TrackerOptions.to_dict-168"><span class="linenos">168</span></a>            <span class="s1">&#39;interpolator&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolator</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-169"><a href="#TrackerOptions.to_dict-169"><span class="linenos">169</span></a>            <span class="s1">&#39;computation_mode&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">computation_mode</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-170"><a href="#TrackerOptions.to_dict-170"><span class="linenos">170</span></a>            <span class="s1">&#39;max_arrivals&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_arrivals</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-171"><a href="#TrackerOptions.to_dict-171"><span class="linenos">171</span></a>            <span class="s1">&#39;source_specific_receivers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_specific_receivers</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-172"><a href="#TrackerOptions.to_dict-172"><span class="linenos">172</span></a>            <span class="s1">&#39;extract_raypaths&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_raypaths</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-173"><a href="#TrackerOptions.to_dict-173"><span class="linenos">173</span></a>            <span class="s1">&#39;extract_wavefronts&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_wavefronts</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-174"><a href="#TrackerOptions.to_dict-174"><span class="linenos">174</span></a>            <span class="s1">&#39;extract_frechet&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_frechet</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-175"><a href="#TrackerOptions.to_dict-175"><span class="linenos">175</span></a>            <span class="s1">&#39;raypath_storage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">raypath_storage</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-176"><a href="#TrackerOptions.to_dict-176"><span class="linenos">176</span></a>            <span class="s1">&#39;wavefront_interval&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavefront_interval</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-177"><a href="#TrackerOptions.to_dict-177"><span class="linenos">177</span></a>            <span class="s1">&#39;velocity_file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_file</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-178"><a href="#TrackerOptions.to_dict-178"><span class="linenos">178</span></a>            <span class="s1">&#39;sources_file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources_file</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-179"><a href="#TrackerOptions.to_dict-179"><span class="linenos">179</span></a>            <span class="s1">&#39;receivers_file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">receivers_file</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-180"><a href="#TrackerOptions.to_dict-180"><span class="linenos">180</span></a>            <span class="s1">&#39;receiver_mode_file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">receiver_mode_file</span><span class="p">,</span>
</span><span id="TrackerOptions.to_dict-181"><a href="#TrackerOptions.to_dict-181"><span class="linenos">181</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Convert options to dictionary.</p>

<p>Returns:
    Dictionary with all option values</p>
</div>


                            </div>
                            <div id="TrackerOptions.from_config_file" class="classattr">
                                        <input id="TrackerOptions.from_config_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_config_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">config_file</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n"><a href="#TrackerOptions">TrackerOptions</a></span>:</span></span>

                <label class="view-source-button" for="TrackerOptions.from_config_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrackerOptions.from_config_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrackerOptions.from_config_file-183"><a href="#TrackerOptions.from_config_file-183"><span class="linenos">183</span></a>    <span class="nd">@classmethod</span>
</span><span id="TrackerOptions.from_config_file-184"><a href="#TrackerOptions.from_config_file-184"><span class="linenos">184</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_config_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TrackerOptions&#39;</span><span class="p">:</span>
</span><span id="TrackerOptions.from_config_file-185"><a href="#TrackerOptions.from_config_file-185"><span class="linenos">185</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse options from RAT configuration file.</span>
</span><span id="TrackerOptions.from_config_file-186"><a href="#TrackerOptions.from_config_file-186"><span class="linenos">186</span></a>
</span><span id="TrackerOptions.from_config_file-187"><a href="#TrackerOptions.from_config_file-187"><span class="linenos">187</span></a><span class="sd">        Args:</span>
</span><span id="TrackerOptions.from_config_file-188"><a href="#TrackerOptions.from_config_file-188"><span class="linenos">188</span></a><span class="sd">            config_file: Path to RAT configuration file</span>
</span><span id="TrackerOptions.from_config_file-189"><a href="#TrackerOptions.from_config_file-189"><span class="linenos">189</span></a>
</span><span id="TrackerOptions.from_config_file-190"><a href="#TrackerOptions.from_config_file-190"><span class="linenos">190</span></a><span class="sd">        Returns:</span>
</span><span id="TrackerOptions.from_config_file-191"><a href="#TrackerOptions.from_config_file-191"><span class="linenos">191</span></a><span class="sd">            TrackerOptions instance with parameters from file</span>
</span><span id="TrackerOptions.from_config_file-192"><a href="#TrackerOptions.from_config_file-192"><span class="linenos">192</span></a>
</span><span id="TrackerOptions.from_config_file-193"><a href="#TrackerOptions.from_config_file-193"><span class="linenos">193</span></a><span class="sd">        Example:</span>
</span><span id="TrackerOptions.from_config_file-194"><a href="#TrackerOptions.from_config_file-194"><span class="linenos">194</span></a><span class="sd">            &gt;&gt;&gt; opts = TrackerOptions.from_config_file(&#39;config.in&#39;)</span>
</span><span id="TrackerOptions.from_config_file-195"><a href="#TrackerOptions.from_config_file-195"><span class="linenos">195</span></a><span class="sd">            &gt;&gt;&gt; opts.dt = 2.0  # Override specific parameters</span>
</span><span id="TrackerOptions.from_config_file-196"><a href="#TrackerOptions.from_config_file-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TrackerOptions.from_config_file-197"><a href="#TrackerOptions.from_config_file-197"><span class="linenos">197</span></a>        <span class="n">config_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
</span><span id="TrackerOptions.from_config_file-198"><a href="#TrackerOptions.from_config_file-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="TrackerOptions.from_config_file-199"><a href="#TrackerOptions.from_config_file-199"><span class="linenos">199</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuration file not found: </span><span class="si">{</span><span class="n">config_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrackerOptions.from_config_file-200"><a href="#TrackerOptions.from_config_file-200"><span class="linenos">200</span></a>
</span><span id="TrackerOptions.from_config_file-201"><a href="#TrackerOptions.from_config_file-201"><span class="linenos">201</span></a>        <span class="c1"># Read configuration file</span>
</span><span id="TrackerOptions.from_config_file-202"><a href="#TrackerOptions.from_config_file-202"><span class="linenos">202</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="TrackerOptions.from_config_file-203"><a href="#TrackerOptions.from_config_file-203"><span class="linenos">203</span></a>            <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">)]</span>
</span><span id="TrackerOptions.from_config_file-204"><a href="#TrackerOptions.from_config_file-204"><span class="linenos">204</span></a>
</span><span id="TrackerOptions.from_config_file-205"><a href="#TrackerOptions.from_config_file-205"><span class="linenos">205</span></a>        <span class="c1"># Parse file paths (first 3 non-empty lines)</span>
</span><span id="TrackerOptions.from_config_file-206"><a href="#TrackerOptions.from_config_file-206"><span class="linenos">206</span></a>        <span class="n">velocity_file</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="TrackerOptions.from_config_file-207"><a href="#TrackerOptions.from_config_file-207"><span class="linenos">207</span></a>        <span class="n">sources_file</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="TrackerOptions.from_config_file-208"><a href="#TrackerOptions.from_config_file-208"><span class="linenos">208</span></a>        <span class="n">receivers_file</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="TrackerOptions.from_config_file-209"><a href="#TrackerOptions.from_config_file-209"><span class="linenos">209</span></a>
</span><span id="TrackerOptions.from_config_file-210"><a href="#TrackerOptions.from_config_file-210"><span class="linenos">210</span></a>        <span class="c1"># Parse numeric parameters (next section)</span>
</span><span id="TrackerOptions.from_config_file-211"><a href="#TrackerOptions.from_config_file-211"><span class="linenos">211</span></a>        <span class="n">dt</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="mf">5.0</span>
</span><span id="TrackerOptions.from_config_file-212"><a href="#TrackerOptions.from_config_file-212"><span class="linenos">212</span></a>        <span class="n">max_iterations</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="k">else</span> <span class="mi">500</span>
</span><span id="TrackerOptions.from_config_file-213"><a href="#TrackerOptions.from_config_file-213"><span class="linenos">213</span></a>        <span class="n">n_bichar_nodes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="mi">75</span>
</span><span id="TrackerOptions.from_config_file-214"><a href="#TrackerOptions.from_config_file-214"><span class="linenos">214</span></a>        <span class="n">computation_mode</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">6</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="TrackerOptions.from_config_file-215"><a href="#TrackerOptions.from_config_file-215"><span class="linenos">215</span></a>        <span class="n">ode_solver</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="TrackerOptions.from_config_file-216"><a href="#TrackerOptions.from_config_file-216"><span class="linenos">216</span></a>        <span class="n">interpolator</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">8</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="TrackerOptions.from_config_file-217"><a href="#TrackerOptions.from_config_file-217"><span class="linenos">217</span></a>        <span class="n">max_arrivals</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">9</span> <span class="k">else</span> <span class="mi">10</span>
</span><span id="TrackerOptions.from_config_file-218"><a href="#TrackerOptions.from_config_file-218"><span class="linenos">218</span></a>        <span class="n">coordinate_system</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="TrackerOptions.from_config_file-219"><a href="#TrackerOptions.from_config_file-219"><span class="linenos">219</span></a>        <span class="n">earth_radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">11</span> <span class="k">else</span> <span class="mf">6371.0</span>
</span><span id="TrackerOptions.from_config_file-220"><a href="#TrackerOptions.from_config_file-220"><span class="linenos">220</span></a>        <span class="n">source_specific_receivers</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">12</span><span class="p">]))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">12</span> <span class="k">else</span> <span class="kc">True</span>
</span><span id="TrackerOptions.from_config_file-221"><a href="#TrackerOptions.from_config_file-221"><span class="linenos">221</span></a>        <span class="n">receiver_mode_file</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">13</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="TrackerOptions.from_config_file-222"><a href="#TrackerOptions.from_config_file-222"><span class="linenos">222</span></a>
</span><span id="TrackerOptions.from_config_file-223"><a href="#TrackerOptions.from_config_file-223"><span class="linenos">223</span></a>        <span class="c1"># Parse output parameters</span>
</span><span id="TrackerOptions.from_config_file-224"><a href="#TrackerOptions.from_config_file-224"><span class="linenos">224</span></a>        <span class="n">wavefront_interval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">14</span> <span class="k">else</span> <span class="mi">100</span>
</span><span id="TrackerOptions.from_config_file-225"><a href="#TrackerOptions.from_config_file-225"><span class="linenos">225</span></a>        <span class="n">extract_raypaths</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">15</span><span class="p">]))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">15</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="TrackerOptions.from_config_file-226"><a href="#TrackerOptions.from_config_file-226"><span class="linenos">226</span></a>        <span class="n">raypath_storage</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="k">else</span> <span class="mi">2</span>
</span><span id="TrackerOptions.from_config_file-227"><a href="#TrackerOptions.from_config_file-227"><span class="linenos">227</span></a>        <span class="n">extract_frechet</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">17</span><span class="p">]))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">17</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="TrackerOptions.from_config_file-228"><a href="#TrackerOptions.from_config_file-228"><span class="linenos">228</span></a>
</span><span id="TrackerOptions.from_config_file-229"><a href="#TrackerOptions.from_config_file-229"><span class="linenos">229</span></a>        <span class="c1"># Resolve file paths relative to config file directory</span>
</span><span id="TrackerOptions.from_config_file-230"><a href="#TrackerOptions.from_config_file-230"><span class="linenos">230</span></a>        <span class="n">config_dir</span> <span class="o">=</span> <span class="n">config_path</span><span class="o">.</span><span class="n">parent</span>
</span><span id="TrackerOptions.from_config_file-231"><a href="#TrackerOptions.from_config_file-231"><span class="linenos">231</span></a>        <span class="k">if</span> <span class="n">velocity_file</span><span class="p">:</span>
</span><span id="TrackerOptions.from_config_file-232"><a href="#TrackerOptions.from_config_file-232"><span class="linenos">232</span></a>            <span class="n">velocity_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">velocity_file</span><span class="p">)</span>
</span><span id="TrackerOptions.from_config_file-233"><a href="#TrackerOptions.from_config_file-233"><span class="linenos">233</span></a>        <span class="k">if</span> <span class="n">sources_file</span><span class="p">:</span>
</span><span id="TrackerOptions.from_config_file-234"><a href="#TrackerOptions.from_config_file-234"><span class="linenos">234</span></a>            <span class="n">sources_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">sources_file</span><span class="p">)</span>
</span><span id="TrackerOptions.from_config_file-235"><a href="#TrackerOptions.from_config_file-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="n">receivers_file</span><span class="p">:</span>
</span><span id="TrackerOptions.from_config_file-236"><a href="#TrackerOptions.from_config_file-236"><span class="linenos">236</span></a>            <span class="n">receivers_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">receivers_file</span><span class="p">)</span>
</span><span id="TrackerOptions.from_config_file-237"><a href="#TrackerOptions.from_config_file-237"><span class="linenos">237</span></a>        <span class="k">if</span> <span class="n">receiver_mode_file</span><span class="p">:</span>
</span><span id="TrackerOptions.from_config_file-238"><a href="#TrackerOptions.from_config_file-238"><span class="linenos">238</span></a>            <span class="n">receiver_mode_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">receiver_mode_file</span><span class="p">)</span>
</span><span id="TrackerOptions.from_config_file-239"><a href="#TrackerOptions.from_config_file-239"><span class="linenos">239</span></a>
</span><span id="TrackerOptions.from_config_file-240"><a href="#TrackerOptions.from_config_file-240"><span class="linenos">240</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="TrackerOptions.from_config_file-241"><a href="#TrackerOptions.from_config_file-241"><span class="linenos">241</span></a>            <span class="n">earth_radius</span><span class="o">=</span><span class="n">earth_radius</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-242"><a href="#TrackerOptions.from_config_file-242"><span class="linenos">242</span></a>            <span class="n">coordinate_system</span><span class="o">=</span><span class="n">coordinate_system</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-243"><a href="#TrackerOptions.from_config_file-243"><span class="linenos">243</span></a>            <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-244"><a href="#TrackerOptions.from_config_file-244"><span class="linenos">244</span></a>            <span class="n">max_iterations</span><span class="o">=</span><span class="n">max_iterations</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-245"><a href="#TrackerOptions.from_config_file-245"><span class="linenos">245</span></a>            <span class="n">n_bichar_nodes</span><span class="o">=</span><span class="n">n_bichar_nodes</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-246"><a href="#TrackerOptions.from_config_file-246"><span class="linenos">246</span></a>            <span class="n">ode_solver</span><span class="o">=</span><span class="n">ode_solver</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-247"><a href="#TrackerOptions.from_config_file-247"><span class="linenos">247</span></a>            <span class="n">interpolator</span><span class="o">=</span><span class="n">interpolator</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-248"><a href="#TrackerOptions.from_config_file-248"><span class="linenos">248</span></a>            <span class="n">computation_mode</span><span class="o">=</span><span class="n">computation_mode</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-249"><a href="#TrackerOptions.from_config_file-249"><span class="linenos">249</span></a>            <span class="n">max_arrivals</span><span class="o">=</span><span class="n">max_arrivals</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-250"><a href="#TrackerOptions.from_config_file-250"><span class="linenos">250</span></a>            <span class="n">source_specific_receivers</span><span class="o">=</span><span class="n">source_specific_receivers</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-251"><a href="#TrackerOptions.from_config_file-251"><span class="linenos">251</span></a>            <span class="n">extract_raypaths</span><span class="o">=</span><span class="n">extract_raypaths</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-252"><a href="#TrackerOptions.from_config_file-252"><span class="linenos">252</span></a>            <span class="n">extract_wavefronts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Not in config file</span>
</span><span id="TrackerOptions.from_config_file-253"><a href="#TrackerOptions.from_config_file-253"><span class="linenos">253</span></a>            <span class="n">extract_frechet</span><span class="o">=</span><span class="n">extract_frechet</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-254"><a href="#TrackerOptions.from_config_file-254"><span class="linenos">254</span></a>            <span class="n">raypath_storage</span><span class="o">=</span><span class="n">raypath_storage</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-255"><a href="#TrackerOptions.from_config_file-255"><span class="linenos">255</span></a>            <span class="n">wavefront_interval</span><span class="o">=</span><span class="n">wavefront_interval</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-256"><a href="#TrackerOptions.from_config_file-256"><span class="linenos">256</span></a>            <span class="n">velocity_file</span><span class="o">=</span><span class="n">velocity_file</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-257"><a href="#TrackerOptions.from_config_file-257"><span class="linenos">257</span></a>            <span class="n">sources_file</span><span class="o">=</span><span class="n">sources_file</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-258"><a href="#TrackerOptions.from_config_file-258"><span class="linenos">258</span></a>            <span class="n">receivers_file</span><span class="o">=</span><span class="n">receivers_file</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-259"><a href="#TrackerOptions.from_config_file-259"><span class="linenos">259</span></a>            <span class="n">receiver_mode_file</span><span class="o">=</span><span class="n">receiver_mode_file</span><span class="p">,</span>
</span><span id="TrackerOptions.from_config_file-260"><a href="#TrackerOptions.from_config_file-260"><span class="linenos">260</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parse options from RAT configuration file.</p>

<p>Args:
    config_file: Path to RAT configuration file</p>

<p>Returns:
    TrackerOptions instance with parameters from file</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>opts = <a href="#TrackerOptions.from_config_file">TrackerOptions.from_config_file</a>('config.in')
      opts.dt = 2.0  # Override specific parameters</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                </section>
                <section id="VelocityModel2D">
                            <input id="VelocityModel2D-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">VelocityModel2D</span>:

                <label class="view-source-button" for="VelocityModel2D-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModel2D"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModel2D-13"><a href="#VelocityModel2D-13"><span class="linenos"> 13</span></a><span class="nd">@dataclass</span>
</span><span id="VelocityModel2D-14"><a href="#VelocityModel2D-14"><span class="linenos"> 14</span></a><span class="k">class</span><span class="w"> </span><span class="nc">VelocityModel2D</span><span class="p">:</span>
</span><span id="VelocityModel2D-15"><a href="#VelocityModel2D-15"><span class="linenos"> 15</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;2D velocity model on a regular grid.</span>
</span><span id="VelocityModel2D-16"><a href="#VelocityModel2D-16"><span class="linenos"> 16</span></a>
</span><span id="VelocityModel2D-17"><a href="#VelocityModel2D-17"><span class="linenos"> 17</span></a><span class="sd">    Attributes:</span>
</span><span id="VelocityModel2D-18"><a href="#VelocityModel2D-18"><span class="linenos"> 18</span></a><span class="sd">        velocities: 2D array of velocities (nx, ny)</span>
</span><span id="VelocityModel2D-19"><a href="#VelocityModel2D-19"><span class="linenos"> 19</span></a><span class="sd">        x0: X-coordinate of lower-left corner</span>
</span><span id="VelocityModel2D-20"><a href="#VelocityModel2D-20"><span class="linenos"> 20</span></a><span class="sd">        y0: Y-coordinate of lower-left corner</span>
</span><span id="VelocityModel2D-21"><a href="#VelocityModel2D-21"><span class="linenos"> 21</span></a><span class="sd">        dx: Grid spacing in X direction</span>
</span><span id="VelocityModel2D-22"><a href="#VelocityModel2D-22"><span class="linenos"> 22</span></a><span class="sd">        dy: Grid spacing in Y direction</span>
</span><span id="VelocityModel2D-23"><a href="#VelocityModel2D-23"><span class="linenos"> 23</span></a><span class="sd">        cushion_nodes: Number of cushion nodes for boundary (default: 3)</span>
</span><span id="VelocityModel2D-24"><a href="#VelocityModel2D-24"><span class="linenos"> 24</span></a>
</span><span id="VelocityModel2D-25"><a href="#VelocityModel2D-25"><span class="linenos"> 25</span></a><span class="sd">    Example:</span>
</span><span id="VelocityModel2D-26"><a href="#VelocityModel2D-26"><span class="linenos"> 26</span></a><span class="sd">        &gt;&gt;&gt; # Create a simple constant velocity model</span>
</span><span id="VelocityModel2D-27"><a href="#VelocityModel2D-27"><span class="linenos"> 27</span></a><span class="sd">        &gt;&gt;&gt; nx, ny = 100, 80</span>
</span><span id="VelocityModel2D-28"><a href="#VelocityModel2D-28"><span class="linenos"> 28</span></a><span class="sd">        &gt;&gt;&gt; velocities = np.full((nx, ny), 3.5)  # 3.5 km/s everywhere</span>
</span><span id="VelocityModel2D-29"><a href="#VelocityModel2D-29"><span class="linenos"> 29</span></a><span class="sd">        &gt;&gt;&gt; model = VelocityModel2D(</span>
</span><span id="VelocityModel2D-30"><a href="#VelocityModel2D-30"><span class="linenos"> 30</span></a><span class="sd">        ...     velocities=velocities,</span>
</span><span id="VelocityModel2D-31"><a href="#VelocityModel2D-31"><span class="linenos"> 31</span></a><span class="sd">        ...     x0=110.0, y0=-45.0,  # degrees</span>
</span><span id="VelocityModel2D-32"><a href="#VelocityModel2D-32"><span class="linenos"> 32</span></a><span class="sd">        ...     dx=0.5, dy=0.5</span>
</span><span id="VelocityModel2D-33"><a href="#VelocityModel2D-33"><span class="linenos"> 33</span></a><span class="sd">        ... )</span>
</span><span id="VelocityModel2D-34"><a href="#VelocityModel2D-34"><span class="linenos"> 34</span></a>
</span><span id="VelocityModel2D-35"><a href="#VelocityModel2D-35"><span class="linenos"> 35</span></a><span class="sd">        &gt;&gt;&gt; # Or create from a function</span>
</span><span id="VelocityModel2D-36"><a href="#VelocityModel2D-36"><span class="linenos"> 36</span></a><span class="sd">        &gt;&gt;&gt; x = np.linspace(110, 160, 100)</span>
</span><span id="VelocityModel2D-37"><a href="#VelocityModel2D-37"><span class="linenos"> 37</span></a><span class="sd">        &gt;&gt;&gt; y = np.linspace(-45, -10, 80)</span>
</span><span id="VelocityModel2D-38"><a href="#VelocityModel2D-38"><span class="linenos"> 38</span></a><span class="sd">        &gt;&gt;&gt; xx, yy = np.meshgrid(x, y, indexing=&#39;ij&#39;)</span>
</span><span id="VelocityModel2D-39"><a href="#VelocityModel2D-39"><span class="linenos"> 39</span></a><span class="sd">        &gt;&gt;&gt; velocities = 3.0 + 0.01 * np.sqrt(xx**2 + yy**2)</span>
</span><span id="VelocityModel2D-40"><a href="#VelocityModel2D-40"><span class="linenos"> 40</span></a><span class="sd">        &gt;&gt;&gt; model = VelocityModel2D(velocities, 110.0, -45.0, 0.5, 0.5)</span>
</span><span id="VelocityModel2D-41"><a href="#VelocityModel2D-41"><span class="linenos"> 41</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="VelocityModel2D-42"><a href="#VelocityModel2D-42"><span class="linenos"> 42</span></a>
</span><span id="VelocityModel2D-43"><a href="#VelocityModel2D-43"><span class="linenos"> 43</span></a>    <span class="n">velocities</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</span><span id="VelocityModel2D-44"><a href="#VelocityModel2D-44"><span class="linenos"> 44</span></a>    <span class="n">x0</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="VelocityModel2D-45"><a href="#VelocityModel2D-45"><span class="linenos"> 45</span></a>    <span class="n">y0</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="VelocityModel2D-46"><a href="#VelocityModel2D-46"><span class="linenos"> 46</span></a>    <span class="n">dx</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="VelocityModel2D-47"><a href="#VelocityModel2D-47"><span class="linenos"> 47</span></a>    <span class="n">dy</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="VelocityModel2D-48"><a href="#VelocityModel2D-48"><span class="linenos"> 48</span></a>    <span class="n">cushion_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="VelocityModel2D-49"><a href="#VelocityModel2D-49"><span class="linenos"> 49</span></a>
</span><span id="VelocityModel2D-50"><a href="#VelocityModel2D-50"><span class="linenos"> 50</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VelocityModel2D-51"><a href="#VelocityModel2D-51"><span class="linenos"> 51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate model parameters.&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D-52"><a href="#VelocityModel2D-52"><span class="linenos"> 52</span></a>        <span class="c1"># Ensure velocities is numpy array</span>
</span><span id="VelocityModel2D-53"><a href="#VelocityModel2D-53"><span class="linenos"> 53</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="VelocityModel2D-54"><a href="#VelocityModel2D-54"><span class="linenos"> 54</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="VelocityModel2D-55"><a href="#VelocityModel2D-55"><span class="linenos"> 55</span></a>
</span><span id="VelocityModel2D-56"><a href="#VelocityModel2D-56"><span class="linenos"> 56</span></a>        <span class="c1"># Ensure correct dtype</span>
</span><span id="VelocityModel2D-57"><a href="#VelocityModel2D-57"><span class="linenos"> 57</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">:</span>
</span><span id="VelocityModel2D-58"><a href="#VelocityModel2D-58"><span class="linenos"> 58</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="VelocityModel2D-59"><a href="#VelocityModel2D-59"><span class="linenos"> 59</span></a>
</span><span id="VelocityModel2D-60"><a href="#VelocityModel2D-60"><span class="linenos"> 60</span></a>        <span class="c1"># Validate shape</span>
</span><span id="VelocityModel2D-61"><a href="#VelocityModel2D-61"><span class="linenos"> 61</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="VelocityModel2D-62"><a href="#VelocityModel2D-62"><span class="linenos"> 62</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;velocities must be 2D array, got shape </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="VelocityModel2D-63"><a href="#VelocityModel2D-63"><span class="linenos"> 63</span></a>
</span><span id="VelocityModel2D-64"><a href="#VelocityModel2D-64"><span class="linenos"> 64</span></a>        <span class="c1"># Validate positive spacings</span>
</span><span id="VelocityModel2D-65"><a href="#VelocityModel2D-65"><span class="linenos"> 65</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VelocityModel2D-66"><a href="#VelocityModel2D-66"><span class="linenos"> 66</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Grid spacings dx and dy must be positive&quot;</span><span class="p">)</span>
</span><span id="VelocityModel2D-67"><a href="#VelocityModel2D-67"><span class="linenos"> 67</span></a>
</span><span id="VelocityModel2D-68"><a href="#VelocityModel2D-68"><span class="linenos"> 68</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cushion_nodes</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VelocityModel2D-69"><a href="#VelocityModel2D-69"><span class="linenos"> 69</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cushion_nodes must be non-negative&quot;</span><span class="p">)</span>
</span><span id="VelocityModel2D-70"><a href="#VelocityModel2D-70"><span class="linenos"> 70</span></a>
</span><span id="VelocityModel2D-71"><a href="#VelocityModel2D-71"><span class="linenos"> 71</span></a>    <span class="nd">@property</span>
</span><span id="VelocityModel2D-72"><a href="#VelocityModel2D-72"><span class="linenos"> 72</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="VelocityModel2D-73"><a href="#VelocityModel2D-73"><span class="linenos"> 73</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of grid points in X direction.&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D-74"><a href="#VelocityModel2D-74"><span class="linenos"> 74</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="VelocityModel2D-75"><a href="#VelocityModel2D-75"><span class="linenos"> 75</span></a>
</span><span id="VelocityModel2D-76"><a href="#VelocityModel2D-76"><span class="linenos"> 76</span></a>    <span class="nd">@property</span>
</span><span id="VelocityModel2D-77"><a href="#VelocityModel2D-77"><span class="linenos"> 77</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ny</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="VelocityModel2D-78"><a href="#VelocityModel2D-78"><span class="linenos"> 78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of grid points in Y direction.&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D-79"><a href="#VelocityModel2D-79"><span class="linenos"> 79</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="VelocityModel2D-80"><a href="#VelocityModel2D-80"><span class="linenos"> 80</span></a>
</span><span id="VelocityModel2D-81"><a href="#VelocityModel2D-81"><span class="linenos"> 81</span></a>    <span class="nd">@property</span>
</span><span id="VelocityModel2D-82"><a href="#VelocityModel2D-82"><span class="linenos"> 82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="VelocityModel2D-83"><a href="#VelocityModel2D-83"><span class="linenos"> 83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;X-coordinate of upper-right corner.&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D-84"><a href="#VelocityModel2D-84"><span class="linenos"> 84</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span>
</span><span id="VelocityModel2D-85"><a href="#VelocityModel2D-85"><span class="linenos"> 85</span></a>
</span><span id="VelocityModel2D-86"><a href="#VelocityModel2D-86"><span class="linenos"> 86</span></a>    <span class="nd">@property</span>
</span><span id="VelocityModel2D-87"><a href="#VelocityModel2D-87"><span class="linenos"> 87</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="VelocityModel2D-88"><a href="#VelocityModel2D-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Y-coordinate of upper-right corner.&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D-89"><a href="#VelocityModel2D-89"><span class="linenos"> 89</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span>
</span><span id="VelocityModel2D-90"><a href="#VelocityModel2D-90"><span class="linenos"> 90</span></a>
</span><span id="VelocityModel2D-91"><a href="#VelocityModel2D-91"><span class="linenos"> 91</span></a>    <span class="nd">@property</span>
</span><span id="VelocityModel2D-92"><a href="#VelocityModel2D-92"><span class="linenos"> 92</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VelocityModel2D-93"><a href="#VelocityModel2D-93"><span class="linenos"> 93</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Model extent as (x0, x1, y0, y1).&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D-94"><a href="#VelocityModel2D-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span>
</span><span id="VelocityModel2D-95"><a href="#VelocityModel2D-95"><span class="linenos"> 95</span></a>
</span><span id="VelocityModel2D-96"><a href="#VelocityModel2D-96"><span class="linenos"> 96</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="VelocityModel2D-97"><a href="#VelocityModel2D-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation.&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D-98"><a href="#VelocityModel2D-98"><span class="linenos"> 98</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="VelocityModel2D-99"><a href="#VelocityModel2D-99"><span class="linenos"> 99</span></a>            <span class="sa">f</span><span class="s2">&quot;VelocityModel2D(</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="VelocityModel2D-100"><a href="#VelocityModel2D-100"><span class="linenos">100</span></a>            <span class="sa">f</span><span class="s2">&quot;  shape=(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="si">}</span><span class="s2">),</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="VelocityModel2D-101"><a href="#VelocityModel2D-101"><span class="linenos">101</span></a>            <span class="sa">f</span><span class="s2">&quot;  extent=(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">),</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="VelocityModel2D-102"><a href="#VelocityModel2D-102"><span class="linenos">102</span></a>            <span class="sa">f</span><span class="s2">&quot;  spacing=(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">),</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="VelocityModel2D-103"><a href="#VelocityModel2D-103"><span class="linenos">103</span></a>            <span class="sa">f</span><span class="s2">&quot;  velocity_range=(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="VelocityModel2D-104"><a href="#VelocityModel2D-104"><span class="linenos">104</span></a>            <span class="sa">f</span><span class="s2">&quot;)&quot;</span>
</span><span id="VelocityModel2D-105"><a href="#VelocityModel2D-105"><span class="linenos">105</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>2D velocity model on a regular grid.</p>

<p>Attributes:
    velocities: 2D array of velocities (nx, ny)
    x0: X-coordinate of lower-left corner
    y0: Y-coordinate of lower-left corner
    dx: Grid spacing in X direction
    dy: Grid spacing in Y direction
    cushion_nodes: Number of cushion nodes for boundary (default: 3)</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <h1 id="create-a-simple-constant-velocity-model">Create a simple constant velocity model</h1>
      
      <p>nx, ny = 100, 80
      velocities = np.full((nx, ny), 3.5)  # 3.5 km/s everywhere
      model = VelocityModel2D(
          ...     velocities=velocities,
          ...     x0=110.0, y0=-45.0,  # degrees
          ...     dx=0.5, dy=0.5
          ... )</p>

<pre><code>&gt;&gt;&gt; # Or create from a function
&gt;&gt;&gt; x = np.linspace(110, 160, 100)
&gt;&gt;&gt; y = np.linspace(-45, -10, 80)
&gt;&gt;&gt; xx, yy = np.meshgrid(x, y, indexing='ij')
&gt;&gt;&gt; velocities = 3.0 + 0.01 * np.sqrt(xx**2 + yy**2)
&gt;&gt;&gt; model = VelocityModel2D(velocities, 110.0, -45.0, 0.5, 0.5)
</code></pre>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            <div id="VelocityModel2D.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">VelocityModel2D</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">velocities</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">x0</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y0</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">dx</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">dy</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">cushion_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel2D.__init__"></a>
    
    

                            </div>
                            <div id="VelocityModel2D.velocities" class="classattr">
                                <div class="attr variable">
            <span class="name">velocities</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel2D.velocities"></a>
    
    

                            </div>
                            <div id="VelocityModel2D.x0" class="classattr">
                                <div class="attr variable">
            <span class="name">x0</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel2D.x0"></a>
    
    

                            </div>
                            <div id="VelocityModel2D.y0" class="classattr">
                                <div class="attr variable">
            <span class="name">y0</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel2D.y0"></a>
    
    

                            </div>
                            <div id="VelocityModel2D.dx" class="classattr">
                                <div class="attr variable">
            <span class="name">dx</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel2D.dx"></a>
    
    

                            </div>
                            <div id="VelocityModel2D.dy" class="classattr">
                                <div class="attr variable">
            <span class="name">dy</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel2D.dy"></a>
    
    

                            </div>
                            <div id="VelocityModel2D.cushion_nodes" class="classattr">
                                <div class="attr variable">
            <span class="name">cushion_nodes</span><span class="annotation">: int</span>        =
<span class="default_value">3</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel2D.cushion_nodes"></a>
    
    

                            </div>
                            <div id="VelocityModel2D.nx" class="classattr">
                                        <input id="VelocityModel2D.nx-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">nx</span><span class="annotation">: int</span>

                <label class="view-source-button" for="VelocityModel2D.nx-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModel2D.nx"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModel2D.nx-71"><a href="#VelocityModel2D.nx-71"><span class="linenos">71</span></a>    <span class="nd">@property</span>
</span><span id="VelocityModel2D.nx-72"><a href="#VelocityModel2D.nx-72"><span class="linenos">72</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="VelocityModel2D.nx-73"><a href="#VelocityModel2D.nx-73"><span class="linenos">73</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of grid points in X direction.&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D.nx-74"><a href="#VelocityModel2D.nx-74"><span class="linenos">74</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Number of grid points in X direction.</p>
</div>


                            </div>
                            <div id="VelocityModel2D.ny" class="classattr">
                                        <input id="VelocityModel2D.ny-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">ny</span><span class="annotation">: int</span>

                <label class="view-source-button" for="VelocityModel2D.ny-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModel2D.ny"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModel2D.ny-76"><a href="#VelocityModel2D.ny-76"><span class="linenos">76</span></a>    <span class="nd">@property</span>
</span><span id="VelocityModel2D.ny-77"><a href="#VelocityModel2D.ny-77"><span class="linenos">77</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ny</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="VelocityModel2D.ny-78"><a href="#VelocityModel2D.ny-78"><span class="linenos">78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of grid points in Y direction.&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D.ny-79"><a href="#VelocityModel2D.ny-79"><span class="linenos">79</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Number of grid points in Y direction.</p>
</div>


                            </div>
                            <div id="VelocityModel2D.x1" class="classattr">
                                        <input id="VelocityModel2D.x1-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">x1</span><span class="annotation">: float</span>

                <label class="view-source-button" for="VelocityModel2D.x1-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModel2D.x1"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModel2D.x1-81"><a href="#VelocityModel2D.x1-81"><span class="linenos">81</span></a>    <span class="nd">@property</span>
</span><span id="VelocityModel2D.x1-82"><a href="#VelocityModel2D.x1-82"><span class="linenos">82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="VelocityModel2D.x1-83"><a href="#VelocityModel2D.x1-83"><span class="linenos">83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;X-coordinate of upper-right corner.&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D.x1-84"><a href="#VelocityModel2D.x1-84"><span class="linenos">84</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span>
</span></pre></div>


            <div class="docstring"><p>X-coordinate of upper-right corner.</p>
</div>


                            </div>
                            <div id="VelocityModel2D.y1" class="classattr">
                                        <input id="VelocityModel2D.y1-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">y1</span><span class="annotation">: float</span>

                <label class="view-source-button" for="VelocityModel2D.y1-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModel2D.y1"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModel2D.y1-86"><a href="#VelocityModel2D.y1-86"><span class="linenos">86</span></a>    <span class="nd">@property</span>
</span><span id="VelocityModel2D.y1-87"><a href="#VelocityModel2D.y1-87"><span class="linenos">87</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="VelocityModel2D.y1-88"><a href="#VelocityModel2D.y1-88"><span class="linenos">88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Y-coordinate of upper-right corner.&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D.y1-89"><a href="#VelocityModel2D.y1-89"><span class="linenos">89</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span>
</span></pre></div>


            <div class="docstring"><p>Y-coordinate of upper-right corner.</p>
</div>


                            </div>
                            <div id="VelocityModel2D.extent" class="classattr">
                                        <input id="VelocityModel2D.extent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">extent</span>

                <label class="view-source-button" for="VelocityModel2D.extent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModel2D.extent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModel2D.extent-91"><a href="#VelocityModel2D.extent-91"><span class="linenos">91</span></a>    <span class="nd">@property</span>
</span><span id="VelocityModel2D.extent-92"><a href="#VelocityModel2D.extent-92"><span class="linenos">92</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VelocityModel2D.extent-93"><a href="#VelocityModel2D.extent-93"><span class="linenos">93</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Model extent as (x0, x1, y0, y1).&quot;&quot;&quot;</span>
</span><span id="VelocityModel2D.extent-94"><a href="#VelocityModel2D.extent-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Model extent as (x0, x1, y0, y1).</p>
</div>


                            </div>
                </section>
                <section id="Sources">
                            <input id="Sources-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Sources</span>:

                <label class="view-source-button" for="Sources-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sources"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sources-108"><a href="#Sources-108"><span class="linenos">108</span></a><span class="nd">@dataclass</span>
</span><span id="Sources-109"><a href="#Sources-109"><span class="linenos">109</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Sources</span><span class="p">:</span>
</span><span id="Sources-110"><a href="#Sources-110"><span class="linenos">110</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Source configuration for wavefront tracking.</span>
</span><span id="Sources-111"><a href="#Sources-111"><span class="linenos">111</span></a>
</span><span id="Sources-112"><a href="#Sources-112"><span class="linenos">112</span></a><span class="sd">    Attributes:</span>
</span><span id="Sources-113"><a href="#Sources-113"><span class="linenos">113</span></a><span class="sd">        positions: Array of source positions, shape (n_sources, 2) with columns [x, y]</span>
</span><span id="Sources-114"><a href="#Sources-114"><span class="linenos">114</span></a><span class="sd">        source_type: Source type (1=point source, 2=plane wave)</span>
</span><span id="Sources-115"><a href="#Sources-115"><span class="linenos">115</span></a><span class="sd">        angles: Optional array of angles for plane wave sources (degrees)</span>
</span><span id="Sources-116"><a href="#Sources-116"><span class="linenos">116</span></a>
</span><span id="Sources-117"><a href="#Sources-117"><span class="linenos">117</span></a><span class="sd">    Example:</span>
</span><span id="Sources-118"><a href="#Sources-118"><span class="linenos">118</span></a><span class="sd">        &gt;&gt;&gt; # Single point source</span>
</span><span id="Sources-119"><a href="#Sources-119"><span class="linenos">119</span></a><span class="sd">        &gt;&gt;&gt; sources = Sources(</span>
</span><span id="Sources-120"><a href="#Sources-120"><span class="linenos">120</span></a><span class="sd">        ...     positions=np.array([[135.0, -25.0]]),</span>
</span><span id="Sources-121"><a href="#Sources-121"><span class="linenos">121</span></a><span class="sd">        ...     source_type=1</span>
</span><span id="Sources-122"><a href="#Sources-122"><span class="linenos">122</span></a><span class="sd">        ... )</span>
</span><span id="Sources-123"><a href="#Sources-123"><span class="linenos">123</span></a>
</span><span id="Sources-124"><a href="#Sources-124"><span class="linenos">124</span></a><span class="sd">        &gt;&gt;&gt; # Multiple point sources</span>
</span><span id="Sources-125"><a href="#Sources-125"><span class="linenos">125</span></a><span class="sd">        &gt;&gt;&gt; positions = np.array([</span>
</span><span id="Sources-126"><a href="#Sources-126"><span class="linenos">126</span></a><span class="sd">        ...     [130.0, -30.0],</span>
</span><span id="Sources-127"><a href="#Sources-127"><span class="linenos">127</span></a><span class="sd">        ...     [135.0, -25.0],</span>
</span><span id="Sources-128"><a href="#Sources-128"><span class="linenos">128</span></a><span class="sd">        ...     [140.0, -20.0]</span>
</span><span id="Sources-129"><a href="#Sources-129"><span class="linenos">129</span></a><span class="sd">        ... ])</span>
</span><span id="Sources-130"><a href="#Sources-130"><span class="linenos">130</span></a><span class="sd">        &gt;&gt;&gt; sources = Sources(positions, source_type=1)</span>
</span><span id="Sources-131"><a href="#Sources-131"><span class="linenos">131</span></a>
</span><span id="Sources-132"><a href="#Sources-132"><span class="linenos">132</span></a><span class="sd">        &gt;&gt;&gt; # Plane wave sources with angles</span>
</span><span id="Sources-133"><a href="#Sources-133"><span class="linenos">133</span></a><span class="sd">        &gt;&gt;&gt; sources = Sources(</span>
</span><span id="Sources-134"><a href="#Sources-134"><span class="linenos">134</span></a><span class="sd">        ...     positions=np.array([[135.0, -25.0]]),</span>
</span><span id="Sources-135"><a href="#Sources-135"><span class="linenos">135</span></a><span class="sd">        ...     source_type=2,</span>
</span><span id="Sources-136"><a href="#Sources-136"><span class="linenos">136</span></a><span class="sd">        ...     angles=np.array([45.0])  # degrees</span>
</span><span id="Sources-137"><a href="#Sources-137"><span class="linenos">137</span></a><span class="sd">        ... )</span>
</span><span id="Sources-138"><a href="#Sources-138"><span class="linenos">138</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Sources-139"><a href="#Sources-139"><span class="linenos">139</span></a>
</span><span id="Sources-140"><a href="#Sources-140"><span class="linenos">140</span></a>    <span class="n">positions</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</span><span id="Sources-141"><a href="#Sources-141"><span class="linenos">141</span></a>    <span class="n">source_type</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Sources-142"><a href="#Sources-142"><span class="linenos">142</span></a>    <span class="n">angles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sources-143"><a href="#Sources-143"><span class="linenos">143</span></a>
</span><span id="Sources-144"><a href="#Sources-144"><span class="linenos">144</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sources-145"><a href="#Sources-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate source parameters.&quot;&quot;&quot;</span>
</span><span id="Sources-146"><a href="#Sources-146"><span class="linenos">146</span></a>        <span class="c1"># Ensure positions is numpy array</span>
</span><span id="Sources-147"><a href="#Sources-147"><span class="linenos">147</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="Sources-148"><a href="#Sources-148"><span class="linenos">148</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="Sources-149"><a href="#Sources-149"><span class="linenos">149</span></a>
</span><span id="Sources-150"><a href="#Sources-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
</span><span id="Sources-151"><a href="#Sources-151"><span class="linenos">151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="Sources-152"><a href="#Sources-152"><span class="linenos">152</span></a>
</span><span id="Sources-153"><a href="#Sources-153"><span class="linenos">153</span></a>        <span class="c1"># Validate shape</span>
</span><span id="Sources-154"><a href="#Sources-154"><span class="linenos">154</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Sources-155"><a href="#Sources-155"><span class="linenos">155</span></a>            <span class="c1"># Single source provided as 1D array [x, y]</span>
</span><span id="Sources-156"><a href="#Sources-156"><span class="linenos">156</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Sources-157"><a href="#Sources-157"><span class="linenos">157</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Single source must be [x, y]&quot;</span><span class="p">)</span>
</span><span id="Sources-158"><a href="#Sources-158"><span class="linenos">158</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Sources-159"><a href="#Sources-159"><span class="linenos">159</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Sources-160"><a href="#Sources-160"><span class="linenos">160</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Sources-161"><a href="#Sources-161"><span class="linenos">161</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;positions must have shape (n, 2), got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Sources-162"><a href="#Sources-162"><span class="linenos">162</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Sources-163"><a href="#Sources-163"><span class="linenos">163</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;positions must be 1D or 2D array, got shape </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Sources-164"><a href="#Sources-164"><span class="linenos">164</span></a>
</span><span id="Sources-165"><a href="#Sources-165"><span class="linenos">165</span></a>        <span class="c1"># Validate source type</span>
</span><span id="Sources-166"><a href="#Sources-166"><span class="linenos">166</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
</span><span id="Sources-167"><a href="#Sources-167"><span class="linenos">167</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source_type must be 1 (point) or 2 (plane wave), got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">source_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Sources-168"><a href="#Sources-168"><span class="linenos">168</span></a>
</span><span id="Sources-169"><a href="#Sources-169"><span class="linenos">169</span></a>        <span class="c1"># Validate angles if provided</span>
</span><span id="Sources-170"><a href="#Sources-170"><span class="linenos">170</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Sources-171"><a href="#Sources-171"><span class="linenos">171</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="Sources-172"><a href="#Sources-172"><span class="linenos">172</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="Sources-173"><a href="#Sources-173"><span class="linenos">173</span></a>
</span><span id="Sources-174"><a href="#Sources-174"><span class="linenos">174</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
</span><span id="Sources-175"><a href="#Sources-175"><span class="linenos">175</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="Sources-176"><a href="#Sources-176"><span class="linenos">176</span></a>
</span><span id="Sources-177"><a href="#Sources-177"><span class="linenos">177</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span><span class="p">:</span>
</span><span id="Sources-178"><a href="#Sources-178"><span class="linenos">178</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Sources-179"><a href="#Sources-179"><span class="linenos">179</span></a>                    <span class="sa">f</span><span class="s2">&quot;angles length (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">)</span><span class="si">}</span><span class="s2">) must match number of sources (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Sources-180"><a href="#Sources-180"><span class="linenos">180</span></a>                <span class="p">)</span>
</span><span id="Sources-181"><a href="#Sources-181"><span class="linenos">181</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Sources-182"><a href="#Sources-182"><span class="linenos">182</span></a>            <span class="c1"># Create zero angles array</span>
</span><span id="Sources-183"><a href="#Sources-183"><span class="linenos">183</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="Sources-184"><a href="#Sources-184"><span class="linenos">184</span></a>
</span><span id="Sources-185"><a href="#Sources-185"><span class="linenos">185</span></a>    <span class="nd">@property</span>
</span><span id="Sources-186"><a href="#Sources-186"><span class="linenos">186</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">n_sources</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Sources-187"><a href="#Sources-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of sources.&quot;&quot;&quot;</span>
</span><span id="Sources-188"><a href="#Sources-188"><span class="linenos">188</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
</span><span id="Sources-189"><a href="#Sources-189"><span class="linenos">189</span></a>
</span><span id="Sources-190"><a href="#Sources-190"><span class="linenos">190</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Sources-191"><a href="#Sources-191"><span class="linenos">191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation.&quot;&quot;&quot;</span>
</span><span id="Sources-192"><a href="#Sources-192"><span class="linenos">192</span></a>        <span class="n">type_str</span> <span class="o">=</span> <span class="s2">&quot;point&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_type</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;plane wave&quot;</span>
</span><span id="Sources-193"><a href="#Sources-193"><span class="linenos">193</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Sources-194"><a href="#Sources-194"><span class="linenos">194</span></a>            <span class="sa">f</span><span class="s2">&quot;Sources(n=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sources</span><span class="si">}</span><span class="s2">, type=</span><span class="si">{</span><span class="n">type_str</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="Sources-195"><a href="#Sources-195"><span class="linenos">195</span></a>            <span class="sa">f</span><span class="s2">&quot;bounds=(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="Sources-196"><a href="#Sources-196"><span class="linenos">196</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">))&quot;</span>
</span><span id="Sources-197"><a href="#Sources-197"><span class="linenos">197</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Source configuration for wavefront tracking.</p>

<p>Attributes:
    positions: Array of source positions, shape (n_sources, 2) with columns [x, y]
    source_type: Source type (1=point source, 2=plane wave)
    angles: Optional array of angles for plane wave sources (degrees)</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <h1 id="single-point-source">Single point source</h1>
      
      <p>sources = Sources(
          ...     positions=np.array([[135.0, -25.0]]),
          ...     source_type=1
          ... )</p>

<pre><code>&gt;&gt;&gt; # Multiple point sources
&gt;&gt;&gt; positions = np.array([
...     [130.0, -30.0],
...     [135.0, -25.0],
...     [140.0, -20.0]
... ])
&gt;&gt;&gt; sources = Sources(positions, source_type=1)

&gt;&gt;&gt; # Plane wave sources with angles
&gt;&gt;&gt; sources = Sources(
...     positions=np.array([[135.0, -25.0]]),
...     source_type=2,
...     angles=np.array([45.0])  # degrees
... )
</code></pre>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            <div id="Sources.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Sources</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">positions</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">source_type</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">angles</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Sources.__init__"></a>
    
    

                            </div>
                            <div id="Sources.positions" class="classattr">
                                <div class="attr variable">
            <span class="name">positions</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Sources.positions"></a>
    
    

                            </div>
                            <div id="Sources.source_type" class="classattr">
                                <div class="attr variable">
            <span class="name">source_type</span><span class="annotation">: int</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#Sources.source_type"></a>
    
    

                            </div>
                            <div id="Sources.angles" class="classattr">
                                <div class="attr variable">
            <span class="name">angles</span><span class="annotation">: numpy.ndarray | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sources.angles"></a>
    
    

                            </div>
                            <div id="Sources.n_sources" class="classattr">
                                        <input id="Sources.n_sources-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">n_sources</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Sources.n_sources-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sources.n_sources"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sources.n_sources-185"><a href="#Sources.n_sources-185"><span class="linenos">185</span></a>    <span class="nd">@property</span>
</span><span id="Sources.n_sources-186"><a href="#Sources.n_sources-186"><span class="linenos">186</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">n_sources</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Sources.n_sources-187"><a href="#Sources.n_sources-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of sources.&quot;&quot;&quot;</span>
</span><span id="Sources.n_sources-188"><a href="#Sources.n_sources-188"><span class="linenos">188</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Number of sources.</p>
</div>


                            </div>
                </section>
                <section id="Receivers">
                            <input id="Receivers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Receivers</span>:

                <label class="view-source-button" for="Receivers-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Receivers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Receivers-200"><a href="#Receivers-200"><span class="linenos">200</span></a><span class="nd">@dataclass</span>
</span><span id="Receivers-201"><a href="#Receivers-201"><span class="linenos">201</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Receivers</span><span class="p">:</span>
</span><span id="Receivers-202"><a href="#Receivers-202"><span class="linenos">202</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Receiver configuration for wavefront tracking.</span>
</span><span id="Receivers-203"><a href="#Receivers-203"><span class="linenos">203</span></a>
</span><span id="Receivers-204"><a href="#Receivers-204"><span class="linenos">204</span></a><span class="sd">    Attributes:</span>
</span><span id="Receivers-205"><a href="#Receivers-205"><span class="linenos">205</span></a><span class="sd">        positions: Array of receiver positions, shape (n_receivers, 2) with columns [x, y]</span>
</span><span id="Receivers-206"><a href="#Receivers-206"><span class="linenos">206</span></a>
</span><span id="Receivers-207"><a href="#Receivers-207"><span class="linenos">207</span></a><span class="sd">    Example:</span>
</span><span id="Receivers-208"><a href="#Receivers-208"><span class="linenos">208</span></a><span class="sd">        &gt;&gt;&gt; # Regular grid of receivers</span>
</span><span id="Receivers-209"><a href="#Receivers-209"><span class="linenos">209</span></a><span class="sd">        &gt;&gt;&gt; x = np.linspace(110, 160, 50)</span>
</span><span id="Receivers-210"><a href="#Receivers-210"><span class="linenos">210</span></a><span class="sd">        &gt;&gt;&gt; y = np.linspace(-45, -10, 40)</span>
</span><span id="Receivers-211"><a href="#Receivers-211"><span class="linenos">211</span></a><span class="sd">        &gt;&gt;&gt; xx, yy = np.meshgrid(x, y)</span>
</span><span id="Receivers-212"><a href="#Receivers-212"><span class="linenos">212</span></a><span class="sd">        &gt;&gt;&gt; positions = np.column_stack([xx.ravel(), yy.ravel()])</span>
</span><span id="Receivers-213"><a href="#Receivers-213"><span class="linenos">213</span></a><span class="sd">        &gt;&gt;&gt; receivers = Receivers(positions)</span>
</span><span id="Receivers-214"><a href="#Receivers-214"><span class="linenos">214</span></a>
</span><span id="Receivers-215"><a href="#Receivers-215"><span class="linenos">215</span></a><span class="sd">        &gt;&gt;&gt; # Or manually specified receivers</span>
</span><span id="Receivers-216"><a href="#Receivers-216"><span class="linenos">216</span></a><span class="sd">        &gt;&gt;&gt; positions = np.array([</span>
</span><span id="Receivers-217"><a href="#Receivers-217"><span class="linenos">217</span></a><span class="sd">        ...     [120.0, -40.0],</span>
</span><span id="Receivers-218"><a href="#Receivers-218"><span class="linenos">218</span></a><span class="sd">        ...     [130.0, -30.0],</span>
</span><span id="Receivers-219"><a href="#Receivers-219"><span class="linenos">219</span></a><span class="sd">        ...     [140.0, -20.0]</span>
</span><span id="Receivers-220"><a href="#Receivers-220"><span class="linenos">220</span></a><span class="sd">        ... ])</span>
</span><span id="Receivers-221"><a href="#Receivers-221"><span class="linenos">221</span></a><span class="sd">        &gt;&gt;&gt; receivers = Receivers(positions)</span>
</span><span id="Receivers-222"><a href="#Receivers-222"><span class="linenos">222</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Receivers-223"><a href="#Receivers-223"><span class="linenos">223</span></a>
</span><span id="Receivers-224"><a href="#Receivers-224"><span class="linenos">224</span></a>    <span class="n">positions</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</span><span id="Receivers-225"><a href="#Receivers-225"><span class="linenos">225</span></a>
</span><span id="Receivers-226"><a href="#Receivers-226"><span class="linenos">226</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Receivers-227"><a href="#Receivers-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate receiver parameters.&quot;&quot;&quot;</span>
</span><span id="Receivers-228"><a href="#Receivers-228"><span class="linenos">228</span></a>        <span class="c1"># Ensure positions is numpy array</span>
</span><span id="Receivers-229"><a href="#Receivers-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="Receivers-230"><a href="#Receivers-230"><span class="linenos">230</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="Receivers-231"><a href="#Receivers-231"><span class="linenos">231</span></a>
</span><span id="Receivers-232"><a href="#Receivers-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
</span><span id="Receivers-233"><a href="#Receivers-233"><span class="linenos">233</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="Receivers-234"><a href="#Receivers-234"><span class="linenos">234</span></a>
</span><span id="Receivers-235"><a href="#Receivers-235"><span class="linenos">235</span></a>        <span class="c1"># Validate shape</span>
</span><span id="Receivers-236"><a href="#Receivers-236"><span class="linenos">236</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Receivers-237"><a href="#Receivers-237"><span class="linenos">237</span></a>            <span class="c1"># Single receiver provided as 1D array [x, y]</span>
</span><span id="Receivers-238"><a href="#Receivers-238"><span class="linenos">238</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Receivers-239"><a href="#Receivers-239"><span class="linenos">239</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Single receiver must be [x, y]&quot;</span><span class="p">)</span>
</span><span id="Receivers-240"><a href="#Receivers-240"><span class="linenos">240</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Receivers-241"><a href="#Receivers-241"><span class="linenos">241</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Receivers-242"><a href="#Receivers-242"><span class="linenos">242</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Receivers-243"><a href="#Receivers-243"><span class="linenos">243</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;positions must have shape (n, 2), got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Receivers-244"><a href="#Receivers-244"><span class="linenos">244</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Receivers-245"><a href="#Receivers-245"><span class="linenos">245</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;positions must be 1D or 2D array, got shape </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Receivers-246"><a href="#Receivers-246"><span class="linenos">246</span></a>
</span><span id="Receivers-247"><a href="#Receivers-247"><span class="linenos">247</span></a>    <span class="nd">@property</span>
</span><span id="Receivers-248"><a href="#Receivers-248"><span class="linenos">248</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">n_receivers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Receivers-249"><a href="#Receivers-249"><span class="linenos">249</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of receivers.&quot;&quot;&quot;</span>
</span><span id="Receivers-250"><a href="#Receivers-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
</span><span id="Receivers-251"><a href="#Receivers-251"><span class="linenos">251</span></a>
</span><span id="Receivers-252"><a href="#Receivers-252"><span class="linenos">252</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Receivers-253"><a href="#Receivers-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation.&quot;&quot;&quot;</span>
</span><span id="Receivers-254"><a href="#Receivers-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Receivers-255"><a href="#Receivers-255"><span class="linenos">255</span></a>            <span class="sa">f</span><span class="s2">&quot;Receivers(n=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_receivers</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="Receivers-256"><a href="#Receivers-256"><span class="linenos">256</span></a>            <span class="sa">f</span><span class="s2">&quot;bounds=(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="Receivers-257"><a href="#Receivers-257"><span class="linenos">257</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">))&quot;</span>
</span><span id="Receivers-258"><a href="#Receivers-258"><span class="linenos">258</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Receiver configuration for wavefront tracking.</p>

<p>Attributes:
    positions: Array of receiver positions, shape (n_receivers, 2) with columns [x, y]</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <h1 id="regular-grid-of-receivers">Regular grid of receivers</h1>
      
      <p>x = np.linspace(110, 160, 50)
      y = np.linspace(-45, -10, 40)
      xx, yy = np.meshgrid(x, y)
      positions = np.column_stack([xx.ravel(), yy.ravel()])
      receivers = Receivers(positions)</p>

<pre><code>&gt;&gt;&gt; # Or manually specified receivers
&gt;&gt;&gt; positions = np.array([
...     [120.0, -40.0],
...     [130.0, -30.0],
...     [140.0, -20.0]
... ])
&gt;&gt;&gt; receivers = Receivers(positions)
</code></pre>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            <div id="Receivers.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Receivers</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">positions</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Receivers.__init__"></a>
    
    

                            </div>
                            <div id="Receivers.positions" class="classattr">
                                <div class="attr variable">
            <span class="name">positions</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Receivers.positions"></a>
    
    

                            </div>
                            <div id="Receivers.n_receivers" class="classattr">
                                        <input id="Receivers.n_receivers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">n_receivers</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Receivers.n_receivers-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Receivers.n_receivers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Receivers.n_receivers-247"><a href="#Receivers.n_receivers-247"><span class="linenos">247</span></a>    <span class="nd">@property</span>
</span><span id="Receivers.n_receivers-248"><a href="#Receivers.n_receivers-248"><span class="linenos">248</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">n_receivers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Receivers.n_receivers-249"><a href="#Receivers.n_receivers-249"><span class="linenos">249</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of receivers.&quot;&quot;&quot;</span>
</span><span id="Receivers.n_receivers-250"><a href="#Receivers.n_receivers-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Number of receivers.</p>
</div>


                            </div>
                </section>
                <section id="create_constant_velocity_model">
                            <input id="create_constant_velocity_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_constant_velocity_model</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">nx</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">ny</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">x0</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y0</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">dx</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">dy</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">velocity</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">cushion_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span></span><span class="return-annotation">) -> <span class="n"><a href="#VelocityModel2D">VelocityModel2D</a></span>:</span></span>

                <label class="view-source-button" for="create_constant_velocity_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_constant_velocity_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_constant_velocity_model-261"><a href="#create_constant_velocity_model-261"><span class="linenos">261</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_constant_velocity_model</span><span class="p">(</span>
</span><span id="create_constant_velocity_model-262"><a href="#create_constant_velocity_model-262"><span class="linenos">262</span></a>    <span class="n">nx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="create_constant_velocity_model-263"><a href="#create_constant_velocity_model-263"><span class="linenos">263</span></a>    <span class="n">ny</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="create_constant_velocity_model-264"><a href="#create_constant_velocity_model-264"><span class="linenos">264</span></a>    <span class="n">x0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_constant_velocity_model-265"><a href="#create_constant_velocity_model-265"><span class="linenos">265</span></a>    <span class="n">y0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_constant_velocity_model-266"><a href="#create_constant_velocity_model-266"><span class="linenos">266</span></a>    <span class="n">dx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_constant_velocity_model-267"><a href="#create_constant_velocity_model-267"><span class="linenos">267</span></a>    <span class="n">dy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_constant_velocity_model-268"><a href="#create_constant_velocity_model-268"><span class="linenos">268</span></a>    <span class="n">velocity</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_constant_velocity_model-269"><a href="#create_constant_velocity_model-269"><span class="linenos">269</span></a>    <span class="n">cushion_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="create_constant_velocity_model-270"><a href="#create_constant_velocity_model-270"><span class="linenos">270</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VelocityModel2D</span><span class="p">:</span>
</span><span id="create_constant_velocity_model-271"><a href="#create_constant_velocity_model-271"><span class="linenos">271</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a constant velocity model.</span>
</span><span id="create_constant_velocity_model-272"><a href="#create_constant_velocity_model-272"><span class="linenos">272</span></a>
</span><span id="create_constant_velocity_model-273"><a href="#create_constant_velocity_model-273"><span class="linenos">273</span></a><span class="sd">    Args:</span>
</span><span id="create_constant_velocity_model-274"><a href="#create_constant_velocity_model-274"><span class="linenos">274</span></a><span class="sd">        nx, ny: Grid dimensions</span>
</span><span id="create_constant_velocity_model-275"><a href="#create_constant_velocity_model-275"><span class="linenos">275</span></a><span class="sd">        x0, y0: Lower-left corner coordinates</span>
</span><span id="create_constant_velocity_model-276"><a href="#create_constant_velocity_model-276"><span class="linenos">276</span></a><span class="sd">        dx, dy: Grid spacings</span>
</span><span id="create_constant_velocity_model-277"><a href="#create_constant_velocity_model-277"><span class="linenos">277</span></a><span class="sd">        velocity: Constant velocity value</span>
</span><span id="create_constant_velocity_model-278"><a href="#create_constant_velocity_model-278"><span class="linenos">278</span></a><span class="sd">        cushion_nodes: Number of cushion nodes</span>
</span><span id="create_constant_velocity_model-279"><a href="#create_constant_velocity_model-279"><span class="linenos">279</span></a>
</span><span id="create_constant_velocity_model-280"><a href="#create_constant_velocity_model-280"><span class="linenos">280</span></a><span class="sd">    Returns:</span>
</span><span id="create_constant_velocity_model-281"><a href="#create_constant_velocity_model-281"><span class="linenos">281</span></a><span class="sd">        VelocityModel2D instance</span>
</span><span id="create_constant_velocity_model-282"><a href="#create_constant_velocity_model-282"><span class="linenos">282</span></a>
</span><span id="create_constant_velocity_model-283"><a href="#create_constant_velocity_model-283"><span class="linenos">283</span></a><span class="sd">    Example:</span>
</span><span id="create_constant_velocity_model-284"><a href="#create_constant_velocity_model-284"><span class="linenos">284</span></a><span class="sd">        &gt;&gt;&gt; model = create_constant_velocity_model(</span>
</span><span id="create_constant_velocity_model-285"><a href="#create_constant_velocity_model-285"><span class="linenos">285</span></a><span class="sd">        ...     nx=100, ny=80,</span>
</span><span id="create_constant_velocity_model-286"><a href="#create_constant_velocity_model-286"><span class="linenos">286</span></a><span class="sd">        ...     x0=110.0, y0=-45.0,</span>
</span><span id="create_constant_velocity_model-287"><a href="#create_constant_velocity_model-287"><span class="linenos">287</span></a><span class="sd">        ...     dx=0.5, dy=0.5,</span>
</span><span id="create_constant_velocity_model-288"><a href="#create_constant_velocity_model-288"><span class="linenos">288</span></a><span class="sd">        ...     velocity=3.5</span>
</span><span id="create_constant_velocity_model-289"><a href="#create_constant_velocity_model-289"><span class="linenos">289</span></a><span class="sd">        ... )</span>
</span><span id="create_constant_velocity_model-290"><a href="#create_constant_velocity_model-290"><span class="linenos">290</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_constant_velocity_model-291"><a href="#create_constant_velocity_model-291"><span class="linenos">291</span></a>    <span class="n">velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">),</span> <span class="n">velocity</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="create_constant_velocity_model-292"><a href="#create_constant_velocity_model-292"><span class="linenos">292</span></a>    <span class="k">return</span> <span class="n">VelocityModel2D</span><span class="p">(</span><span class="n">velocities</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">cushion_nodes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a constant velocity model.</p>

<p>Args:
    nx, ny: Grid dimensions
    x0, y0: Lower-left corner coordinates
    dx, dy: Grid spacings
    velocity: Constant velocity value
    cushion_nodes: Number of cushion nodes</p>

<p>Returns:
    VelocityModel2D instance</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>model = create_constant_velocity_model(
          ...     nx=100, ny=80,
          ...     x0=110.0, y0=-45.0,
          ...     dx=0.5, dy=0.5,
          ...     velocity=3.5
          ... )</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="create_gradient_velocity_model">
                            <input id="create_gradient_velocity_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_gradient_velocity_model</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">nx</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">ny</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">x0</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">y0</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">dx</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">dy</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">v0</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">gradient_x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">gradient_y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">cushion_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span></span><span class="return-annotation">) -> <span class="n"><a href="#VelocityModel2D">VelocityModel2D</a></span>:</span></span>

                <label class="view-source-button" for="create_gradient_velocity_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_gradient_velocity_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_gradient_velocity_model-374"><a href="#create_gradient_velocity_model-374"><span class="linenos">374</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_gradient_velocity_model</span><span class="p">(</span>
</span><span id="create_gradient_velocity_model-375"><a href="#create_gradient_velocity_model-375"><span class="linenos">375</span></a>    <span class="n">nx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="create_gradient_velocity_model-376"><a href="#create_gradient_velocity_model-376"><span class="linenos">376</span></a>    <span class="n">ny</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="create_gradient_velocity_model-377"><a href="#create_gradient_velocity_model-377"><span class="linenos">377</span></a>    <span class="n">x0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_gradient_velocity_model-378"><a href="#create_gradient_velocity_model-378"><span class="linenos">378</span></a>    <span class="n">y0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_gradient_velocity_model-379"><a href="#create_gradient_velocity_model-379"><span class="linenos">379</span></a>    <span class="n">dx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_gradient_velocity_model-380"><a href="#create_gradient_velocity_model-380"><span class="linenos">380</span></a>    <span class="n">dy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_gradient_velocity_model-381"><a href="#create_gradient_velocity_model-381"><span class="linenos">381</span></a>    <span class="n">v0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_gradient_velocity_model-382"><a href="#create_gradient_velocity_model-382"><span class="linenos">382</span></a>    <span class="n">gradient_x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_gradient_velocity_model-383"><a href="#create_gradient_velocity_model-383"><span class="linenos">383</span></a>    <span class="n">gradient_y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_gradient_velocity_model-384"><a href="#create_gradient_velocity_model-384"><span class="linenos">384</span></a>    <span class="n">cushion_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="create_gradient_velocity_model-385"><a href="#create_gradient_velocity_model-385"><span class="linenos">385</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VelocityModel2D</span><span class="p">:</span>
</span><span id="create_gradient_velocity_model-386"><a href="#create_gradient_velocity_model-386"><span class="linenos">386</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a velocity model with linear gradient.</span>
</span><span id="create_gradient_velocity_model-387"><a href="#create_gradient_velocity_model-387"><span class="linenos">387</span></a>
</span><span id="create_gradient_velocity_model-388"><a href="#create_gradient_velocity_model-388"><span class="linenos">388</span></a><span class="sd">    Args:</span>
</span><span id="create_gradient_velocity_model-389"><a href="#create_gradient_velocity_model-389"><span class="linenos">389</span></a><span class="sd">        nx, ny: Grid dimensions</span>
</span><span id="create_gradient_velocity_model-390"><a href="#create_gradient_velocity_model-390"><span class="linenos">390</span></a><span class="sd">        x0, y0: Lower-left corner coordinates</span>
</span><span id="create_gradient_velocity_model-391"><a href="#create_gradient_velocity_model-391"><span class="linenos">391</span></a><span class="sd">        dx, dy: Grid spacings</span>
</span><span id="create_gradient_velocity_model-392"><a href="#create_gradient_velocity_model-392"><span class="linenos">392</span></a><span class="sd">        v0: Velocity at (x0, y0)</span>
</span><span id="create_gradient_velocity_model-393"><a href="#create_gradient_velocity_model-393"><span class="linenos">393</span></a><span class="sd">        gradient_x: Velocity gradient in X direction (dv/dx)</span>
</span><span id="create_gradient_velocity_model-394"><a href="#create_gradient_velocity_model-394"><span class="linenos">394</span></a><span class="sd">        gradient_y: Velocity gradient in Y direction (dv/dy)</span>
</span><span id="create_gradient_velocity_model-395"><a href="#create_gradient_velocity_model-395"><span class="linenos">395</span></a><span class="sd">        cushion_nodes: Number of cushion nodes</span>
</span><span id="create_gradient_velocity_model-396"><a href="#create_gradient_velocity_model-396"><span class="linenos">396</span></a>
</span><span id="create_gradient_velocity_model-397"><a href="#create_gradient_velocity_model-397"><span class="linenos">397</span></a><span class="sd">    Returns:</span>
</span><span id="create_gradient_velocity_model-398"><a href="#create_gradient_velocity_model-398"><span class="linenos">398</span></a><span class="sd">        VelocityModel2D instance</span>
</span><span id="create_gradient_velocity_model-399"><a href="#create_gradient_velocity_model-399"><span class="linenos">399</span></a>
</span><span id="create_gradient_velocity_model-400"><a href="#create_gradient_velocity_model-400"><span class="linenos">400</span></a><span class="sd">    Example:</span>
</span><span id="create_gradient_velocity_model-401"><a href="#create_gradient_velocity_model-401"><span class="linenos">401</span></a><span class="sd">        &gt;&gt;&gt; # Velocity increasing to the east</span>
</span><span id="create_gradient_velocity_model-402"><a href="#create_gradient_velocity_model-402"><span class="linenos">402</span></a><span class="sd">        &gt;&gt;&gt; model = create_gradient_velocity_model(</span>
</span><span id="create_gradient_velocity_model-403"><a href="#create_gradient_velocity_model-403"><span class="linenos">403</span></a><span class="sd">        ...     nx=100, ny=80,</span>
</span><span id="create_gradient_velocity_model-404"><a href="#create_gradient_velocity_model-404"><span class="linenos">404</span></a><span class="sd">        ...     x0=110.0, y0=-45.0,</span>
</span><span id="create_gradient_velocity_model-405"><a href="#create_gradient_velocity_model-405"><span class="linenos">405</span></a><span class="sd">        ...     dx=0.5, dy=0.5,</span>
</span><span id="create_gradient_velocity_model-406"><a href="#create_gradient_velocity_model-406"><span class="linenos">406</span></a><span class="sd">        ...     v0=3.0,</span>
</span><span id="create_gradient_velocity_model-407"><a href="#create_gradient_velocity_model-407"><span class="linenos">407</span></a><span class="sd">        ...     gradient_x=0.01  # +0.01 km/s per degree longitude</span>
</span><span id="create_gradient_velocity_model-408"><a href="#create_gradient_velocity_model-408"><span class="linenos">408</span></a><span class="sd">        ... )</span>
</span><span id="create_gradient_velocity_model-409"><a href="#create_gradient_velocity_model-409"><span class="linenos">409</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_gradient_velocity_model-410"><a href="#create_gradient_velocity_model-410"><span class="linenos">410</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">x0</span>
</span><span id="create_gradient_velocity_model-411"><a href="#create_gradient_velocity_model-411"><span class="linenos">411</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ny</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">+</span> <span class="n">y0</span>
</span><span id="create_gradient_velocity_model-412"><a href="#create_gradient_velocity_model-412"><span class="linenos">412</span></a>    <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
</span><span id="create_gradient_velocity_model-413"><a href="#create_gradient_velocity_model-413"><span class="linenos">413</span></a>
</span><span id="create_gradient_velocity_model-414"><a href="#create_gradient_velocity_model-414"><span class="linenos">414</span></a>    <span class="n">velocities</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">+</span> <span class="n">gradient_x</span> <span class="o">*</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">+</span> <span class="n">gradient_y</span> <span class="o">*</span> <span class="p">(</span><span class="n">yy</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span>
</span><span id="create_gradient_velocity_model-415"><a href="#create_gradient_velocity_model-415"><span class="linenos">415</span></a>    <span class="k">return</span> <span class="n">VelocityModel2D</span><span class="p">(</span><span class="n">velocities</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">cushion_nodes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a velocity model with linear gradient.</p>

<p>Args:
    nx, ny: Grid dimensions
    x0, y0: Lower-left corner coordinates
    dx, dy: Grid spacings
    v0: Velocity at (x0, y0)
    gradient_x: Velocity gradient in X direction (dv/dx)
    gradient_y: Velocity gradient in Y direction (dv/dy)
    cushion_nodes: Number of cushion nodes</p>

<p>Returns:
    VelocityModel2D instance</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <h1 id="velocity-increasing-to-the-east">Velocity increasing to the east</h1>
      
      <p>model = create_gradient_velocity_model(
          ...     nx=100, ny=80,
          ...     x0=110.0, y0=-45.0,
          ...     dx=0.5, dy=0.5,
          ...     v0=3.0,
          ...     gradient_x=0.01  # +0.01 km/s per degree longitude
          ... )</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="write_velocity_model_file">
                            <input id="write_velocity_model_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_velocity_model_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">model</span><span class="p">:</span> <span class="n"><a href="#VelocityModel2D">VelocityModel2D</a></span>, </span><span class="param"><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="write_velocity_model_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#write_velocity_model_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="write_velocity_model_file-418"><a href="#write_velocity_model_file-418"><span class="linenos">418</span></a><span class="k">def</span><span class="w"> </span><span class="nf">write_velocity_model_file</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">VelocityModel2D</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="write_velocity_model_file-419"><a href="#write_velocity_model_file-419"><span class="linenos">419</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write velocity model to binary file compatible with SWMP.</span>
</span><span id="write_velocity_model_file-420"><a href="#write_velocity_model_file-420"><span class="linenos">420</span></a>
</span><span id="write_velocity_model_file-421"><a href="#write_velocity_model_file-421"><span class="linenos">421</span></a><span class="sd">    Args:</span>
</span><span id="write_velocity_model_file-422"><a href="#write_velocity_model_file-422"><span class="linenos">422</span></a><span class="sd">        model: VelocityModel2D object</span>
</span><span id="write_velocity_model_file-423"><a href="#write_velocity_model_file-423"><span class="linenos">423</span></a><span class="sd">        filename: Output filename</span>
</span><span id="write_velocity_model_file-424"><a href="#write_velocity_model_file-424"><span class="linenos">424</span></a>
</span><span id="write_velocity_model_file-425"><a href="#write_velocity_model_file-425"><span class="linenos">425</span></a><span class="sd">    Raises:</span>
</span><span id="write_velocity_model_file-426"><a href="#write_velocity_model_file-426"><span class="linenos">426</span></a><span class="sd">        ValueError: If model is too large (&gt;1GB)</span>
</span><span id="write_velocity_model_file-427"><a href="#write_velocity_model_file-427"><span class="linenos">427</span></a>
</span><span id="write_velocity_model_file-428"><a href="#write_velocity_model_file-428"><span class="linenos">428</span></a><span class="sd">    Example:</span>
</span><span id="write_velocity_model_file-429"><a href="#write_velocity_model_file-429"><span class="linenos">429</span></a><span class="sd">        &gt;&gt;&gt; model = create_constant_velocity_model(100, 80, 110, -45, 0.5, 0.5, 3.5)</span>
</span><span id="write_velocity_model_file-430"><a href="#write_velocity_model_file-430"><span class="linenos">430</span></a><span class="sd">        &gt;&gt;&gt; write_velocity_model_file(model, &#39;model.vel&#39;)</span>
</span><span id="write_velocity_model_file-431"><a href="#write_velocity_model_file-431"><span class="linenos">431</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="write_velocity_model_file-432"><a href="#write_velocity_model_file-432"><span class="linenos">432</span></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">struct</span>
</span><span id="write_velocity_model_file-433"><a href="#write_velocity_model_file-433"><span class="linenos">433</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="write_velocity_model_file-434"><a href="#write_velocity_model_file-434"><span class="linenos">434</span></a>
</span><span id="write_velocity_model_file-435"><a href="#write_velocity_model_file-435"><span class="linenos">435</span></a>    <span class="c1"># Security: Prevent path traversal and validate file size</span>
</span><span id="write_velocity_model_file-436"><a href="#write_velocity_model_file-436"><span class="linenos">436</span></a>    <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
</span><span id="write_velocity_model_file-437"><a href="#write_velocity_model_file-437"><span class="linenos">437</span></a>
</span><span id="write_velocity_model_file-438"><a href="#write_velocity_model_file-438"><span class="linenos">438</span></a>    <span class="c1"># Estimate file size: header + velocity data (float32)</span>
</span><span id="write_velocity_model_file-439"><a href="#write_velocity_model_file-439"><span class="linenos">439</span></a>    <span class="n">header_size</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span>  <span class="c1"># 4 doubles, 3 ints</span>
</span><span id="write_velocity_model_file-440"><a href="#write_velocity_model_file-440"><span class="linenos">440</span></a>    <span class="n">data_size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">nx</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">ny</span> <span class="o">*</span> <span class="mi">4</span>  <span class="c1"># float32 = 4 bytes</span>
</span><span id="write_velocity_model_file-441"><a href="#write_velocity_model_file-441"><span class="linenos">441</span></a>    <span class="n">estimated_size</span> <span class="o">=</span> <span class="n">header_size</span> <span class="o">+</span> <span class="n">data_size</span>
</span><span id="write_velocity_model_file-442"><a href="#write_velocity_model_file-442"><span class="linenos">442</span></a>
</span><span id="write_velocity_model_file-443"><a href="#write_velocity_model_file-443"><span class="linenos">443</span></a>    <span class="c1"># Check size limit (1GB = 1,073,741,824 bytes)</span>
</span><span id="write_velocity_model_file-444"><a href="#write_velocity_model_file-444"><span class="linenos">444</span></a>    <span class="n">MAX_FILE_SIZE</span> <span class="o">=</span> <span class="mi">1_073_741_824</span>
</span><span id="write_velocity_model_file-445"><a href="#write_velocity_model_file-445"><span class="linenos">445</span></a>    <span class="k">if</span> <span class="n">estimated_size</span> <span class="o">&gt;</span> <span class="n">MAX_FILE_SIZE</span><span class="p">:</span>
</span><span id="write_velocity_model_file-446"><a href="#write_velocity_model_file-446"><span class="linenos">446</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="write_velocity_model_file-447"><a href="#write_velocity_model_file-447"><span class="linenos">447</span></a>            <span class="sa">f</span><span class="s2">&quot;Model too large: </span><span class="si">{</span><span class="n">estimated_size</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> bytes (max </span><span class="si">{</span><span class="n">MAX_FILE_SIZE</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> bytes). &quot;</span>
</span><span id="write_velocity_model_file-448"><a href="#write_velocity_model_file-448"><span class="linenos">448</span></a>            <span class="sa">f</span><span class="s2">&quot;Model has </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">nx</span><span class="si">}</span><span class="s2"> x </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">ny</span><span class="si">}</span><span class="s2"> grid points.&quot;</span>
</span><span id="write_velocity_model_file-449"><a href="#write_velocity_model_file-449"><span class="linenos">449</span></a>        <span class="p">)</span>
</span><span id="write_velocity_model_file-450"><a href="#write_velocity_model_file-450"><span class="linenos">450</span></a>
</span><span id="write_velocity_model_file-451"><a href="#write_velocity_model_file-451"><span class="linenos">451</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="write_velocity_model_file-452"><a href="#write_velocity_model_file-452"><span class="linenos">452</span></a>        <span class="c1"># Write header: x0, y0, nx, ny, dx, dy, cn (all as doubles except nx, ny, cn as ints)</span>
</span><span id="write_velocity_model_file-453"><a href="#write_velocity_model_file-453"><span class="linenos">453</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">x0</span><span class="p">))</span>
</span><span id="write_velocity_model_file-454"><a href="#write_velocity_model_file-454"><span class="linenos">454</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">y0</span><span class="p">))</span>
</span><span id="write_velocity_model_file-455"><a href="#write_velocity_model_file-455"><span class="linenos">455</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">nx</span><span class="p">))</span>
</span><span id="write_velocity_model_file-456"><a href="#write_velocity_model_file-456"><span class="linenos">456</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">ny</span><span class="p">))</span>
</span><span id="write_velocity_model_file-457"><a href="#write_velocity_model_file-457"><span class="linenos">457</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">dx</span><span class="p">))</span>
</span><span id="write_velocity_model_file-458"><a href="#write_velocity_model_file-458"><span class="linenos">458</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">dy</span><span class="p">))</span>
</span><span id="write_velocity_model_file-459"><a href="#write_velocity_model_file-459"><span class="linenos">459</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">cushion_nodes</span><span class="p">))</span>
</span><span id="write_velocity_model_file-460"><a href="#write_velocity_model_file-460"><span class="linenos">460</span></a>
</span><span id="write_velocity_model_file-461"><a href="#write_velocity_model_file-461"><span class="linenos">461</span></a>        <span class="c1"># Write velocity values in Fortran order (column-major)</span>
</span><span id="write_velocity_model_file-462"><a href="#write_velocity_model_file-462"><span class="linenos">462</span></a>        <span class="n">vel_fortran</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span>
</span><span id="write_velocity_model_file-463"><a href="#write_velocity_model_file-463"><span class="linenos">463</span></a>        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vel_fortran</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
</span><span id="write_velocity_model_file-464"><a href="#write_velocity_model_file-464"><span class="linenos">464</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>  <span class="c1"># float32</span>
</span></pre></div>


            <div class="docstring"><p>Write velocity model to binary file compatible with SWMP.</p>

<p>Args:
    model: VelocityModel2D object
    filename: Output filename</p>

<p>Raises:
    ValueError: If model is too large (&gt;1GB)</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>model = create_constant_velocity_model(100, 80, 110, -45, 0.5, 0.5, 3.5)
      write_velocity_model_file(model, 'model.vel')</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="write_sources_file">
                            <input id="write_sources_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_sources_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">sources</span><span class="p">:</span> <span class="n"><a href="#Sources">Sources</a></span>, </span><span class="param"><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="write_sources_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#write_sources_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="write_sources_file-295"><a href="#write_sources_file-295"><span class="linenos">295</span></a><span class="k">def</span><span class="w"> </span><span class="nf">write_sources_file</span><span class="p">(</span><span class="n">sources</span><span class="p">:</span> <span class="n">Sources</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="write_sources_file-296"><a href="#write_sources_file-296"><span class="linenos">296</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write sources to binary file compatible with SWMP.</span>
</span><span id="write_sources_file-297"><a href="#write_sources_file-297"><span class="linenos">297</span></a>
</span><span id="write_sources_file-298"><a href="#write_sources_file-298"><span class="linenos">298</span></a><span class="sd">    Args:</span>
</span><span id="write_sources_file-299"><a href="#write_sources_file-299"><span class="linenos">299</span></a><span class="sd">        sources: Sources object</span>
</span><span id="write_sources_file-300"><a href="#write_sources_file-300"><span class="linenos">300</span></a><span class="sd">        filename: Output filename</span>
</span><span id="write_sources_file-301"><a href="#write_sources_file-301"><span class="linenos">301</span></a>
</span><span id="write_sources_file-302"><a href="#write_sources_file-302"><span class="linenos">302</span></a><span class="sd">    Raises:</span>
</span><span id="write_sources_file-303"><a href="#write_sources_file-303"><span class="linenos">303</span></a><span class="sd">        ValueError: If too many sources (&gt;1 million)</span>
</span><span id="write_sources_file-304"><a href="#write_sources_file-304"><span class="linenos">304</span></a>
</span><span id="write_sources_file-305"><a href="#write_sources_file-305"><span class="linenos">305</span></a><span class="sd">    Example:</span>
</span><span id="write_sources_file-306"><a href="#write_sources_file-306"><span class="linenos">306</span></a><span class="sd">        &gt;&gt;&gt; sources = Sources(positions=np.array([[135.0, -25.0]]))</span>
</span><span id="write_sources_file-307"><a href="#write_sources_file-307"><span class="linenos">307</span></a><span class="sd">        &gt;&gt;&gt; write_sources_file(sources, &#39;sources.dat&#39;)</span>
</span><span id="write_sources_file-308"><a href="#write_sources_file-308"><span class="linenos">308</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="write_sources_file-309"><a href="#write_sources_file-309"><span class="linenos">309</span></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">struct</span>
</span><span id="write_sources_file-310"><a href="#write_sources_file-310"><span class="linenos">310</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="write_sources_file-311"><a href="#write_sources_file-311"><span class="linenos">311</span></a>
</span><span id="write_sources_file-312"><a href="#write_sources_file-312"><span class="linenos">312</span></a>    <span class="c1"># Security: Validate number of sources</span>
</span><span id="write_sources_file-313"><a href="#write_sources_file-313"><span class="linenos">313</span></a>    <span class="n">MAX_SOURCES</span> <span class="o">=</span> <span class="mi">1_000_000</span>
</span><span id="write_sources_file-314"><a href="#write_sources_file-314"><span class="linenos">314</span></a>    <span class="k">if</span> <span class="n">sources</span><span class="o">.</span><span class="n">n_sources</span> <span class="o">&gt;</span> <span class="n">MAX_SOURCES</span><span class="p">:</span>
</span><span id="write_sources_file-315"><a href="#write_sources_file-315"><span class="linenos">315</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="write_sources_file-316"><a href="#write_sources_file-316"><span class="linenos">316</span></a>            <span class="sa">f</span><span class="s2">&quot;Too many sources: </span><span class="si">{</span><span class="n">sources</span><span class="o">.</span><span class="n">n_sources</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> (max </span><span class="si">{</span><span class="n">MAX_SOURCES</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="write_sources_file-317"><a href="#write_sources_file-317"><span class="linenos">317</span></a>        <span class="p">)</span>
</span><span id="write_sources_file-318"><a href="#write_sources_file-318"><span class="linenos">318</span></a>
</span><span id="write_sources_file-319"><a href="#write_sources_file-319"><span class="linenos">319</span></a>    <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
</span><span id="write_sources_file-320"><a href="#write_sources_file-320"><span class="linenos">320</span></a>
</span><span id="write_sources_file-321"><a href="#write_sources_file-321"><span class="linenos">321</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="write_sources_file-322"><a href="#write_sources_file-322"><span class="linenos">322</span></a>        <span class="c1"># Write number of sources as integer (4 bytes)</span>
</span><span id="write_sources_file-323"><a href="#write_sources_file-323"><span class="linenos">323</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">sources</span><span class="o">.</span><span class="n">n_sources</span><span class="p">))</span>
</span><span id="write_sources_file-324"><a href="#write_sources_file-324"><span class="linenos">324</span></a>
</span><span id="write_sources_file-325"><a href="#write_sources_file-325"><span class="linenos">325</span></a>        <span class="c1"># Write source type as integer (4 bytes)</span>
</span><span id="write_sources_file-326"><a href="#write_sources_file-326"><span class="linenos">326</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">sources</span><span class="o">.</span><span class="n">source_type</span><span class="p">))</span>
</span><span id="write_sources_file-327"><a href="#write_sources_file-327"><span class="linenos">327</span></a>
</span><span id="write_sources_file-328"><a href="#write_sources_file-328"><span class="linenos">328</span></a>        <span class="c1"># Write positions as doubles (8 bytes each)</span>
</span><span id="write_sources_file-329"><a href="#write_sources_file-329"><span class="linenos">329</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sources</span><span class="o">.</span><span class="n">n_sources</span><span class="p">):</span>
</span><span id="write_sources_file-330"><a href="#write_sources_file-330"><span class="linenos">330</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">sources</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>  <span class="c1"># x/lon</span>
</span><span id="write_sources_file-331"><a href="#write_sources_file-331"><span class="linenos">331</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">sources</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>  <span class="c1"># y/lat</span>
</span><span id="write_sources_file-332"><a href="#write_sources_file-332"><span class="linenos">332</span></a>
</span><span id="write_sources_file-333"><a href="#write_sources_file-333"><span class="linenos">333</span></a>        <span class="c1"># Write angles as doubles (8 bytes each)</span>
</span><span id="write_sources_file-334"><a href="#write_sources_file-334"><span class="linenos">334</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sources</span><span class="o">.</span><span class="n">n_sources</span><span class="p">):</span>
</span><span id="write_sources_file-335"><a href="#write_sources_file-335"><span class="linenos">335</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">sources</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Write sources to binary file compatible with SWMP.</p>

<p>Args:
    sources: Sources object
    filename: Output filename</p>

<p>Raises:
    ValueError: If too many sources (&gt;1 million)</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>sources = Sources(positions=np.array([[135.0, -25.0]]))
      write_sources_file(sources, 'sources.dat')</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="write_receivers_file">
                            <input id="write_receivers_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_receivers_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">receivers</span><span class="p">:</span> <span class="n"><a href="#Receivers">Receivers</a></span>, </span><span class="param"><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="write_receivers_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#write_receivers_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="write_receivers_file-338"><a href="#write_receivers_file-338"><span class="linenos">338</span></a><span class="k">def</span><span class="w"> </span><span class="nf">write_receivers_file</span><span class="p">(</span><span class="n">receivers</span><span class="p">:</span> <span class="n">Receivers</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="write_receivers_file-339"><a href="#write_receivers_file-339"><span class="linenos">339</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write receivers to binary file compatible with SWMP.</span>
</span><span id="write_receivers_file-340"><a href="#write_receivers_file-340"><span class="linenos">340</span></a>
</span><span id="write_receivers_file-341"><a href="#write_receivers_file-341"><span class="linenos">341</span></a><span class="sd">    Args:</span>
</span><span id="write_receivers_file-342"><a href="#write_receivers_file-342"><span class="linenos">342</span></a><span class="sd">        receivers: Receivers object</span>
</span><span id="write_receivers_file-343"><a href="#write_receivers_file-343"><span class="linenos">343</span></a><span class="sd">        filename: Output filename</span>
</span><span id="write_receivers_file-344"><a href="#write_receivers_file-344"><span class="linenos">344</span></a>
</span><span id="write_receivers_file-345"><a href="#write_receivers_file-345"><span class="linenos">345</span></a><span class="sd">    Raises:</span>
</span><span id="write_receivers_file-346"><a href="#write_receivers_file-346"><span class="linenos">346</span></a><span class="sd">        ValueError: If too many receivers (&gt;10 million)</span>
</span><span id="write_receivers_file-347"><a href="#write_receivers_file-347"><span class="linenos">347</span></a>
</span><span id="write_receivers_file-348"><a href="#write_receivers_file-348"><span class="linenos">348</span></a><span class="sd">    Example:</span>
</span><span id="write_receivers_file-349"><a href="#write_receivers_file-349"><span class="linenos">349</span></a><span class="sd">        &gt;&gt;&gt; receivers = Receivers(positions=np.array([[120.0, -30.0]]))</span>
</span><span id="write_receivers_file-350"><a href="#write_receivers_file-350"><span class="linenos">350</span></a><span class="sd">        &gt;&gt;&gt; write_receivers_file(receivers, &#39;receivers.dat&#39;)</span>
</span><span id="write_receivers_file-351"><a href="#write_receivers_file-351"><span class="linenos">351</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="write_receivers_file-352"><a href="#write_receivers_file-352"><span class="linenos">352</span></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">struct</span>
</span><span id="write_receivers_file-353"><a href="#write_receivers_file-353"><span class="linenos">353</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="write_receivers_file-354"><a href="#write_receivers_file-354"><span class="linenos">354</span></a>
</span><span id="write_receivers_file-355"><a href="#write_receivers_file-355"><span class="linenos">355</span></a>    <span class="c1"># Security: Validate number of receivers</span>
</span><span id="write_receivers_file-356"><a href="#write_receivers_file-356"><span class="linenos">356</span></a>    <span class="n">MAX_RECEIVERS</span> <span class="o">=</span> <span class="mi">10_000_000</span>
</span><span id="write_receivers_file-357"><a href="#write_receivers_file-357"><span class="linenos">357</span></a>    <span class="k">if</span> <span class="n">receivers</span><span class="o">.</span><span class="n">n_receivers</span> <span class="o">&gt;</span> <span class="n">MAX_RECEIVERS</span><span class="p">:</span>
</span><span id="write_receivers_file-358"><a href="#write_receivers_file-358"><span class="linenos">358</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="write_receivers_file-359"><a href="#write_receivers_file-359"><span class="linenos">359</span></a>            <span class="sa">f</span><span class="s2">&quot;Too many receivers: </span><span class="si">{</span><span class="n">receivers</span><span class="o">.</span><span class="n">n_receivers</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> (max </span><span class="si">{</span><span class="n">MAX_RECEIVERS</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="write_receivers_file-360"><a href="#write_receivers_file-360"><span class="linenos">360</span></a>        <span class="p">)</span>
</span><span id="write_receivers_file-361"><a href="#write_receivers_file-361"><span class="linenos">361</span></a>
</span><span id="write_receivers_file-362"><a href="#write_receivers_file-362"><span class="linenos">362</span></a>    <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
</span><span id="write_receivers_file-363"><a href="#write_receivers_file-363"><span class="linenos">363</span></a>
</span><span id="write_receivers_file-364"><a href="#write_receivers_file-364"><span class="linenos">364</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="write_receivers_file-365"><a href="#write_receivers_file-365"><span class="linenos">365</span></a>        <span class="c1"># Write number of receivers as integer (4 bytes)</span>
</span><span id="write_receivers_file-366"><a href="#write_receivers_file-366"><span class="linenos">366</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">receivers</span><span class="o">.</span><span class="n">n_receivers</span><span class="p">))</span>
</span><span id="write_receivers_file-367"><a href="#write_receivers_file-367"><span class="linenos">367</span></a>
</span><span id="write_receivers_file-368"><a href="#write_receivers_file-368"><span class="linenos">368</span></a>        <span class="c1"># Write positions as doubles (8 bytes each)</span>
</span><span id="write_receivers_file-369"><a href="#write_receivers_file-369"><span class="linenos">369</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">receivers</span><span class="o">.</span><span class="n">n_receivers</span><span class="p">):</span>
</span><span id="write_receivers_file-370"><a href="#write_receivers_file-370"><span class="linenos">370</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">receivers</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>  <span class="c1"># x/lon</span>
</span><span id="write_receivers_file-371"><a href="#write_receivers_file-371"><span class="linenos">371</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">receivers</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>  <span class="c1"># y/lat</span>
</span></pre></div>


            <div class="docstring"><p>Write receivers to binary file compatible with SWMP.</p>

<p>Args:
    receivers: Receivers object
    filename: Output filename</p>

<p>Raises:
    ValueError: If too many receivers (&gt;10 million)</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>receivers = Receivers(positions=np.array([[120.0, -30.0]]))
      write_receivers_file(receivers, 'receivers.dat')</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="write_config_file">
                            <input id="write_config_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_config_file</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">filename</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">velocity_file</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">sources_file</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">receivers_file</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">output_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;output&#39;</span>,</span><span class="param">	<span class="n">options</span><span class="p">:</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;TrackerOptions&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="write_config_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#write_config_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="write_config_file-467"><a href="#write_config_file-467"><span class="linenos">467</span></a><span class="k">def</span><span class="w"> </span><span class="nf">write_config_file</span><span class="p">(</span>
</span><span id="write_config_file-468"><a href="#write_config_file-468"><span class="linenos">468</span></a>    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="write_config_file-469"><a href="#write_config_file-469"><span class="linenos">469</span></a>    <span class="n">velocity_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="write_config_file-470"><a href="#write_config_file-470"><span class="linenos">470</span></a>    <span class="n">sources_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="write_config_file-471"><a href="#write_config_file-471"><span class="linenos">471</span></a>    <span class="n">receivers_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="write_config_file-472"><a href="#write_config_file-472"><span class="linenos">472</span></a>    <span class="n">output_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;output&quot;</span><span class="p">,</span>
</span><span id="write_config_file-473"><a href="#write_config_file-473"><span class="linenos">473</span></a>    <span class="n">options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;TrackerOptions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="write_config_file-474"><a href="#write_config_file-474"><span class="linenos">474</span></a><span class="p">):</span>
</span><span id="write_config_file-475"><a href="#write_config_file-475"><span class="linenos">475</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a RAT configuration file.</span>
</span><span id="write_config_file-476"><a href="#write_config_file-476"><span class="linenos">476</span></a>
</span><span id="write_config_file-477"><a href="#write_config_file-477"><span class="linenos">477</span></a><span class="sd">    Args:</span>
</span><span id="write_config_file-478"><a href="#write_config_file-478"><span class="linenos">478</span></a><span class="sd">        filename: Output configuration filename</span>
</span><span id="write_config_file-479"><a href="#write_config_file-479"><span class="linenos">479</span></a><span class="sd">        velocity_file: Path to velocity model file</span>
</span><span id="write_config_file-480"><a href="#write_config_file-480"><span class="linenos">480</span></a><span class="sd">        sources_file: Path to sources file</span>
</span><span id="write_config_file-481"><a href="#write_config_file-481"><span class="linenos">481</span></a><span class="sd">        receivers_file: Path to receivers file</span>
</span><span id="write_config_file-482"><a href="#write_config_file-482"><span class="linenos">482</span></a><span class="sd">        output_dir: Directory for output files</span>
</span><span id="write_config_file-483"><a href="#write_config_file-483"><span class="linenos">483</span></a><span class="sd">        options: Optional TrackerOptions (uses defaults if None)</span>
</span><span id="write_config_file-484"><a href="#write_config_file-484"><span class="linenos">484</span></a>
</span><span id="write_config_file-485"><a href="#write_config_file-485"><span class="linenos">485</span></a><span class="sd">    Example:</span>
</span><span id="write_config_file-486"><a href="#write_config_file-486"><span class="linenos">486</span></a><span class="sd">        &gt;&gt;&gt; write_config_file(</span>
</span><span id="write_config_file-487"><a href="#write_config_file-487"><span class="linenos">487</span></a><span class="sd">        ...     &#39;config.in&#39;,</span>
</span><span id="write_config_file-488"><a href="#write_config_file-488"><span class="linenos">488</span></a><span class="sd">        ...     velocity_file=&#39;model.vel&#39;,</span>
</span><span id="write_config_file-489"><a href="#write_config_file-489"><span class="linenos">489</span></a><span class="sd">        ...     sources_file=&#39;sources.dat&#39;,</span>
</span><span id="write_config_file-490"><a href="#write_config_file-490"><span class="linenos">490</span></a><span class="sd">        ...     receivers_file=&#39;receivers.dat&#39;</span>
</span><span id="write_config_file-491"><a href="#write_config_file-491"><span class="linenos">491</span></a><span class="sd">        ... )</span>
</span><span id="write_config_file-492"><a href="#write_config_file-492"><span class="linenos">492</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="write_config_file-493"><a href="#write_config_file-493"><span class="linenos">493</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrackerOptions</span>
</span><span id="write_config_file-494"><a href="#write_config_file-494"><span class="linenos">494</span></a>
</span><span id="write_config_file-495"><a href="#write_config_file-495"><span class="linenos">495</span></a>    <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="write_config_file-496"><a href="#write_config_file-496"><span class="linenos">496</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">TrackerOptions</span><span class="p">()</span>
</span><span id="write_config_file-497"><a href="#write_config_file-497"><span class="linenos">497</span></a>
</span><span id="write_config_file-498"><a href="#write_config_file-498"><span class="linenos">498</span></a>    <span class="c1"># Create output directory if it doesn&#39;t exist</span>
</span><span id="write_config_file-499"><a href="#write_config_file-499"><span class="linenos">499</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="write_config_file-500"><a href="#write_config_file-500"><span class="linenos">500</span></a>    <span class="n">Path</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="write_config_file-501"><a href="#write_config_file-501"><span class="linenos">501</span></a>
</span><span id="write_config_file-502"><a href="#write_config_file-502"><span class="linenos">502</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="write_config_file-503"><a href="#write_config_file-503"><span class="linenos">503</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;!-------------------------------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-504"><a href="#write_config_file-504"><span class="linenos">504</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;! input files</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-505"><a href="#write_config_file-505"><span class="linenos">505</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;!-------------------------------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-506"><a href="#write_config_file-506"><span class="linenos">506</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">velocity_file</span><span class="si">}</span><span class="s2">  ! velocity model</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-507"><a href="#write_config_file-507"><span class="linenos">507</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sources_file</span><span class="si">}</span><span class="s2">  ! sources</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-508"><a href="#write_config_file-508"><span class="linenos">508</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">receivers_file</span><span class="si">}</span><span class="s2">  ! receivers</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-509"><a href="#write_config_file-509"><span class="linenos">509</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;!-------------------------------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-510"><a href="#write_config_file-510"><span class="linenos">510</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;! ray tracing parameters</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-511"><a href="#write_config_file-511"><span class="linenos">511</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;!-------------------------------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-512"><a href="#write_config_file-512"><span class="linenos">512</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">dt</span><span class="si">}</span><span class="s2">  ! ode solver time step size</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-513"><a href="#write_config_file-513"><span class="linenos">513</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">max_iterations</span><span class="si">}</span><span class="s2">  ! maximum number of iterations</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-514"><a href="#write_config_file-514"><span class="linenos">514</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">n_bichar_nodes</span><span class="si">}</span><span class="s2">  ! number of nodes on the bicharacteristic strip</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-515"><a href="#write_config_file-515"><span class="linenos">515</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">computation_mode</span><span class="si">}</span><span class="s2">  ! kinematic (1) kinematic and spreading (2)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-516"><a href="#write_config_file-516"><span class="linenos">516</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">ode_solver</span><span class="si">}</span><span class="s2">  ! 4th ordRK (1) 5th ord RK (2) 5th ord adaptive RK (3)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-517"><a href="#write_config_file-517"><span class="linenos">517</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">interpolator</span><span class="si">}</span><span class="s2">  ! interpolator (1) linear) (2) weighted average</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-518"><a href="#write_config_file-518"><span class="linenos">518</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">max_arrivals</span><span class="si">}</span><span class="s2">  ! maximum number of arrivals for a receiver</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-519"><a href="#write_config_file-519"><span class="linenos">519</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">coordinate_system</span><span class="si">}</span><span class="s2">  ! (1) Cartesian cubic b splines (2) Spherical splines</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-520"><a href="#write_config_file-520"><span class="linenos">520</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">earth_radius</span><span class="si">}</span><span class="s2">  ! radius of the earth</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-521"><a href="#write_config_file-521"><span class="linenos">521</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="n">source_specific_receivers</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">  ! source specific receiver configuration no/yes 0/1</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-522"><a href="#write_config_file-522"><span class="linenos">522</span></a>
</span><span id="write_config_file-523"><a href="#write_config_file-523"><span class="linenos">523</span></a>        <span class="c1"># For now, we&#39;ll skip the receiver mode file if source_specific_receivers is False</span>
</span><span id="write_config_file-524"><a href="#write_config_file-524"><span class="linenos">524</span></a>        <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">source_specific_receivers</span> <span class="ow">and</span> <span class="n">options</span><span class="o">.</span><span class="n">receiver_mode_file</span><span class="p">:</span>
</span><span id="write_config_file-525"><a href="#write_config_file-525"><span class="linenos">525</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">receiver_mode_file</span><span class="si">}</span><span class="s2">  ! receiver configuration</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-526"><a href="#write_config_file-526"><span class="linenos">526</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="write_config_file-527"><a href="#write_config_file-527"><span class="linenos">527</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;recmode.dat  ! receiver configuration (not used)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-528"><a href="#write_config_file-528"><span class="linenos">528</span></a>
</span><span id="write_config_file-529"><a href="#write_config_file-529"><span class="linenos">529</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;!-------------------------------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-530"><a href="#write_config_file-530"><span class="linenos">530</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;! output</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-531"><a href="#write_config_file-531"><span class="linenos">531</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;!-------------------------------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-532"><a href="#write_config_file-532"><span class="linenos">532</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">wavefront_interval</span><span class="si">}</span><span class="s2">  ! store every n-th wavefront</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-533"><a href="#write_config_file-533"><span class="linenos">533</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="n">extract_raypaths</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">  ! ray path extraction no/yes 0/1</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-534"><a href="#write_config_file-534"><span class="linenos">534</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">options</span><span class="o">.</span><span class="n">raypath_storage</span><span class="si">}</span><span class="s2">  ! ray storage (0) no (1) one file (2) sorted by arrival (3) both</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-535"><a href="#write_config_file-535"><span class="linenos">535</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="n">extract_frechet</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">  ! frechet derivatives no/yes 0/1</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-536"><a href="#write_config_file-536"><span class="linenos">536</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;!-------------------------------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-537"><a href="#write_config_file-537"><span class="linenos">537</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;! output files</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-538"><a href="#write_config_file-538"><span class="linenos">538</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;!-------------------------------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-539"><a href="#write_config_file-539"><span class="linenos">539</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s2">/arrivals.dat  ! arrival time</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-540"><a href="#write_config_file-540"><span class="linenos">540</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s2">/wafpos.dat  ! wavefront positions</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-541"><a href="#write_config_file-541"><span class="linenos">541</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s2">/raypaths.dat  ! raypaths</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-542"><a href="#write_config_file-542"><span class="linenos">542</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s2">/frechet.hdr  ! frechet header</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-543"><a href="#write_config_file-543"><span class="linenos">543</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s2">/frechet.mat  ! frechet matrix</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-544"><a href="#write_config_file-544"><span class="linenos">544</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s2">/frechet.rai  ! frechet ray index</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_config_file-545"><a href="#write_config_file-545"><span class="linenos">545</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s2">/rat.sum  ! rat info file</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Write a RAT configuration file.</p>

<p>Args:
    filename: Output configuration filename
    velocity_file: Path to velocity model file
    sources_file: Path to sources file
    receivers_file: Path to receivers file
    output_dir: Directory for output files
    options: Optional TrackerOptions (uses defaults if None)</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>write_config_file(
          ...     'config.in',
          ...     velocity_file='model.vel',
          ...     sources_file='sources.dat',
          ...     receivers_file='receivers.dat'
          ... )</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="VelocityModel">
                            <input id="VelocityModel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">VelocityModel</span>:

                <label class="view-source-button" for="VelocityModel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModel-48"><a href="#VelocityModel-48"><span class="linenos">48</span></a><span class="k">class</span><span class="w"> </span><span class="nc">VelocityModel</span><span class="p">():</span>
</span><span id="VelocityModel-49"><a href="#VelocityModel-49"><span class="linenos">49</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VelocityModel-50"><a href="#VelocityModel-50"><span class="linenos">50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="o">=</span><span class="kc">None</span>
</span><span id="VelocityModel-51"><a href="#VelocityModel-51"><span class="linenos">51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y0</span><span class="o">=</span><span class="kc">None</span>
</span><span id="VelocityModel-52"><a href="#VelocityModel-52"><span class="linenos">52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">=</span><span class="kc">None</span>
</span><span id="VelocityModel-53"><a href="#VelocityModel-53"><span class="linenos">53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="o">=</span><span class="kc">None</span>
</span><span id="VelocityModel-54"><a href="#VelocityModel-54"><span class="linenos">54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="o">=</span><span class="kc">None</span>
</span><span id="VelocityModel-55"><a href="#VelocityModel-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="o">=</span><span class="kc">None</span>
</span><span id="VelocityModel-56"><a href="#VelocityModel-56"><span class="linenos">56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cn</span><span class="o">=</span><span class="kc">None</span>
</span><span id="VelocityModel-57"><a href="#VelocityModel-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span>
</span><span id="VelocityModel-58"><a href="#VelocityModel-58"><span class="linenos">58</span></a>
</span><span id="VelocityModel-59"><a href="#VelocityModel-59"><span class="linenos">59</span></a>
</span><span id="VelocityModel-60"><a href="#VelocityModel-60"><span class="linenos">60</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fn</span><span class="p">):</span>
</span><span id="VelocityModel-61"><a href="#VelocityModel-61"><span class="linenos">61</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            <div id="VelocityModel.x0" class="classattr">
                                <div class="attr variable">
            <span class="name">x0</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel.x0"></a>
    
    

                            </div>
                            <div id="VelocityModel.y0" class="classattr">
                                <div class="attr variable">
            <span class="name">y0</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel.y0"></a>
    
    

                            </div>
                            <div id="VelocityModel.nx" class="classattr">
                                <div class="attr variable">
            <span class="name">nx</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel.nx"></a>
    
    

                            </div>
                            <div id="VelocityModel.ny" class="classattr">
                                <div class="attr variable">
            <span class="name">ny</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel.ny"></a>
    
    

                            </div>
                            <div id="VelocityModel.dx" class="classattr">
                                <div class="attr variable">
            <span class="name">dx</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel.dx"></a>
    
    

                            </div>
                            <div id="VelocityModel.dy" class="classattr">
                                <div class="attr variable">
            <span class="name">dy</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel.dy"></a>
    
    

                            </div>
                            <div id="VelocityModel.cn" class="classattr">
                                <div class="attr variable">
            <span class="name">cn</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel.cn"></a>
    
    

                            </div>
                            <div id="VelocityModel.m" class="classattr">
                                <div class="attr variable">
            <span class="name">m</span>

        
    </div>
    <a class="headerlink" href="#VelocityModel.m"></a>
    
    

                            </div>
                            <div id="VelocityModel.read" class="classattr">
                                        <input id="VelocityModel.read-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">fn</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="VelocityModel.read-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModel.read"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModel.read-60"><a href="#VelocityModel.read-60"><span class="linenos">60</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fn</span><span class="p">):</span>
</span><span id="VelocityModel.read-61"><a href="#VelocityModel.read-61"><span class="linenos">61</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="TravelTimeData">
                            <input id="TravelTimeData-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TravelTimeData</span>:

                <label class="view-source-button" for="TravelTimeData-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TravelTimeData"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TravelTimeData-63"><a href="#TravelTimeData-63"><span class="linenos">63</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TravelTimeData</span><span class="p">():</span>
</span><span id="TravelTimeData-64"><a href="#TravelTimeData-64"><span class="linenos">64</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TravelTimeData-65"><a href="#TravelTimeData-65"><span class="linenos">65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">=</span><span class="kc">None</span>
</span><span id="TravelTimeData-66"><a href="#TravelTimeData-66"><span class="linenos">66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pred</span><span class="o">=</span><span class="kc">None</span>
</span><span id="TravelTimeData-67"><a href="#TravelTimeData-67"><span class="linenos">67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">joined</span><span class="o">=</span><span class="kc">None</span>
</span><span id="TravelTimeData-68"><a href="#TravelTimeData-68"><span class="linenos">68</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            <div id="TravelTimeData.obs" class="classattr">
                                <div class="attr variable">
            <span class="name">obs</span>

        
    </div>
    <a class="headerlink" href="#TravelTimeData.obs"></a>
    
    

                            </div>
                            <div id="TravelTimeData.pred" class="classattr">
                                <div class="attr variable">
            <span class="name">pred</span>

        
    </div>
    <a class="headerlink" href="#TravelTimeData.pred"></a>
    
    

                            </div>
                            <div id="TravelTimeData.joined" class="classattr">
                                <div class="attr variable">
            <span class="name">joined</span>

        
    </div>
    <a class="headerlink" href="#TravelTimeData.joined"></a>
    
    

                            </div>
                </section>
                <section id="VelocityModelGenerator">
                            <input id="VelocityModelGenerator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">VelocityModelGenerator</span>:

                <label class="view-source-button" for="VelocityModelGenerator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModelGenerator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModelGenerator-334"><a href="#VelocityModelGenerator-334"><span class="linenos">334</span></a><span class="k">class</span><span class="w"> </span><span class="nc">VelocityModelGenerator</span><span class="p">():</span>
</span><span id="VelocityModelGenerator-335"><a href="#VelocityModelGenerator-335"><span class="linenos">335</span></a>
</span><span id="VelocityModelGenerator-336"><a href="#VelocityModelGenerator-336"><span class="linenos">336</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VelocityModelGenerator-337"><a href="#VelocityModelGenerator-337"><span class="linenos">337</span></a>        <span class="k">if</span> <span class="s1">&#39;mac&#39;</span> <span class="ow">in</span> <span class="n">platform</span><span class="o">.</span><span class="n">platform</span><span class="p">():</span>
</span><span id="VelocityModelGenerator-338"><a href="#VelocityModelGenerator-338"><span class="linenos">338</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">cdll</span><span class="o">.</span><span class="n">LoadLibrary</span><span class="p">(</span><span class="s2">&quot;../../modules/libswmp.dylib&quot;</span><span class="p">)</span>
</span><span id="VelocityModelGenerator-339"><a href="#VelocityModelGenerator-339"><span class="linenos">339</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VelocityModelGenerator-340"><a href="#VelocityModelGenerator-340"><span class="linenos">340</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">cdll</span><span class="o">.</span><span class="n">LoadLibrary</span><span class="p">(</span><span class="s2">&quot;../../modules/libswmp.so&quot;</span><span class="p">)</span>
</span><span id="VelocityModelGenerator-341"><a href="#VelocityModelGenerator-341"><span class="linenos">341</span></a>        <span class="k">pass</span>
</span><span id="VelocityModelGenerator-342"><a href="#VelocityModelGenerator-342"><span class="linenos">342</span></a>
</span><span id="VelocityModelGenerator-343"><a href="#VelocityModelGenerator-343"><span class="linenos">343</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fn_</span><span class="p">):</span>
</span><span id="VelocityModelGenerator-344"><a href="#VelocityModelGenerator-344"><span class="linenos">344</span></a>        <span class="n">fn</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">(</span><span class="n">fn_</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
</span><span id="VelocityModelGenerator-345"><a href="#VelocityModelGenerator-345"><span class="linenos">345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">gen2dv_read_conf</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="VelocityModelGenerator-346"><a href="#VelocityModelGenerator-346"><span class="linenos">346</span></a>
</span><span id="VelocityModelGenerator-347"><a href="#VelocityModelGenerator-347"><span class="linenos">347</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VelocityModelGenerator-348"><a href="#VelocityModelGenerator-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">gen2dv_run</span><span class="p">()</span>
</span></pre></div>


    

                            <div id="VelocityModelGenerator.read_configuration" class="classattr">
                                        <input id="VelocityModelGenerator.read_configuration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_configuration</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">fn_</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="VelocityModelGenerator.read_configuration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModelGenerator.read_configuration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModelGenerator.read_configuration-343"><a href="#VelocityModelGenerator.read_configuration-343"><span class="linenos">343</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fn_</span><span class="p">):</span>
</span><span id="VelocityModelGenerator.read_configuration-344"><a href="#VelocityModelGenerator.read_configuration-344"><span class="linenos">344</span></a>        <span class="n">fn</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">(</span><span class="n">fn_</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
</span><span id="VelocityModelGenerator.read_configuration-345"><a href="#VelocityModelGenerator.read_configuration-345"><span class="linenos">345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">gen2dv_read_conf</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span></pre></div>


    

                            </div>
                            <div id="VelocityModelGenerator.run" class="classattr">
                                        <input id="VelocityModelGenerator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="VelocityModelGenerator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VelocityModelGenerator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VelocityModelGenerator.run-347"><a href="#VelocityModelGenerator.run-347"><span class="linenos">347</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VelocityModelGenerator.run-348"><a href="#VelocityModelGenerator.run-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">gen2dv_run</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="ObservationGenerator">
                            <input id="ObservationGenerator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ObservationGenerator</span>:

                <label class="view-source-button" for="ObservationGenerator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ObservationGenerator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ObservationGenerator-351"><a href="#ObservationGenerator-351"><span class="linenos">351</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ObservationGenerator</span><span class="p">():</span>
</span><span id="ObservationGenerator-352"><a href="#ObservationGenerator-352"><span class="linenos">352</span></a>
</span><span id="ObservationGenerator-353"><a href="#ObservationGenerator-353"><span class="linenos">353</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ObservationGenerator-354"><a href="#ObservationGenerator-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="s1">&#39;mac&#39;</span> <span class="ow">in</span> <span class="n">platform</span><span class="o">.</span><span class="n">platform</span><span class="p">():</span>
</span><span id="ObservationGenerator-355"><a href="#ObservationGenerator-355"><span class="linenos">355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">cdll</span><span class="o">.</span><span class="n">LoadLibrary</span><span class="p">(</span><span class="s2">&quot;../../modules/libswmp.dylib&quot;</span><span class="p">)</span>
</span><span id="ObservationGenerator-356"><a href="#ObservationGenerator-356"><span class="linenos">356</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ObservationGenerator-357"><a href="#ObservationGenerator-357"><span class="linenos">357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">cdll</span><span class="o">.</span><span class="n">LoadLibrary</span><span class="p">(</span><span class="s2">&quot;../../modules/libswmp.so&quot;</span><span class="p">)</span>
</span><span id="ObservationGenerator-358"><a href="#ObservationGenerator-358"><span class="linenos">358</span></a>        <span class="k">pass</span>
</span><span id="ObservationGenerator-359"><a href="#ObservationGenerator-359"><span class="linenos">359</span></a>
</span><span id="ObservationGenerator-360"><a href="#ObservationGenerator-360"><span class="linenos">360</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fn_</span><span class="p">):</span>
</span><span id="ObservationGenerator-361"><a href="#ObservationGenerator-361"><span class="linenos">361</span></a>        <span class="n">fn</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">(</span><span class="n">fn_</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
</span><span id="ObservationGenerator-362"><a href="#ObservationGenerator-362"><span class="linenos">362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">creobs_read_conf</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="ObservationGenerator-363"><a href="#ObservationGenerator-363"><span class="linenos">363</span></a>
</span><span id="ObservationGenerator-364"><a href="#ObservationGenerator-364"><span class="linenos">364</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ObservationGenerator-365"><a href="#ObservationGenerator-365"><span class="linenos">365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">creobs_run</span><span class="p">()</span>
</span></pre></div>


    

                            <div id="ObservationGenerator.read_configuration" class="classattr">
                                        <input id="ObservationGenerator.read_configuration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_configuration</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">fn_</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ObservationGenerator.read_configuration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ObservationGenerator.read_configuration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ObservationGenerator.read_configuration-360"><a href="#ObservationGenerator.read_configuration-360"><span class="linenos">360</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fn_</span><span class="p">):</span>
</span><span id="ObservationGenerator.read_configuration-361"><a href="#ObservationGenerator.read_configuration-361"><span class="linenos">361</span></a>        <span class="n">fn</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">(</span><span class="n">fn_</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
</span><span id="ObservationGenerator.read_configuration-362"><a href="#ObservationGenerator.read_configuration-362"><span class="linenos">362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">creobs_read_conf</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span></pre></div>


    

                            </div>
                            <div id="ObservationGenerator.run" class="classattr">
                                        <input id="ObservationGenerator.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ObservationGenerator.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ObservationGenerator.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ObservationGenerator.run-364"><a href="#ObservationGenerator.run-364"><span class="linenos">364</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ObservationGenerator.run-365"><a href="#ObservationGenerator.run-365"><span class="linenos">365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">creobs_run</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="Visualisation">
                            <input id="Visualisation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Visualisation</span><wbr>(<span class="base">pyswmp._pyswmp.WaveFrontTracker</span>):

                <label class="view-source-button" for="Visualisation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Visualisation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Visualisation-368"><a href="#Visualisation-368"><span class="linenos">368</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Visualisation</span><span class="p">(</span><span class="n">WaveFrontTracker</span><span class="p">):</span>
</span><span id="Visualisation-369"><a href="#Visualisation-369"><span class="linenos">369</span></a>
</span><span id="Visualisation-370"><a href="#Visualisation-370"><span class="linenos">370</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Visualisation-371"><a href="#Visualisation-371"><span class="linenos">371</span></a>        <span class="n">WaveFrontTracker</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Visualisation-372"><a href="#Visualisation-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rp</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation-373"><a href="#Visualisation-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">wf</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation-374"><a href="#Visualisation-374"><span class="linenos">374</span></a>        <span class="k">pass</span>
</span><span id="Visualisation-375"><a href="#Visualisation-375"><span class="linenos">375</span></a>
</span><span id="Visualisation-376"><a href="#Visualisation-376"><span class="linenos">376</span></a>
</span><span id="Visualisation-377"><a href="#Visualisation-377"><span class="linenos">377</span></a>
</span><span id="Visualisation-378"><a href="#Visualisation-378"><span class="linenos">378</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_raypaths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Visualisation-379"><a href="#Visualisation-379"><span class="linenos">379</span></a>        <span class="n">fn</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">((</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
</span><span id="Visualisation-380"><a href="#Visualisation-380"><span class="linenos">380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">get_raypath_prediction_filepath</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="Visualisation-381"><a href="#Visualisation-381"><span class="linenos">381</span></a>        <span class="n">fp</span><span class="o">=</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
</span><span id="Visualisation-382"><a href="#Visualisation-382"><span class="linenos">382</span></a>        <span class="n">fpb</span><span class="o">=</span><span class="n">fp</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Visualisation-383"><a href="#Visualisation-383"><span class="linenos">383</span></a>        <span class="n">fps</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">fpb</span><span class="o">+</span><span class="s1">&#39;*.&#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Visualisation-384"><a href="#Visualisation-384"><span class="linenos">384</span></a>
</span><span id="Visualisation-385"><a href="#Visualisation-385"><span class="linenos">385</span></a>        <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">fps</span><span class="p">:</span>
</span><span id="Visualisation-386"><a href="#Visualisation-386"><span class="linenos">386</span></a>            <span class="n">fh</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="Visualisation-387"><a href="#Visualisation-387"><span class="linenos">387</span></a>            <span class="n">lines</span><span class="o">=</span><span class="n">fh</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="Visualisation-388"><a href="#Visualisation-388"><span class="linenos">388</span></a>            <span class="n">rp</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation-389"><a href="#Visualisation-389"><span class="linenos">389</span></a>            <span class="n">irp</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation-390"><a href="#Visualisation-390"><span class="linenos">390</span></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="Visualisation-391"><a href="#Visualisation-391"><span class="linenos">391</span></a>                <span class="n">fields</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="Visualisation-392"><a href="#Visualisation-392"><span class="linenos">392</span></a>                <span class="k">if</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">irp</span><span class="o">!=</span><span class="p">[]:</span>
</span><span id="Visualisation-393"><a href="#Visualisation-393"><span class="linenos">393</span></a>                    <span class="n">irp</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">irp</span><span class="p">)</span>
</span><span id="Visualisation-394"><a href="#Visualisation-394"><span class="linenos">394</span></a>                    <span class="n">rp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irp</span><span class="p">)</span>
</span><span id="Visualisation-395"><a href="#Visualisation-395"><span class="linenos">395</span></a>                    <span class="n">irp</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation-396"><a href="#Visualisation-396"><span class="linenos">396</span></a>                <span class="k">elif</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>
</span><span id="Visualisation-397"><a href="#Visualisation-397"><span class="linenos">397</span></a>                    <span class="n">irp</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
</span><span id="Visualisation-398"><a href="#Visualisation-398"><span class="linenos">398</span></a>            <span class="k">if</span> <span class="n">irp</span><span class="o">!=</span><span class="p">[]:</span>
</span><span id="Visualisation-399"><a href="#Visualisation-399"><span class="linenos">399</span></a>                <span class="n">irp</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">irp</span><span class="p">)</span>
</span><span id="Visualisation-400"><a href="#Visualisation-400"><span class="linenos">400</span></a>                <span class="n">rp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irp</span><span class="p">)</span>
</span><span id="Visualisation-401"><a href="#Visualisation-401"><span class="linenos">401</span></a>
</span><span id="Visualisation-402"><a href="#Visualisation-402"><span class="linenos">402</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span>
</span><span id="Visualisation-403"><a href="#Visualisation-403"><span class="linenos">403</span></a>
</span><span id="Visualisation-404"><a href="#Visualisation-404"><span class="linenos">404</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_wavefronts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Visualisation-405"><a href="#Visualisation-405"><span class="linenos">405</span></a>        <span class="n">fn</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">((</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
</span><span id="Visualisation-406"><a href="#Visualisation-406"><span class="linenos">406</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">get_wavefront_prediction_filepath</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="Visualisation-407"><a href="#Visualisation-407"><span class="linenos">407</span></a>        <span class="n">fp</span><span class="o">=</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
</span><span id="Visualisation-408"><a href="#Visualisation-408"><span class="linenos">408</span></a>        <span class="n">fh</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="Visualisation-409"><a href="#Visualisation-409"><span class="linenos">409</span></a>        <span class="n">lines</span><span class="o">=</span><span class="n">fh</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="Visualisation-410"><a href="#Visualisation-410"><span class="linenos">410</span></a>        <span class="n">wf</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation-411"><a href="#Visualisation-411"><span class="linenos">411</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="Visualisation-412"><a href="#Visualisation-412"><span class="linenos">412</span></a>            <span class="n">fields</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="Visualisation-413"><a href="#Visualisation-413"><span class="linenos">413</span></a>            <span class="k">if</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">wf</span><span class="o">!=</span><span class="p">[]:</span>
</span><span id="Visualisation-414"><a href="#Visualisation-414"><span class="linenos">414</span></a>                <span class="n">wf</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
</span><span id="Visualisation-415"><a href="#Visualisation-415"><span class="linenos">415</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">wf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
</span><span id="Visualisation-416"><a href="#Visualisation-416"><span class="linenos">416</span></a>                <span class="n">wf</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation-417"><a href="#Visualisation-417"><span class="linenos">417</span></a>            <span class="k">elif</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>
</span><span id="Visualisation-418"><a href="#Visualisation-418"><span class="linenos">418</span></a>                <span class="n">wf</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
</span><span id="Visualisation-419"><a href="#Visualisation-419"><span class="linenos">419</span></a>        <span class="k">if</span>  <span class="n">wf</span><span class="o">!=</span><span class="p">[]:</span>
</span><span id="Visualisation-420"><a href="#Visualisation-420"><span class="linenos">420</span></a>            <span class="n">wf</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
</span><span id="Visualisation-421"><a href="#Visualisation-421"><span class="linenos">421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">wf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
</span><span id="Visualisation-422"><a href="#Visualisation-422"><span class="linenos">422</span></a>
</span><span id="Visualisation-423"><a href="#Visualisation-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_model_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nrx_</span><span class="p">,</span><span class="n">nry_</span><span class="p">):</span>
</span><span id="Visualisation-424"><a href="#Visualisation-424"><span class="linenos">424</span></a>        <span class="n">nrx</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nrx_</span><span class="p">)</span>
</span><span id="Visualisation-425"><a href="#Visualisation-425"><span class="linenos">425</span></a>        <span class="n">nry</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nry_</span><span class="p">)</span>
</span><span id="Visualisation-426"><a href="#Visualisation-426"><span class="linenos">426</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">resample_model</span><span class="p">(</span><span class="n">nrx</span><span class="p">,</span><span class="n">nry</span><span class="p">)</span>
</span><span id="Visualisation-427"><a href="#Visualisation-427"><span class="linenos">427</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resampled_model_vector</span><span class="p">()</span>
</span><span id="Visualisation-428"><a href="#Visualisation-428"><span class="linenos">428</span></a>        <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">x0</span>
</span><span id="Visualisation-429"><a href="#Visualisation-429"><span class="linenos">429</span></a>        <span class="n">y0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">y0</span>
</span><span id="Visualisation-430"><a href="#Visualisation-430"><span class="linenos">430</span></a>        <span class="n">nx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation-431"><a href="#Visualisation-431"><span class="linenos">431</span></a>        <span class="n">ny</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation-432"><a href="#Visualisation-432"><span class="linenos">432</span></a>        <span class="n">x1</span><span class="o">=</span><span class="n">x0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation-433"><a href="#Visualisation-433"><span class="linenos">433</span></a>        <span class="n">y1</span><span class="o">=</span><span class="n">y0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dy</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation-434"><a href="#Visualisation-434"><span class="linenos">434</span></a>        <span class="n">xc</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation-435"><a href="#Visualisation-435"><span class="linenos">435</span></a>        <span class="n">yc</span><span class="o">=</span><span class="p">(</span><span class="n">y0</span><span class="o">+</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation-436"><a href="#Visualisation-436"><span class="linenos">436</span></a>
</span><span id="Visualisation-437"><a href="#Visualisation-437"><span class="linenos">437</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
</span><span id="Visualisation-438"><a href="#Visualisation-438"><span class="linenos">438</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
</span><span id="Visualisation-439"><a href="#Visualisation-439"><span class="linenos">439</span></a>
</span><span id="Visualisation-440"><a href="#Visualisation-440"><span class="linenos">440</span></a>        <span class="n">yy</span><span class="p">,</span> <span class="n">xx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Visualisation-441"><a href="#Visualisation-441"><span class="linenos">441</span></a>        <span class="n">zz</span> <span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">m</span><span class="p">,(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">))</span>
</span><span id="Visualisation-442"><a href="#Visualisation-442"><span class="linenos">442</span></a>        
</span><span id="Visualisation-443"><a href="#Visualisation-443"><span class="linenos">443</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Visualisation-444"><a href="#Visualisation-444"><span class="linenos">444</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">min_latitude</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">max_latitude</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span> <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude_true_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</span><span id="Visualisation-445"><a href="#Visualisation-445"><span class="linenos">445</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation-446"><a href="#Visualisation-446"><span class="linenos">446</span></a>        
</span><span id="Visualisation-447"><a href="#Visualisation-447"><span class="linenos">447</span></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">]</span>
</span><span id="Visualisation-448"><a href="#Visualisation-448"><span class="linenos">448</span></a>        <span class="n">cm</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation-449"><a href="#Visualisation-449"><span class="linenos">449</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="Visualisation-450"><a href="#Visualisation-450"><span class="linenos">450</span></a>
</span><span id="Visualisation-451"><a href="#Visualisation-451"><span class="linenos">451</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="Visualisation-452"><a href="#Visualisation-452"><span class="linenos">452</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</span><span id="Visualisation-453"><a href="#Visualisation-453"><span class="linenos">453</span></a>
</span><span id="Visualisation-454"><a href="#Visualisation-454"><span class="linenos">454</span></a>        <span class="k">return</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="Visualisation-455"><a href="#Visualisation-455"><span class="linenos">455</span></a>
</span><span id="Visualisation-456"><a href="#Visualisation-456"><span class="linenos">456</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_raypath_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nrx_</span><span class="p">,</span><span class="n">nry_</span><span class="p">):</span>
</span><span id="Visualisation-457"><a href="#Visualisation-457"><span class="linenos">457</span></a>        <span class="n">nrx</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nrx_</span><span class="p">)</span>
</span><span id="Visualisation-458"><a href="#Visualisation-458"><span class="linenos">458</span></a>        <span class="n">nry</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nry_</span><span class="p">)</span>
</span><span id="Visualisation-459"><a href="#Visualisation-459"><span class="linenos">459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">resample_model</span><span class="p">(</span><span class="n">nrx</span><span class="p">,</span><span class="n">nry</span><span class="p">)</span>
</span><span id="Visualisation-460"><a href="#Visualisation-460"><span class="linenos">460</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resampled_model_vector</span><span class="p">()</span>
</span><span id="Visualisation-461"><a href="#Visualisation-461"><span class="linenos">461</span></a>        <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">x0</span>
</span><span id="Visualisation-462"><a href="#Visualisation-462"><span class="linenos">462</span></a>        <span class="n">y0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">y0</span>
</span><span id="Visualisation-463"><a href="#Visualisation-463"><span class="linenos">463</span></a>        <span class="n">nx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation-464"><a href="#Visualisation-464"><span class="linenos">464</span></a>        <span class="n">ny</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation-465"><a href="#Visualisation-465"><span class="linenos">465</span></a>        <span class="n">x1</span><span class="o">=</span><span class="n">x0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation-466"><a href="#Visualisation-466"><span class="linenos">466</span></a>        <span class="n">y1</span><span class="o">=</span><span class="n">y0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dy</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation-467"><a href="#Visualisation-467"><span class="linenos">467</span></a>        <span class="n">xc</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation-468"><a href="#Visualisation-468"><span class="linenos">468</span></a>        <span class="n">yc</span><span class="o">=</span><span class="p">(</span><span class="n">y0</span><span class="o">+</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation-469"><a href="#Visualisation-469"><span class="linenos">469</span></a>
</span><span id="Visualisation-470"><a href="#Visualisation-470"><span class="linenos">470</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
</span><span id="Visualisation-471"><a href="#Visualisation-471"><span class="linenos">471</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
</span><span id="Visualisation-472"><a href="#Visualisation-472"><span class="linenos">472</span></a>
</span><span id="Visualisation-473"><a href="#Visualisation-473"><span class="linenos">473</span></a>        <span class="n">yy</span><span class="p">,</span> <span class="n">xx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Visualisation-474"><a href="#Visualisation-474"><span class="linenos">474</span></a>        <span class="n">zz</span> <span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">m</span><span class="p">,(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">))</span>
</span><span id="Visualisation-475"><a href="#Visualisation-475"><span class="linenos">475</span></a>        
</span><span id="Visualisation-476"><a href="#Visualisation-476"><span class="linenos">476</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Visualisation-477"><a href="#Visualisation-477"><span class="linenos">477</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">min_latitude</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">max_latitude</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span> <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude_true_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</span><span id="Visualisation-478"><a href="#Visualisation-478"><span class="linenos">478</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation-479"><a href="#Visualisation-479"><span class="linenos">479</span></a>        
</span><span id="Visualisation-480"><a href="#Visualisation-480"><span class="linenos">480</span></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">]</span>
</span><span id="Visualisation-481"><a href="#Visualisation-481"><span class="linenos">481</span></a>        <span class="n">cm</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation-482"><a href="#Visualisation-482"><span class="linenos">482</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="Visualisation-483"><a href="#Visualisation-483"><span class="linenos">483</span></a>
</span><span id="Visualisation-484"><a href="#Visualisation-484"><span class="linenos">484</span></a>        <span class="c1"># http://tsitsul.in/blog/coloropt/</span>
</span><span id="Visualisation-485"><a href="#Visualisation-485"><span class="linenos">485</span></a>        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#ebac23&#39;</span><span class="p">,</span><span class="s1">&#39;#b80058&#39;</span><span class="p">,</span><span class="s1">&#39;#008cf9&#39;</span><span class="p">,</span><span class="s1">&#39;#006e00&#39;</span><span class="p">,</span><span class="s1">&#39;#00bbad&#39;</span><span class="p">,</span><span class="s1">&#39;#d163e6&#39;</span><span class="p">,</span><span class="s1">&#39;#b24502&#39;</span><span class="p">,</span><span class="s1">&#39;#ff9287&#39;</span><span class="p">,</span><span class="s1">&#39;#5954d6&#39;</span><span class="p">,</span><span class="s1">&#39;#00c6f8&#39;</span><span class="p">,</span><span class="s1">&#39;#878500&#39;</span><span class="p">,</span><span class="s1">&#39;#00a76c&#39;</span><span class="p">]</span>
</span><span id="Visualisation-486"><a href="#Visualisation-486"><span class="linenos">486</span></a>        <span class="n">ic</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Visualisation-487"><a href="#Visualisation-487"><span class="linenos">487</span></a>
</span><span id="Visualisation-488"><a href="#Visualisation-488"><span class="linenos">488</span></a>        <span class="k">for</span> <span class="n">rp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span>
</span><span id="Visualisation-489"><a href="#Visualisation-489"><span class="linenos">489</span></a>            <span class="k">for</span> <span class="n">irp</span> <span class="ow">in</span> <span class="n">rp</span><span class="p">:</span>
</span><span id="Visualisation-490"><a href="#Visualisation-490"><span class="linenos">490</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">irp</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">irp</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation-491"><a href="#Visualisation-491"><span class="linenos">491</span></a>            <span class="n">ic</span><span class="o">=</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span>
</span><span id="Visualisation-492"><a href="#Visualisation-492"><span class="linenos">492</span></a>
</span><span id="Visualisation-493"><a href="#Visualisation-493"><span class="linenos">493</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="Visualisation-494"><a href="#Visualisation-494"><span class="linenos">494</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</span><span id="Visualisation-495"><a href="#Visualisation-495"><span class="linenos">495</span></a>
</span><span id="Visualisation-496"><a href="#Visualisation-496"><span class="linenos">496</span></a>        <span class="k">return</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="Visualisation-497"><a href="#Visualisation-497"><span class="linenos">497</span></a>
</span><span id="Visualisation-498"><a href="#Visualisation-498"><span class="linenos">498</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_wavefront_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nrx_</span><span class="p">,</span><span class="n">nry_</span><span class="p">):</span>
</span><span id="Visualisation-499"><a href="#Visualisation-499"><span class="linenos">499</span></a>        <span class="n">nrx</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nrx_</span><span class="p">)</span>
</span><span id="Visualisation-500"><a href="#Visualisation-500"><span class="linenos">500</span></a>        <span class="n">nry</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nry_</span><span class="p">)</span>
</span><span id="Visualisation-501"><a href="#Visualisation-501"><span class="linenos">501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">resample_model</span><span class="p">(</span><span class="n">nrx</span><span class="p">,</span><span class="n">nry</span><span class="p">)</span>
</span><span id="Visualisation-502"><a href="#Visualisation-502"><span class="linenos">502</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resampled_model_vector</span><span class="p">()</span>
</span><span id="Visualisation-503"><a href="#Visualisation-503"><span class="linenos">503</span></a>        <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">x0</span>
</span><span id="Visualisation-504"><a href="#Visualisation-504"><span class="linenos">504</span></a>        <span class="n">y0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">y0</span>
</span><span id="Visualisation-505"><a href="#Visualisation-505"><span class="linenos">505</span></a>        <span class="n">nx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation-506"><a href="#Visualisation-506"><span class="linenos">506</span></a>        <span class="n">ny</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation-507"><a href="#Visualisation-507"><span class="linenos">507</span></a>        <span class="n">x1</span><span class="o">=</span><span class="n">x0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation-508"><a href="#Visualisation-508"><span class="linenos">508</span></a>        <span class="n">y1</span><span class="o">=</span><span class="n">y0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dy</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation-509"><a href="#Visualisation-509"><span class="linenos">509</span></a>        <span class="n">xc</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation-510"><a href="#Visualisation-510"><span class="linenos">510</span></a>        <span class="n">yc</span><span class="o">=</span><span class="p">(</span><span class="n">y0</span><span class="o">+</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation-511"><a href="#Visualisation-511"><span class="linenos">511</span></a>
</span><span id="Visualisation-512"><a href="#Visualisation-512"><span class="linenos">512</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
</span><span id="Visualisation-513"><a href="#Visualisation-513"><span class="linenos">513</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
</span><span id="Visualisation-514"><a href="#Visualisation-514"><span class="linenos">514</span></a>
</span><span id="Visualisation-515"><a href="#Visualisation-515"><span class="linenos">515</span></a>        <span class="n">yy</span><span class="p">,</span> <span class="n">xx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Visualisation-516"><a href="#Visualisation-516"><span class="linenos">516</span></a>        <span class="n">zz</span> <span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">m</span><span class="p">,(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">))</span>
</span><span id="Visualisation-517"><a href="#Visualisation-517"><span class="linenos">517</span></a>        
</span><span id="Visualisation-518"><a href="#Visualisation-518"><span class="linenos">518</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Visualisation-519"><a href="#Visualisation-519"><span class="linenos">519</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">min_latitude</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">max_latitude</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span> <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude_true_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</span><span id="Visualisation-520"><a href="#Visualisation-520"><span class="linenos">520</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation-521"><a href="#Visualisation-521"><span class="linenos">521</span></a>        
</span><span id="Visualisation-522"><a href="#Visualisation-522"><span class="linenos">522</span></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">]</span>
</span><span id="Visualisation-523"><a href="#Visualisation-523"><span class="linenos">523</span></a>        <span class="n">cm</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation-524"><a href="#Visualisation-524"><span class="linenos">524</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="Visualisation-525"><a href="#Visualisation-525"><span class="linenos">525</span></a>
</span><span id="Visualisation-526"><a href="#Visualisation-526"><span class="linenos">526</span></a>        <span class="c1"># http://tsitsul.in/blog/coloropt/</span>
</span><span id="Visualisation-527"><a href="#Visualisation-527"><span class="linenos">527</span></a>        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#ebac23&#39;</span><span class="p">,</span><span class="s1">&#39;#b80058&#39;</span><span class="p">,</span><span class="s1">&#39;#008cf9&#39;</span><span class="p">,</span><span class="s1">&#39;#006e00&#39;</span><span class="p">,</span><span class="s1">&#39;#00bbad&#39;</span><span class="p">,</span><span class="s1">&#39;#d163e6&#39;</span><span class="p">,</span><span class="s1">&#39;#b24502&#39;</span><span class="p">,</span><span class="s1">&#39;#ff9287&#39;</span><span class="p">,</span><span class="s1">&#39;#5954d6&#39;</span><span class="p">,</span><span class="s1">&#39;#00c6f8&#39;</span><span class="p">,</span><span class="s1">&#39;#878500&#39;</span><span class="p">,</span><span class="s1">&#39;#00a76c&#39;</span><span class="p">]</span>
</span><span id="Visualisation-528"><a href="#Visualisation-528"><span class="linenos">528</span></a>        <span class="n">ic</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Visualisation-529"><a href="#Visualisation-529"><span class="linenos">529</span></a>
</span><span id="Visualisation-530"><a href="#Visualisation-530"><span class="linenos">530</span></a>        <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wf</span><span class="p">:</span>
</span><span id="Visualisation-531"><a href="#Visualisation-531"><span class="linenos">531</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">wf</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation-532"><a href="#Visualisation-532"><span class="linenos">532</span></a>        <span class="k">for</span> <span class="n">rp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span>
</span><span id="Visualisation-533"><a href="#Visualisation-533"><span class="linenos">533</span></a>            <span class="k">for</span> <span class="n">irp</span> <span class="ow">in</span> <span class="n">rp</span><span class="p">:</span>
</span><span id="Visualisation-534"><a href="#Visualisation-534"><span class="linenos">534</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">irp</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">irp</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation-535"><a href="#Visualisation-535"><span class="linenos">535</span></a>            <span class="n">ic</span><span class="o">=</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span>
</span><span id="Visualisation-536"><a href="#Visualisation-536"><span class="linenos">536</span></a>
</span><span id="Visualisation-537"><a href="#Visualisation-537"><span class="linenos">537</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="Visualisation-538"><a href="#Visualisation-538"><span class="linenos">538</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</span><span id="Visualisation-539"><a href="#Visualisation-539"><span class="linenos">539</span></a>
</span><span id="Visualisation-540"><a href="#Visualisation-540"><span class="linenos">540</span></a>        <span class="k">return</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span></pre></div>


    

                            <div id="Visualisation.rp" class="classattr">
                                <div class="attr variable">
            <span class="name">rp</span>

        
    </div>
    <a class="headerlink" href="#Visualisation.rp"></a>
    
    

                            </div>
                            <div id="Visualisation.wf" class="classattr">
                                <div class="attr variable">
            <span class="name">wf</span>

        
    </div>
    <a class="headerlink" href="#Visualisation.wf"></a>
    
    

                            </div>
                            <div id="Visualisation.read_raypaths" class="classattr">
                                        <input id="Visualisation.read_raypaths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_raypaths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Visualisation.read_raypaths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Visualisation.read_raypaths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Visualisation.read_raypaths-378"><a href="#Visualisation.read_raypaths-378"><span class="linenos">378</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_raypaths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Visualisation.read_raypaths-379"><a href="#Visualisation.read_raypaths-379"><span class="linenos">379</span></a>        <span class="n">fn</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">((</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
</span><span id="Visualisation.read_raypaths-380"><a href="#Visualisation.read_raypaths-380"><span class="linenos">380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">get_raypath_prediction_filepath</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="Visualisation.read_raypaths-381"><a href="#Visualisation.read_raypaths-381"><span class="linenos">381</span></a>        <span class="n">fp</span><span class="o">=</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
</span><span id="Visualisation.read_raypaths-382"><a href="#Visualisation.read_raypaths-382"><span class="linenos">382</span></a>        <span class="n">fpb</span><span class="o">=</span><span class="n">fp</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Visualisation.read_raypaths-383"><a href="#Visualisation.read_raypaths-383"><span class="linenos">383</span></a>        <span class="n">fps</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">fpb</span><span class="o">+</span><span class="s1">&#39;*.&#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Visualisation.read_raypaths-384"><a href="#Visualisation.read_raypaths-384"><span class="linenos">384</span></a>
</span><span id="Visualisation.read_raypaths-385"><a href="#Visualisation.read_raypaths-385"><span class="linenos">385</span></a>        <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">fps</span><span class="p">:</span>
</span><span id="Visualisation.read_raypaths-386"><a href="#Visualisation.read_raypaths-386"><span class="linenos">386</span></a>            <span class="n">fh</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="Visualisation.read_raypaths-387"><a href="#Visualisation.read_raypaths-387"><span class="linenos">387</span></a>            <span class="n">lines</span><span class="o">=</span><span class="n">fh</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="Visualisation.read_raypaths-388"><a href="#Visualisation.read_raypaths-388"><span class="linenos">388</span></a>            <span class="n">rp</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation.read_raypaths-389"><a href="#Visualisation.read_raypaths-389"><span class="linenos">389</span></a>            <span class="n">irp</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation.read_raypaths-390"><a href="#Visualisation.read_raypaths-390"><span class="linenos">390</span></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="Visualisation.read_raypaths-391"><a href="#Visualisation.read_raypaths-391"><span class="linenos">391</span></a>                <span class="n">fields</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="Visualisation.read_raypaths-392"><a href="#Visualisation.read_raypaths-392"><span class="linenos">392</span></a>                <span class="k">if</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">irp</span><span class="o">!=</span><span class="p">[]:</span>
</span><span id="Visualisation.read_raypaths-393"><a href="#Visualisation.read_raypaths-393"><span class="linenos">393</span></a>                    <span class="n">irp</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">irp</span><span class="p">)</span>
</span><span id="Visualisation.read_raypaths-394"><a href="#Visualisation.read_raypaths-394"><span class="linenos">394</span></a>                    <span class="n">rp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irp</span><span class="p">)</span>
</span><span id="Visualisation.read_raypaths-395"><a href="#Visualisation.read_raypaths-395"><span class="linenos">395</span></a>                    <span class="n">irp</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation.read_raypaths-396"><a href="#Visualisation.read_raypaths-396"><span class="linenos">396</span></a>                <span class="k">elif</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>
</span><span id="Visualisation.read_raypaths-397"><a href="#Visualisation.read_raypaths-397"><span class="linenos">397</span></a>                    <span class="n">irp</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
</span><span id="Visualisation.read_raypaths-398"><a href="#Visualisation.read_raypaths-398"><span class="linenos">398</span></a>            <span class="k">if</span> <span class="n">irp</span><span class="o">!=</span><span class="p">[]:</span>
</span><span id="Visualisation.read_raypaths-399"><a href="#Visualisation.read_raypaths-399"><span class="linenos">399</span></a>                <span class="n">irp</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">irp</span><span class="p">)</span>
</span><span id="Visualisation.read_raypaths-400"><a href="#Visualisation.read_raypaths-400"><span class="linenos">400</span></a>                <span class="n">rp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irp</span><span class="p">)</span>
</span><span id="Visualisation.read_raypaths-401"><a href="#Visualisation.read_raypaths-401"><span class="linenos">401</span></a>
</span><span id="Visualisation.read_raypaths-402"><a href="#Visualisation.read_raypaths-402"><span class="linenos">402</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Visualisation.read_wavefronts" class="classattr">
                                        <input id="Visualisation.read_wavefronts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_wavefronts</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Visualisation.read_wavefronts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Visualisation.read_wavefronts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Visualisation.read_wavefronts-404"><a href="#Visualisation.read_wavefronts-404"><span class="linenos">404</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">read_wavefronts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Visualisation.read_wavefronts-405"><a href="#Visualisation.read_wavefronts-405"><span class="linenos">405</span></a>        <span class="n">fn</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">((</span><span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
</span><span id="Visualisation.read_wavefronts-406"><a href="#Visualisation.read_wavefronts-406"><span class="linenos">406</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">get_wavefront_prediction_filepath</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="Visualisation.read_wavefronts-407"><a href="#Visualisation.read_wavefronts-407"><span class="linenos">407</span></a>        <span class="n">fp</span><span class="o">=</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
</span><span id="Visualisation.read_wavefronts-408"><a href="#Visualisation.read_wavefronts-408"><span class="linenos">408</span></a>        <span class="n">fh</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="Visualisation.read_wavefronts-409"><a href="#Visualisation.read_wavefronts-409"><span class="linenos">409</span></a>        <span class="n">lines</span><span class="o">=</span><span class="n">fh</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="Visualisation.read_wavefronts-410"><a href="#Visualisation.read_wavefronts-410"><span class="linenos">410</span></a>        <span class="n">wf</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation.read_wavefronts-411"><a href="#Visualisation.read_wavefronts-411"><span class="linenos">411</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="Visualisation.read_wavefronts-412"><a href="#Visualisation.read_wavefronts-412"><span class="linenos">412</span></a>            <span class="n">fields</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="Visualisation.read_wavefronts-413"><a href="#Visualisation.read_wavefronts-413"><span class="linenos">413</span></a>            <span class="k">if</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">wf</span><span class="o">!=</span><span class="p">[]:</span>
</span><span id="Visualisation.read_wavefronts-414"><a href="#Visualisation.read_wavefronts-414"><span class="linenos">414</span></a>                <span class="n">wf</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
</span><span id="Visualisation.read_wavefronts-415"><a href="#Visualisation.read_wavefronts-415"><span class="linenos">415</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">wf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
</span><span id="Visualisation.read_wavefronts-416"><a href="#Visualisation.read_wavefronts-416"><span class="linenos">416</span></a>                <span class="n">wf</span><span class="o">=</span><span class="p">[]</span>
</span><span id="Visualisation.read_wavefronts-417"><a href="#Visualisation.read_wavefronts-417"><span class="linenos">417</span></a>            <span class="k">elif</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>
</span><span id="Visualisation.read_wavefronts-418"><a href="#Visualisation.read_wavefronts-418"><span class="linenos">418</span></a>                <span class="n">wf</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
</span><span id="Visualisation.read_wavefronts-419"><a href="#Visualisation.read_wavefronts-419"><span class="linenos">419</span></a>        <span class="k">if</span>  <span class="n">wf</span><span class="o">!=</span><span class="p">[]:</span>
</span><span id="Visualisation.read_wavefronts-420"><a href="#Visualisation.read_wavefronts-420"><span class="linenos">420</span></a>            <span class="n">wf</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
</span><span id="Visualisation.read_wavefronts-421"><a href="#Visualisation.read_wavefronts-421"><span class="linenos">421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">wf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Visualisation.get_model_figure" class="classattr">
                                        <input id="Visualisation.get_model_figure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_model_figure</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nrx_</span>, </span><span class="param"><span class="n">nry_</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Visualisation.get_model_figure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Visualisation.get_model_figure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Visualisation.get_model_figure-423"><a href="#Visualisation.get_model_figure-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_model_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nrx_</span><span class="p">,</span><span class="n">nry_</span><span class="p">):</span>
</span><span id="Visualisation.get_model_figure-424"><a href="#Visualisation.get_model_figure-424"><span class="linenos">424</span></a>        <span class="n">nrx</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nrx_</span><span class="p">)</span>
</span><span id="Visualisation.get_model_figure-425"><a href="#Visualisation.get_model_figure-425"><span class="linenos">425</span></a>        <span class="n">nry</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nry_</span><span class="p">)</span>
</span><span id="Visualisation.get_model_figure-426"><a href="#Visualisation.get_model_figure-426"><span class="linenos">426</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">resample_model</span><span class="p">(</span><span class="n">nrx</span><span class="p">,</span><span class="n">nry</span><span class="p">)</span>
</span><span id="Visualisation.get_model_figure-427"><a href="#Visualisation.get_model_figure-427"><span class="linenos">427</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resampled_model_vector</span><span class="p">()</span>
</span><span id="Visualisation.get_model_figure-428"><a href="#Visualisation.get_model_figure-428"><span class="linenos">428</span></a>        <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">x0</span>
</span><span id="Visualisation.get_model_figure-429"><a href="#Visualisation.get_model_figure-429"><span class="linenos">429</span></a>        <span class="n">y0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">y0</span>
</span><span id="Visualisation.get_model_figure-430"><a href="#Visualisation.get_model_figure-430"><span class="linenos">430</span></a>        <span class="n">nx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation.get_model_figure-431"><a href="#Visualisation.get_model_figure-431"><span class="linenos">431</span></a>        <span class="n">ny</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation.get_model_figure-432"><a href="#Visualisation.get_model_figure-432"><span class="linenos">432</span></a>        <span class="n">x1</span><span class="o">=</span><span class="n">x0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation.get_model_figure-433"><a href="#Visualisation.get_model_figure-433"><span class="linenos">433</span></a>        <span class="n">y1</span><span class="o">=</span><span class="n">y0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dy</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation.get_model_figure-434"><a href="#Visualisation.get_model_figure-434"><span class="linenos">434</span></a>        <span class="n">xc</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation.get_model_figure-435"><a href="#Visualisation.get_model_figure-435"><span class="linenos">435</span></a>        <span class="n">yc</span><span class="o">=</span><span class="p">(</span><span class="n">y0</span><span class="o">+</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation.get_model_figure-436"><a href="#Visualisation.get_model_figure-436"><span class="linenos">436</span></a>
</span><span id="Visualisation.get_model_figure-437"><a href="#Visualisation.get_model_figure-437"><span class="linenos">437</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
</span><span id="Visualisation.get_model_figure-438"><a href="#Visualisation.get_model_figure-438"><span class="linenos">438</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
</span><span id="Visualisation.get_model_figure-439"><a href="#Visualisation.get_model_figure-439"><span class="linenos">439</span></a>
</span><span id="Visualisation.get_model_figure-440"><a href="#Visualisation.get_model_figure-440"><span class="linenos">440</span></a>        <span class="n">yy</span><span class="p">,</span> <span class="n">xx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Visualisation.get_model_figure-441"><a href="#Visualisation.get_model_figure-441"><span class="linenos">441</span></a>        <span class="n">zz</span> <span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">m</span><span class="p">,(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">))</span>
</span><span id="Visualisation.get_model_figure-442"><a href="#Visualisation.get_model_figure-442"><span class="linenos">442</span></a>        
</span><span id="Visualisation.get_model_figure-443"><a href="#Visualisation.get_model_figure-443"><span class="linenos">443</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Visualisation.get_model_figure-444"><a href="#Visualisation.get_model_figure-444"><span class="linenos">444</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">min_latitude</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">max_latitude</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span> <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude_true_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</span><span id="Visualisation.get_model_figure-445"><a href="#Visualisation.get_model_figure-445"><span class="linenos">445</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation.get_model_figure-446"><a href="#Visualisation.get_model_figure-446"><span class="linenos">446</span></a>        
</span><span id="Visualisation.get_model_figure-447"><a href="#Visualisation.get_model_figure-447"><span class="linenos">447</span></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">]</span>
</span><span id="Visualisation.get_model_figure-448"><a href="#Visualisation.get_model_figure-448"><span class="linenos">448</span></a>        <span class="n">cm</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation.get_model_figure-449"><a href="#Visualisation.get_model_figure-449"><span class="linenos">449</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="Visualisation.get_model_figure-450"><a href="#Visualisation.get_model_figure-450"><span class="linenos">450</span></a>
</span><span id="Visualisation.get_model_figure-451"><a href="#Visualisation.get_model_figure-451"><span class="linenos">451</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="Visualisation.get_model_figure-452"><a href="#Visualisation.get_model_figure-452"><span class="linenos">452</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</span><span id="Visualisation.get_model_figure-453"><a href="#Visualisation.get_model_figure-453"><span class="linenos">453</span></a>
</span><span id="Visualisation.get_model_figure-454"><a href="#Visualisation.get_model_figure-454"><span class="linenos">454</span></a>        <span class="k">return</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="Visualisation.get_raypath_figure" class="classattr">
                                        <input id="Visualisation.get_raypath_figure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_raypath_figure</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nrx_</span>, </span><span class="param"><span class="n">nry_</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Visualisation.get_raypath_figure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Visualisation.get_raypath_figure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Visualisation.get_raypath_figure-456"><a href="#Visualisation.get_raypath_figure-456"><span class="linenos">456</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_raypath_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nrx_</span><span class="p">,</span><span class="n">nry_</span><span class="p">):</span>
</span><span id="Visualisation.get_raypath_figure-457"><a href="#Visualisation.get_raypath_figure-457"><span class="linenos">457</span></a>        <span class="n">nrx</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nrx_</span><span class="p">)</span>
</span><span id="Visualisation.get_raypath_figure-458"><a href="#Visualisation.get_raypath_figure-458"><span class="linenos">458</span></a>        <span class="n">nry</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nry_</span><span class="p">)</span>
</span><span id="Visualisation.get_raypath_figure-459"><a href="#Visualisation.get_raypath_figure-459"><span class="linenos">459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">resample_model</span><span class="p">(</span><span class="n">nrx</span><span class="p">,</span><span class="n">nry</span><span class="p">)</span>
</span><span id="Visualisation.get_raypath_figure-460"><a href="#Visualisation.get_raypath_figure-460"><span class="linenos">460</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resampled_model_vector</span><span class="p">()</span>
</span><span id="Visualisation.get_raypath_figure-461"><a href="#Visualisation.get_raypath_figure-461"><span class="linenos">461</span></a>        <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">x0</span>
</span><span id="Visualisation.get_raypath_figure-462"><a href="#Visualisation.get_raypath_figure-462"><span class="linenos">462</span></a>        <span class="n">y0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">y0</span>
</span><span id="Visualisation.get_raypath_figure-463"><a href="#Visualisation.get_raypath_figure-463"><span class="linenos">463</span></a>        <span class="n">nx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation.get_raypath_figure-464"><a href="#Visualisation.get_raypath_figure-464"><span class="linenos">464</span></a>        <span class="n">ny</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation.get_raypath_figure-465"><a href="#Visualisation.get_raypath_figure-465"><span class="linenos">465</span></a>        <span class="n">x1</span><span class="o">=</span><span class="n">x0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation.get_raypath_figure-466"><a href="#Visualisation.get_raypath_figure-466"><span class="linenos">466</span></a>        <span class="n">y1</span><span class="o">=</span><span class="n">y0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dy</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation.get_raypath_figure-467"><a href="#Visualisation.get_raypath_figure-467"><span class="linenos">467</span></a>        <span class="n">xc</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation.get_raypath_figure-468"><a href="#Visualisation.get_raypath_figure-468"><span class="linenos">468</span></a>        <span class="n">yc</span><span class="o">=</span><span class="p">(</span><span class="n">y0</span><span class="o">+</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation.get_raypath_figure-469"><a href="#Visualisation.get_raypath_figure-469"><span class="linenos">469</span></a>
</span><span id="Visualisation.get_raypath_figure-470"><a href="#Visualisation.get_raypath_figure-470"><span class="linenos">470</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
</span><span id="Visualisation.get_raypath_figure-471"><a href="#Visualisation.get_raypath_figure-471"><span class="linenos">471</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
</span><span id="Visualisation.get_raypath_figure-472"><a href="#Visualisation.get_raypath_figure-472"><span class="linenos">472</span></a>
</span><span id="Visualisation.get_raypath_figure-473"><a href="#Visualisation.get_raypath_figure-473"><span class="linenos">473</span></a>        <span class="n">yy</span><span class="p">,</span> <span class="n">xx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Visualisation.get_raypath_figure-474"><a href="#Visualisation.get_raypath_figure-474"><span class="linenos">474</span></a>        <span class="n">zz</span> <span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">m</span><span class="p">,(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">))</span>
</span><span id="Visualisation.get_raypath_figure-475"><a href="#Visualisation.get_raypath_figure-475"><span class="linenos">475</span></a>        
</span><span id="Visualisation.get_raypath_figure-476"><a href="#Visualisation.get_raypath_figure-476"><span class="linenos">476</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Visualisation.get_raypath_figure-477"><a href="#Visualisation.get_raypath_figure-477"><span class="linenos">477</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">min_latitude</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">max_latitude</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span> <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude_true_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</span><span id="Visualisation.get_raypath_figure-478"><a href="#Visualisation.get_raypath_figure-478"><span class="linenos">478</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation.get_raypath_figure-479"><a href="#Visualisation.get_raypath_figure-479"><span class="linenos">479</span></a>        
</span><span id="Visualisation.get_raypath_figure-480"><a href="#Visualisation.get_raypath_figure-480"><span class="linenos">480</span></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">]</span>
</span><span id="Visualisation.get_raypath_figure-481"><a href="#Visualisation.get_raypath_figure-481"><span class="linenos">481</span></a>        <span class="n">cm</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation.get_raypath_figure-482"><a href="#Visualisation.get_raypath_figure-482"><span class="linenos">482</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="Visualisation.get_raypath_figure-483"><a href="#Visualisation.get_raypath_figure-483"><span class="linenos">483</span></a>
</span><span id="Visualisation.get_raypath_figure-484"><a href="#Visualisation.get_raypath_figure-484"><span class="linenos">484</span></a>        <span class="c1"># http://tsitsul.in/blog/coloropt/</span>
</span><span id="Visualisation.get_raypath_figure-485"><a href="#Visualisation.get_raypath_figure-485"><span class="linenos">485</span></a>        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#ebac23&#39;</span><span class="p">,</span><span class="s1">&#39;#b80058&#39;</span><span class="p">,</span><span class="s1">&#39;#008cf9&#39;</span><span class="p">,</span><span class="s1">&#39;#006e00&#39;</span><span class="p">,</span><span class="s1">&#39;#00bbad&#39;</span><span class="p">,</span><span class="s1">&#39;#d163e6&#39;</span><span class="p">,</span><span class="s1">&#39;#b24502&#39;</span><span class="p">,</span><span class="s1">&#39;#ff9287&#39;</span><span class="p">,</span><span class="s1">&#39;#5954d6&#39;</span><span class="p">,</span><span class="s1">&#39;#00c6f8&#39;</span><span class="p">,</span><span class="s1">&#39;#878500&#39;</span><span class="p">,</span><span class="s1">&#39;#00a76c&#39;</span><span class="p">]</span>
</span><span id="Visualisation.get_raypath_figure-486"><a href="#Visualisation.get_raypath_figure-486"><span class="linenos">486</span></a>        <span class="n">ic</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Visualisation.get_raypath_figure-487"><a href="#Visualisation.get_raypath_figure-487"><span class="linenos">487</span></a>
</span><span id="Visualisation.get_raypath_figure-488"><a href="#Visualisation.get_raypath_figure-488"><span class="linenos">488</span></a>        <span class="k">for</span> <span class="n">rp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span>
</span><span id="Visualisation.get_raypath_figure-489"><a href="#Visualisation.get_raypath_figure-489"><span class="linenos">489</span></a>            <span class="k">for</span> <span class="n">irp</span> <span class="ow">in</span> <span class="n">rp</span><span class="p">:</span>
</span><span id="Visualisation.get_raypath_figure-490"><a href="#Visualisation.get_raypath_figure-490"><span class="linenos">490</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">irp</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">irp</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation.get_raypath_figure-491"><a href="#Visualisation.get_raypath_figure-491"><span class="linenos">491</span></a>            <span class="n">ic</span><span class="o">=</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span>
</span><span id="Visualisation.get_raypath_figure-492"><a href="#Visualisation.get_raypath_figure-492"><span class="linenos">492</span></a>
</span><span id="Visualisation.get_raypath_figure-493"><a href="#Visualisation.get_raypath_figure-493"><span class="linenos">493</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="Visualisation.get_raypath_figure-494"><a href="#Visualisation.get_raypath_figure-494"><span class="linenos">494</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</span><span id="Visualisation.get_raypath_figure-495"><a href="#Visualisation.get_raypath_figure-495"><span class="linenos">495</span></a>
</span><span id="Visualisation.get_raypath_figure-496"><a href="#Visualisation.get_raypath_figure-496"><span class="linenos">496</span></a>        <span class="k">return</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="Visualisation.get_wavefront_figure" class="classattr">
                                        <input id="Visualisation.get_wavefront_figure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_wavefront_figure</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nrx_</span>, </span><span class="param"><span class="n">nry_</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Visualisation.get_wavefront_figure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Visualisation.get_wavefront_figure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Visualisation.get_wavefront_figure-498"><a href="#Visualisation.get_wavefront_figure-498"><span class="linenos">498</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_wavefront_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nrx_</span><span class="p">,</span><span class="n">nry_</span><span class="p">):</span>
</span><span id="Visualisation.get_wavefront_figure-499"><a href="#Visualisation.get_wavefront_figure-499"><span class="linenos">499</span></a>        <span class="n">nrx</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nrx_</span><span class="p">)</span>
</span><span id="Visualisation.get_wavefront_figure-500"><a href="#Visualisation.get_wavefront_figure-500"><span class="linenos">500</span></a>        <span class="n">nry</span><span class="o">=</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">nry_</span><span class="p">)</span>
</span><span id="Visualisation.get_wavefront_figure-501"><a href="#Visualisation.get_wavefront_figure-501"><span class="linenos">501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">swmp</span><span class="o">.</span><span class="n">resample_model</span><span class="p">(</span><span class="n">nrx</span><span class="p">,</span><span class="n">nry</span><span class="p">)</span>
</span><span id="Visualisation.get_wavefront_figure-502"><a href="#Visualisation.get_wavefront_figure-502"><span class="linenos">502</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resampled_model_vector</span><span class="p">()</span>
</span><span id="Visualisation.get_wavefront_figure-503"><a href="#Visualisation.get_wavefront_figure-503"><span class="linenos">503</span></a>        <span class="n">x0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">x0</span>
</span><span id="Visualisation.get_wavefront_figure-504"><a href="#Visualisation.get_wavefront_figure-504"><span class="linenos">504</span></a>        <span class="n">y0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">y0</span>
</span><span id="Visualisation.get_wavefront_figure-505"><a href="#Visualisation.get_wavefront_figure-505"><span class="linenos">505</span></a>        <span class="n">nx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation.get_wavefront_figure-506"><a href="#Visualisation.get_wavefront_figure-506"><span class="linenos">506</span></a>        <span class="n">ny</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation.get_wavefront_figure-507"><a href="#Visualisation.get_wavefront_figure-507"><span class="linenos">507</span></a>        <span class="n">x1</span><span class="o">=</span><span class="n">x0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Visualisation.get_wavefront_figure-508"><a href="#Visualisation.get_wavefront_figure-508"><span class="linenos">508</span></a>        <span class="n">y1</span><span class="o">=</span><span class="n">y0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">dy</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">resamod</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Visualisation.get_wavefront_figure-509"><a href="#Visualisation.get_wavefront_figure-509"><span class="linenos">509</span></a>        <span class="n">xc</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation.get_wavefront_figure-510"><a href="#Visualisation.get_wavefront_figure-510"><span class="linenos">510</span></a>        <span class="n">yc</span><span class="o">=</span><span class="p">(</span><span class="n">y0</span><span class="o">+</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
</span><span id="Visualisation.get_wavefront_figure-511"><a href="#Visualisation.get_wavefront_figure-511"><span class="linenos">511</span></a>
</span><span id="Visualisation.get_wavefront_figure-512"><a href="#Visualisation.get_wavefront_figure-512"><span class="linenos">512</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
</span><span id="Visualisation.get_wavefront_figure-513"><a href="#Visualisation.get_wavefront_figure-513"><span class="linenos">513</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
</span><span id="Visualisation.get_wavefront_figure-514"><a href="#Visualisation.get_wavefront_figure-514"><span class="linenos">514</span></a>
</span><span id="Visualisation.get_wavefront_figure-515"><a href="#Visualisation.get_wavefront_figure-515"><span class="linenos">515</span></a>        <span class="n">yy</span><span class="p">,</span> <span class="n">xx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Visualisation.get_wavefront_figure-516"><a href="#Visualisation.get_wavefront_figure-516"><span class="linenos">516</span></a>        <span class="n">zz</span> <span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">m</span><span class="p">,(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">))</span>
</span><span id="Visualisation.get_wavefront_figure-517"><a href="#Visualisation.get_wavefront_figure-517"><span class="linenos">517</span></a>        
</span><span id="Visualisation.get_wavefront_figure-518"><a href="#Visualisation.get_wavefront_figure-518"><span class="linenos">518</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Visualisation.get_wavefront_figure-519"><a href="#Visualisation.get_wavefront_figure-519"><span class="linenos">519</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">min_latitude</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">max_latitude</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span> <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude_true_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</span><span id="Visualisation.get_wavefront_figure-520"><a href="#Visualisation.get_wavefront_figure-520"><span class="linenos">520</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation.get_wavefront_figure-521"><a href="#Visualisation.get_wavefront_figure-521"><span class="linenos">521</span></a>        
</span><span id="Visualisation.get_wavefront_figure-522"><a href="#Visualisation.get_wavefront_figure-522"><span class="linenos">522</span></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">]</span>
</span><span id="Visualisation.get_wavefront_figure-523"><a href="#Visualisation.get_wavefront_figure-523"><span class="linenos">523</span></a>        <span class="n">cm</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation.get_wavefront_figure-524"><a href="#Visualisation.get_wavefront_figure-524"><span class="linenos">524</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</span><span id="Visualisation.get_wavefront_figure-525"><a href="#Visualisation.get_wavefront_figure-525"><span class="linenos">525</span></a>
</span><span id="Visualisation.get_wavefront_figure-526"><a href="#Visualisation.get_wavefront_figure-526"><span class="linenos">526</span></a>        <span class="c1"># http://tsitsul.in/blog/coloropt/</span>
</span><span id="Visualisation.get_wavefront_figure-527"><a href="#Visualisation.get_wavefront_figure-527"><span class="linenos">527</span></a>        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#ebac23&#39;</span><span class="p">,</span><span class="s1">&#39;#b80058&#39;</span><span class="p">,</span><span class="s1">&#39;#008cf9&#39;</span><span class="p">,</span><span class="s1">&#39;#006e00&#39;</span><span class="p">,</span><span class="s1">&#39;#00bbad&#39;</span><span class="p">,</span><span class="s1">&#39;#d163e6&#39;</span><span class="p">,</span><span class="s1">&#39;#b24502&#39;</span><span class="p">,</span><span class="s1">&#39;#ff9287&#39;</span><span class="p">,</span><span class="s1">&#39;#5954d6&#39;</span><span class="p">,</span><span class="s1">&#39;#00c6f8&#39;</span><span class="p">,</span><span class="s1">&#39;#878500&#39;</span><span class="p">,</span><span class="s1">&#39;#00a76c&#39;</span><span class="p">]</span>
</span><span id="Visualisation.get_wavefront_figure-528"><a href="#Visualisation.get_wavefront_figure-528"><span class="linenos">528</span></a>        <span class="n">ic</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Visualisation.get_wavefront_figure-529"><a href="#Visualisation.get_wavefront_figure-529"><span class="linenos">529</span></a>
</span><span id="Visualisation.get_wavefront_figure-530"><a href="#Visualisation.get_wavefront_figure-530"><span class="linenos">530</span></a>        <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wf</span><span class="p">:</span>
</span><span id="Visualisation.get_wavefront_figure-531"><a href="#Visualisation.get_wavefront_figure-531"><span class="linenos">531</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">wf</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation.get_wavefront_figure-532"><a href="#Visualisation.get_wavefront_figure-532"><span class="linenos">532</span></a>        <span class="k">for</span> <span class="n">rp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span>
</span><span id="Visualisation.get_wavefront_figure-533"><a href="#Visualisation.get_wavefront_figure-533"><span class="linenos">533</span></a>            <span class="k">for</span> <span class="n">irp</span> <span class="ow">in</span> <span class="n">rp</span><span class="p">:</span>
</span><span id="Visualisation.get_wavefront_figure-534"><a href="#Visualisation.get_wavefront_figure-534"><span class="linenos">534</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">irp</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">irp</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span><span class="n">transform</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</span><span id="Visualisation.get_wavefront_figure-535"><a href="#Visualisation.get_wavefront_figure-535"><span class="linenos">535</span></a>            <span class="n">ic</span><span class="o">=</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span>
</span><span id="Visualisation.get_wavefront_figure-536"><a href="#Visualisation.get_wavefront_figure-536"><span class="linenos">536</span></a>
</span><span id="Visualisation.get_wavefront_figure-537"><a href="#Visualisation.get_wavefront_figure-537"><span class="linenos">537</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="Visualisation.get_wavefront_figure-538"><a href="#Visualisation.get_wavefront_figure-538"><span class="linenos">538</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</span><span id="Visualisation.get_wavefront_figure-539"><a href="#Visualisation.get_wavefront_figure-539"><span class="linenos">539</span></a>
</span><span id="Visualisation.get_wavefront_figure-540"><a href="#Visualisation.get_wavefront_figure-540"><span class="linenos">540</span></a>        <span class="k">return</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>